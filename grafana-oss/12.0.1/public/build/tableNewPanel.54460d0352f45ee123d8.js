"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7794],{73163:(Z,w,n)=>{n.d(w,{X:()=>B,k:()=>o});var I=n(60519),b=n(32899),M=n(95004),O=n(63704),S=n(68143),E=n(73427),R=n(86967),T=n(92367);const o=(d,f,g,h,y,C)=>!y||y.length===0?[]:y.map(v=>{const j=(0,I.vd)(d,f,g),D={...g,__dataContext:j},H=(W,N,z)=>h(W,{...D,...N},z);C.valueRowIndex!==void 0&&!isNaN(C.valueRowIndex)?j.value.rowIndex=C.valueRowIndex:j.value.calculatedValue=C.calculatedValue;const $=h(v.title,D),K=h(v.confirmation||`Are you sure you want to ${v.title}?`,D);return{title:$,confirmation:K,onClick:(W,N)=>{s(v,H)},oneClick:v.oneClick??!1}}).filter(v=>!!v),s=(d,f)=>{try{const g=new URL(G(f(d.fetch.url))),h={};let y={url:g.toString(),method:d.fetch.method,data:A(d,f),headers:h};d.fetch.headers&&d.fetch.headers.forEach(([C,P])=>{h[f(C)]=f(P)}),d.fetch.queryParams&&(d.fetch.queryParams?.forEach(([C,P])=>{g.searchParams.append(f(C),f(P))}),y.url=g.toString()),h["X-Grafana-Action"]="1",y.headers=h,(0,S.AI)().fetch(y).subscribe({error:C=>{E.lE.emit(b.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(C)},complete:()=>{E.lE.emit(b.r1.alertSuccess,["API call was successful"])}})}catch(g){E.lE.emit(b.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(g);return}},B=(d=[],f=[])=>({name:"Default field",type:M.PU.string,config:{links:d,actions:f},values:[]}),G=d=>{if(d.startsWith("/")){const g=O.sQ.sanitizeUrl(d);d=(0,T.z)(g,[])}return d},A=(d,f)=>{let g=d.fetch.body?f(d.fetch.body):"{}";return d.fetch.method===R.DO.GET&&(g=void 0),g}},86967:(Z,w,n)=>{n.d(w,{DO:()=>O,en:()=>I,gR:()=>b,xp:()=>M});var I=(o=>(o.Center="center",o.Left="left",o.LeftRight="leftright",o.Right="right",o.Scale="scale",o))(I||{}),b=(o=>(o.Bottom="bottom",o.Center="center",o.Scale="scale",o.Top="top",o.TopBottom="topbottom",o))(b||{}),M=(o=>(o.Contain="contain",o.Cover="cover",o.Fill="fill",o.Original="original",o.Tile="tile",o))(M||{}),O=(o=>(o.GET="GET",o.POST="POST",o.PUT="PUT",o))(O||{}),S=(o=>(o.Straight="straight",o))(S||{});const E={vertices:[]},R={connections:[]},T={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},5631:(Z,w,n)=>{n.r(w),n.d(w,{plugin:()=>Ge});var I=n(16207),b=n(83340),M=n(38809),O=n(53543),S=n(46644),E=n(95004),R=n(16515),T=n(31114),o=n(739),s=n(74848),B=n(21285);function G({onChange:e,value:t,context:a}){const r=l=>{l?.currentTarget.checked&&(a.options.footer.show=!1),e(l?.currentTarget.checked)};return(0,s.jsx)(B.d,{value:!!t,onChange:r})}var A=n(22803),d=n(2543),f=n(96540),g=n(63142),h=n(37386),y=n(18857);const C=({cellOptions:e,onChange:t})=>{const a=()=>{e.wrapText=!e.wrapText,t(e)};return(0,s.jsx)(h.D,{label:"Wrap text",children:(0,s.jsx)(B.d,{value:e.wrapText,onChange:a})})};var P=n(41654),v=n(77824);function j({cellOptions:e,onChange:t}){const a=l=>{e.mode=l,t(e)},r=l=>{e.valueDisplayMode=l,t(e)};return(0,s.jsxs)(P.B,{direction:"column",gap:0,children:[(0,s.jsx)(h.D,{label:"Gauge display mode",children:(0,s.jsx)(v.z,{value:e?.mode??o.eX.Gradient,onChange:a,options:D})}),(0,s.jsx)(h.D,{label:"Value display",children:(0,s.jsx)(v.z,{value:e?.valueDisplayMode??o.$l.Text,onChange:r,options:H})})]})}const D=[{value:o.eX.Basic,label:"Basic"},{value:o.eX.Gradient,label:"Gradient"},{value:o.eX.Lcd,label:"Retro LCD"}],H=[{value:o.$l.Color,label:"Value color"},{value:o.$l.Text,label:"Text color"},{value:o.$l.Hidden,label:"Hidden"}],$=[{value:o.Wq.Basic,label:"Basic"},{value:o.Wq.Gradient,label:"Gradient"}],K=({cellOptions:e,onChange:t})=>{const a=c=>{e.mode=c,t(e)},r=()=>{e.applyToRow=!e.applyToRow,t(e)},l=()=>{e.wrapText=!e.wrapText,t(e)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.D,{label:"Background display mode",children:(0,s.jsx)(v.z,{value:e?.mode??o.Wq.Gradient,onChange:a,options:$})}),(0,s.jsx)(h.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,s.jsx)(B.d,{value:e.applyToRow,onChange:r})}),(0,s.jsx)(h.D,{label:"Wrap text",children:(0,s.jsx)(B.d,{value:e.wrapText,onChange:l})})]})};var X=n(63527);const W=({cellOptions:e,onChange:t})=>{const a=l=>{e.alt=l.currentTarget.value,t(e)},r=l=>{e.title=l.currentTarget.value,t(e)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,s.jsx)(X.p,{onChange:a,defaultValue:e.alt})}),(0,s.jsx)(h.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,s.jsx)(X.p,{onChange:r,defaultValue:e.title})})]})};var N=n(37297),z=n(32881),Y=n(93948),ce=n(12241);const ue=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function he(e){const t=(0,ce.V)(e);return{...t,useCustomConfig:a=>{t.useCustomConfig?.(a),a.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const ge=e=>{const{cellOptions:t,onChange:a}=e,r=(0,f.useMemo)(()=>{const u=he(Y.t);return(0,N.O)(u,"ChartCell")},[]),l=(0,g.of)(fe),c={...Y.t,...t};return(0,s.jsx)(z.gW,{children:r.list(ue.map(u=>`custom.${u}`)).map(u=>{if(u.showIf&&!u.showIf(c))return null;const m=u.editor,i=u.path;return(0,s.jsx)(h.D,{label:u.name,className:l.field,children:(0,s.jsx)(m,{onChange:p=>a({...t,[i]:p}),value:(me(i,c)?c[i]:void 0)??u.defaultValue,item:u,context:{data:[]}})},u.id)})})};function me(e,t){return e in t}const fe=()=>({field:(0,A.css)({width:"100%","[title='Use color scheme to define gradient']":{display:"none"}})}),q=({value:e,onChange:t})=>{const a=e.type,r=(0,g.of)(pe),l=_.find(p=>p.value.type===a);let[c,u]=(0,f.useState)({});const m=p=>{p.value!==void 0&&(e=p.value,c[e.type]!==void 0&&Object.keys(c[e.type]).length>1&&(e=(0,d.merge)(e,c[e.type])),t(e))},i=p=>{c[e.type]=(0,d.merge)(e,p),u(c),t(c[e.type])};return(0,s.jsxs)("div",{className:r.fixBottomMargin,children:[(0,s.jsx)(h.D,{children:(0,s.jsx)(y.l6,{options:_,value:l,onChange:m})}),(a===o.ob.Auto||a===o.ob.ColorText)&&(0,s.jsx)(C,{cellOptions:e,onChange:i}),a===o.ob.Gauge&&(0,s.jsx)(j,{cellOptions:e,onChange:i}),a===o.ob.ColorBackground&&(0,s.jsx)(K,{cellOptions:e,onChange:i}),a===o.ob.Sparkline&&(0,s.jsx)(ge,{cellOptions:e,onChange:i}),a===o.ob.Image&&(0,s.jsx)(W,{cellOptions:e,onChange:i})]})};let _=[{value:{type:o.ob.Auto},label:"Auto"},{value:{type:o.ob.Sparkline},label:"Sparkline"},{value:{type:o.ob.ColorText},label:"Colored text"},{value:{type:o.ob.ColorBackground},label:"Colored background"},{value:{type:o.ob.Gauge},label:"Gauge"},{value:{type:o.ob.DataLinks},label:"Data links"},{value:{type:o.ob.JSONView},label:"JSON View"},{value:{type:o.ob.Image},label:"Image"},{value:{type:o.ob.Actions},label:"Actions"}];const pe=e=>({fixBottomMargin:(0,A.css)({marginBottom:e.spacing(-2)})});var Ce=n(84229),J=n(57866),ve=n(14477),xe=n(43173),ye=n(64400),be=n(60893),Te=n(73163),ee=n(33553);const Se=e=>(!e.pluginVersion&&"columns"in e&&console.log("Was angular table",e),e.options),te={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},Ee={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},oe={cell:"color-background",row:"color-background",value:"color-text"},ae=(e,t)=>[-1/0,...e].map((a,r)=>({color:t[r],value:(0,d.isNumber)(a)?a:parseInt(a,10)})),we=(e,t)=>{const a=e.transformations??[];if(Object.keys(te).includes(t.transform)){const r={reducers:[]};t.transform==="timeseries_aggregations"&&(r.includeTimeField=!1,r.reducers=t.columns.map(l=>Ee[l.value])),a.push({id:te[t.transform],options:r})}return a},Ie=e=>{const a={matcher:{id:/^\/.*\/$/.test(e.pattern)?J.Ct.byRegexp:J.Ct.byName,options:e.pattern},properties:[]};return e.alias&&a.properties.push({id:"displayName",value:e.alias}),e.unit&&a.properties.push({id:"unit",value:e.unit}),e.decimals&&a.properties.push({id:"decimals",value:e.decimals}),e.type==="date"&&a.properties.push({id:"unit",value:`time: ${e.dateFormat}`}),e.type==="hidden"&&a.properties.push({id:"custom.hidden",value:!0}),e.link&&a.properties.push({id:"links",value:[{title:(0,d.defaultTo)(e.linkTooltip,""),url:(0,d.defaultTo)(e.linkUrl,""),targetBlank:(0,d.defaultTo)(e.linkTargetBlank,!1)}]}),e.colorMode&&a.properties.push({id:"custom.cellOptions",value:{type:oe[e.colorMode]}}),e.align&&a.properties.push({id:"custom.align",value:e.align==="auto"?null:e.align}),e.thresholds?.length&&a.properties.push({id:"thresholds",value:{mode:ee.O.Absolute,steps:ae(e.thresholds,e.colors)}}),a},Me=e=>{let t={custom:{}};if(e){if(t=(0,d.omitBy)({unit:e.unit,decimals:e.decimals,displayName:e.alias,custom:{align:e.align==="auto"?null:e.align}},d.isNil),e.thresholds.length){const a={mode:ee.O.Absolute,steps:ae(e.thresholds,e.colors)};t.thresholds=a}e.colorMode&&(t.custom.cellOptions={type:oe[e.colorMode]})}return t},Oe=(e,t,a)=>{if(t==="table-old"&&a.angular){const r=a.angular,l=we(e,r),c=r.styles.find(i=>i.pattern==="/.*/"),u=Me(c),m=r.styles.filter(i=>i.pattern!=="/.*/").map(Ie);e.transformations=l,e.fieldConfig={defaults:u,overrides:m}}return{}},Re=e=>e?.filter(t=>t.meta?.custom?.parentRowIndex===void 0)||[e?.[0]],Be=e=>{const t=[];return Re(e).filter(r=>!!r&&r.length!==0)?.forEach(r=>{const l=e?.filter(i=>r.refId===i.refId&&i.meta?.custom?.parentRowIndex!==void 0),c=(0,d.groupBy)(l,i=>i.meta?.custom?.parentRowIndex),u=Object.keys(c).map(i=>c[i]),m={...r};l&&l.length>0&&m.fields.push({name:"nested",type:E.PU.nestedFrames,config:{},values:u}),t.push(m)}),t},Ae=e=>e?.some(t=>t.meta?.custom?.parentRowIndex!==void 0);function Pe(e){const{data:t,height:a,width:r,options:l,fieldConfig:c,id:u,timeRange:m,replaceVariables:i}=e;(0,R.Fm)(t.series);const p=(0,g.$j)(),k=(0,ye.d2)(),F=Ae(t.series)?Be(t.series):t.series,Q=F?.length,He=F.some(x=>x.fields.length>0),se=je(F,l),$e=F[se];let re=a;if(!Q||!He)return(0,s.jsx)(ve.a,{panelId:u,fieldConfig:c,data:t});if(Q>1){const x=p.spacing.gridSize*p.components.height.md,V=p.spacing.gridSize;re=a-x-V}const Ke=k.sync&&k.sync()!==Ce.y.Off,ie=(0,s.jsx)(be.is,{height:re,width:r,data:$e,noHeader:!l.showHeader,showTypeIcons:l.showTypeIcons,resizable:!0,initialSortBy:l.sortBy,onSortByChange:x=>Fe(x,e),onColumnResize:(x,V)=>De(x,V,e),onCellFilterAdded:k.onAddAdHocFilter,footerOptions:l.footer,enablePagination:l.footer?.enablePagination,cellHeight:l.cellHeight,timeRange:m,enableSharedCrosshair:xe.$.featureToggles.tableSharedCrosshair&&Ke,fieldConfig:c,getActions:Ne,replaceVariables:i});if(Q===1)return ie;const de=F.map((x,V)=>({label:(0,R.Ri)(x),value:V}));return(0,s.jsxs)("div",{className:ne.wrapper,children:[ie,(0,s.jsx)("div",{className:ne.selectWrapper,children:(0,s.jsx)(y.l6,{options:de,value:de[se],onChange:x=>Ve(x,e)})})]})}function je(e,t){return t.frameIndex>0&&t.frameIndex<e.length?t.frameIndex:0}function De(e,t,a){const{fieldConfig:r}=a,{overrides:l}=r,c=J.Ct.byName,u="custom.width",m=l.find(i=>i.matcher.id===c&&i.matcher.options===e);if(m){const i=m.properties.find(p=>p.id===u);i?i.value=t:m.properties.push({id:u,value:t})}else l.push({matcher:{id:c,options:e},properties:[{id:u,value:t}]});a.onFieldConfigChange({...r,overrides:l})}function Fe(e,t){t.onOptionsChange({...t.options,sortBy:e})}function Ve(e,t){t.onOptionsChange({...t.options,frameIndex:e.value||0})}const We=e=>e,Ne=(e,t,a,r)=>{const l=[],c=new Set;return(0,Te.k)(e,t,t.state.scopedVars,r??We,t.config.actions??[],{valueRowIndex:a}).forEach(m=>{const i=`${m.title}`;c.has(i)||(l.push(m),c.add(i))}),l},ne={wrapper:(0,A.css)({display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}),selectWrapper:(0,A.css)({padding:"8px 8px 0px 8px"})},L={cellHeight:o.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var Le=n(73495);class Ue{getSuggestionsForData(t){const a=t.getListAppender({name:Le.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:r=>{r.fieldConfig.defaults.custom.minWidth=50}}});t.dataSummary.fieldCount===0?a.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):a.append({})}}const U="Table footer",le=["Cell options"],Ge=new I.m(Pe).setPanelChangeHandler(Oe).setMigrationHandler(Se).useFieldConfig({standardOptions:{[b.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:e=>{e.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:T.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:T.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:T.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:q,override:q,defaultValue:T.gB.cellOptions,process:M.hS,category:le,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:le,showIf:t=>t.cellOptions.type===o.ob.Auto||t.cellOptions.type===o.ob.JSONView||t.cellOptions.type===o.ob.ColorText||t.cellOptions.type===o.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:T.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(e=>{e.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:L.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:L.cellHeight,settings:{options:[{value:o.qM.Sm,label:"Small"},{value:o.qM.Md,label:"Medium"},{value:o.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[U],name:"Show table footer",defaultValue:L.footer?.show}).addCustomEditor({id:"footer.reducer",category:[U],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:O.D.get("stats-picker").editor,defaultValue:[S.gy.sum],showIf:t=>t.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[U],name:"Count rows",description:"Display a single count for all data rows",defaultValue:L.footer?.countRows,showIf:t=>t.footer?.reducer?.length===1&&t.footer?.reducer[0]===S.gy.count}).addMultiSelect({path:"footer.fields",category:[U],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async t=>{const a=[];if(t&&t.data&&t.data.length>0){const r=t.data[0];for(const l of r.fields)if(l.type===E.PU.number){const c=(0,R.Ct)(l,r,t.data),u=l.name;a.push({value:u,label:c})}}return a}},defaultValue:"",showIf:t=>t.footer?.show&&!(t.footer?.countRows&&t.footer?.reducer.includes(S.gy.count))}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:G})}).setSuggestionsSupplier(new Ue)},16264:()=>{}}]);

//# sourceMappingURL=tableNewPanel.54460d0352f45ee123d8.js.map