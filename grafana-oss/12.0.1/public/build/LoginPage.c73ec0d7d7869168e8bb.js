"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3883],{798:(q,T,t)=>{t.r(T),t.d(T,{default:()=>Z});var e=t(74848),s=t(22803),b=t(43173),p=t(63142),E=t(34999),L=t(41654),v=t(45861),N=t(92948),a=t(56840),I=t(71586),P=t(53539),G=t(61238),B=t(58102),D=t(2543),U=t(48588),K=t(30703),n=t(65642);const O=()=>{const o=!!n.Ay.oauth;return{saml:{bgColor:"#464646",enabled:n.Ay.samlEnabled,name:n.Ay.samlName||U.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:o&&!!n.Ay.oauth.google,name:n.Ay.oauth?.google?.name||"Google",icon:n.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:o&&!!n.Ay.oauth.azuread,name:n.Ay.oauth?.azuread?.name||"Microsoft",icon:n.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:o&&!!n.Ay.oauth.github,name:n.Ay.oauth?.github?.name||"GitHub",icon:n.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:o&&!!n.Ay.oauth.gitlab,name:n.Ay.oauth?.gitlab?.name||"GitLab",icon:n.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:o&&!!n.Ay.oauth.grafana_com,name:n.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:n.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:o&&!!n.Ay.oauth.okta,name:n.Ay.oauth?.okta?.name||"Okta",icon:n.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:o&&!!n.Ay.oauth.generic_oauth,name:n.Ay.oauth?.generic_oauth?.name||"OAuth",icon:n.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},$=o=>({button:(0,s.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,s.css)({position:"absolute",left:o.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,s.css)({color:o.colors.text.primary,display:"flex",marginBottom:o.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,s.css)({width:100,height:10,borderBottom:`1px solid ${o.colors.text}`})}}),M=()=>{const o=(0,p.of)($);return(0,e.jsxs)("div",{className:o.divider.base,children:[(0,e.jsx)("div",{children:(0,e.jsx)("div",{className:o.divider.line})}),(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:!n.Ay.disableLoginForm&&(0,e.jsx)(a.x6,{i18nKey:"login.divider.connecting-text",children:"or"})})}),(0,e.jsx)("div",{children:(0,e.jsx)("div",{className:o.divider.line})})]})};function V(o,i,l){return(0,s.cx)(i.button,(0,s.css)({backgroundColor:o.bgColor,color:l.colors.getContrastText(o.bgColor),"&:hover":{backgroundColor:l.colors.emphasize(o.bgColor,.15),boxShadow:l.shadows.z1}}))}const W=()=>{const o=(0,D.pickBy)(O(),c=>c.enabled),i=Object.keys(o).length>0,l=(0,p.$j)(),g=(0,p.of)($);return i?(0,e.jsxs)(L.B,{direction:"column",width:"100%",children:[(0,e.jsx)(M,{}),Object.entries(o).map(([c,r])=>{const u=r.name;return(0,e.jsxs)(v.z9,{className:V(r,g,l),href:`login/${r.hrefName?r.hrefName:c}`,target:"_self",fullWidth:!0,children:[(0,e.jsx)(K.I,{className:g.buttonIcon,name:r.icon}),(0,e.jsxs)(a.x6,{i18nKey:"login.services.sing-in-with-prefix",children:["Sign in with ",{serviceName:u}]})]},c)})]}):null};var h=t(96540),w=t(49785),y=t(85629),H=t(36490),S=t(37386),C=t(63527);const Q=({onSubmit:o,isLoggingIn:i})=>{const l=(0,p.of)(Y),g=(0,h.useId)(),c=(0,h.useId)(),r=(0,h.useId)(),u=(0,h.useId)(),[z,A]=(0,h.useState)(!1),{handleSubmit:f,register:j,setValue:x,formState:{errors:m}}=(0,w.mN)({mode:"onChange"});return(0,h.useEffect)(()=>{N.M.LoginTitle="We've sent you an email!",N.M.GetLoginSubTitle=()=>"Check your inbox and click the confirmation link or use the confirmation code we've sent.";const d=H.Ny.getSearch();x("code",d.get("code")||""),d.get("confirmationCode")&&(x("confirmationCode",d.get("confirmationCode")||""),d.get("signup")||f(o)()),d.get("signup")&&A(!0),d.get("username")&&x("username",d.get("username")||""),d.get("name")&&x("name",d.get("name")||"")},[x,f,o,A]),(0,e.jsx)("div",{className:l.wrapper,children:(0,e.jsxs)("form",{onSubmit:f(o),children:[(0,e.jsx)(S.D,{hidden:!0,children:(0,e.jsx)(C.p,{...j("code"),id:c,hidden:!0})}),(0,e.jsx)(S.D,{label:(0,a.t)("login.form.confirmation-code-label","Confirmation code"),invalid:!!m.code,error:m.code?.message,children:(0,e.jsx)(C.p,{...j("confirmationCode",{required:(0,a.t)("login.form.confirmation-code","Confirmation code is required")}),id:g,autoFocus:!0,autoCapitalize:"none",placeholder:(0,a.t)("login.form.confirmation-code-placeholder","confirmation code"),"data-testid":y.Tp.pages.PasswordlessLogin.email})}),z&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.D,{label:(0,a.t)("login.form.passwordless-username-label","Username"),invalid:!!m.code,error:m.code?.message,hidden:!0,children:(0,e.jsx)(C.p,{...j("username"),id:r,autoFocus:!0,autoCapitalize:"none","data-testid":y.Tp.pages.PasswordlessLogin.email,hidden:!0})}),(0,e.jsx)(S.D,{label:(0,a.t)("login.form.name-label","Name"),invalid:!!m.code,error:m.code?.message,children:(0,e.jsx)(C.p,{...j("name"),id:u,autoFocus:!0,autoCapitalize:"none","data-testid":y.Tp.pages.PasswordlessLogin.email})})]}),(0,e.jsx)(v.$n,{type:"submit","data-testid":y.Tp.pages.Login.submit,className:l.submitButton,disabled:i,children:i?(0,a.t)("login.form.submit-loading-label","Logging in..."):(0,a.t)("login.form.submit-label","Log in")})]})})},Y=o=>({wrapper:(0,s.css)({width:"100%",paddingBottom:o.spacing(2)}),submitButton:(0,s.css)({justifyContent:"center",width:"100%"}),skipButton:(0,s.css)({alignSelf:"flex-start"})}),J=({onSubmit:o,isLoggingIn:i})=>{const l=(0,p.of)(R),g=(0,h.useId)(),{handleSubmit:c,register:r,formState:{errors:u}}=(0,w.mN)({mode:"onChange"});return(0,e.jsx)("div",{className:l.wrapper,children:(0,e.jsxs)("form",{onSubmit:c(o),children:[(0,e.jsx)(S.D,{label:(0,a.t)("login.form.email-label","Email"),invalid:!!u.email,error:u.email?.message,children:(0,e.jsx)(C.p,{...r("email",{required:(0,a.t)("login.form.email-required","Email is required")}),id:g,autoFocus:!0,autoCapitalize:"none",placeholder:(0,a.t)("login.form.email-placeholder","email"),"data-testid":y.Tp.pages.PasswordlessLogin.email})}),(0,e.jsx)(v.$n,{type:"submit","data-testid":y.Tp.pages.Login.submit,className:l.submitButton,disabled:i,children:i?(0,a.t)("login.form.verify-email-loading-label","Sending email..."):(0,a.t)("login.form.verify-email-label","Send a verification email")})]})})},R=o=>({wrapper:(0,s.css)({width:"100%",paddingBottom:o.spacing(2)}),submitButton:(0,s.css)({justifyContent:"center",width:"100%"}),skipButton:(0,s.css)({alignSelf:"flex-start"})}),X=()=>{const o=(0,n.zj)().verifyEmailEnabled?`${(0,n.zj)().appSubUrl}/verify`:`${(0,n.zj)().appSubUrl}/signup`,i=(0,s.css)({paddingTop:"16px"});return(0,e.jsxs)(L.B,{direction:"column",children:[(0,e.jsx)("div",{className:i,children:(0,e.jsx)(a.x6,{i18nKey:"login.signup.new-to-question",children:"New to Grafana?"})}),(0,e.jsx)(v.z9,{className:(0,s.css)({width:"100%",justifyContent:"center"}),href:o,variant:"secondary",fill:"outline",children:(0,e.jsx)(a.x6,{i18nKey:"login.signup.button-label",children:"Sign up"})})]})},Z=()=>{const o=(0,p.of)(k);return document.title=N.M.AppTitle,(0,e.jsx)(P.A,{children:({loginHint:i,passwordHint:l,disableLoginForm:g,disableUserSignUp:c,login:r,passwordlessStart:u,passwordlessConfirm:z,showPasswordlessConfirmation:A,isLoggingIn:f,changePassword:j,skipPasswordChange:x,isChangingPassword:m,showDefaultPasswordWarning:d,loginErrorMessage:F})=>(0,e.jsxs)(B.GU,{isChangingPassword:m,children:[!m&&!A&&(0,e.jsxs)(B.qm,{children:[F&&(0,e.jsx)(E.F,{className:o.alert,severity:"error",title:(0,a.t)("login.error.title","Login failed"),children:F}),!g&&!b.$.auth.passwordlessEnabled&&(0,e.jsx)(G.Q,{onSubmit:r,loginHint:i,passwordHint:l,isLoggingIn:f,children:(0,e.jsx)(L.B,{justifyContent:"flex-end",children:!b.$.auth.disableLogin&&(0,e.jsx)(v.z9,{className:o.forgottenPassword,fill:"text",href:`${b.$.appSubUrl}/user/password/send-reset-email`,children:(0,e.jsx)(a.x6,{i18nKey:"login.forgot-password",children:"Forgot your password?"})})})}),b.$.auth.passwordlessEnabled&&(0,e.jsx)(J,{onSubmit:u,isLoggingIn:f}),(0,e.jsx)(W,{}),!c&&(0,e.jsx)(X,{})]}),b.$.auth.passwordlessEnabled&&A&&(0,e.jsx)(B.qm,{children:(0,e.jsx)(Q,{onSubmit:z,isLoggingIn:f})}),m&&!b.$.auth.passwordlessEnabled&&(0,e.jsx)(B.qm,{children:(0,e.jsx)(I.S,{showDefaultPasswordWarning:d,onSubmit:j,onSkip:()=>x()})})]})})},k=o=>({forgottenPassword:(0,s.css)({padding:0,marginTop:o.spacing(.5)}),alert:(0,s.css)({width:"100%"})})}}]);

//# sourceMappingURL=LoginPage.c73ec0d7d7869168e8bb.js.map