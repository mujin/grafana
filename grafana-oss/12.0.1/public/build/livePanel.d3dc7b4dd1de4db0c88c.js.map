{"version":3,"file":"livePanel.d3dc7b4dd1de4db0c88c.js","mappings":"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","sources":["webpack://grafana/./public/app/features/actions/utils.ts","webpack://grafana/./public/app/features/live/info.ts","webpack://grafana/./public/app/plugins/panel/canvas/panelcfg.gen.ts","webpack://grafana/./public/app/features/apiserver/discovery.ts","webpack://grafana/./public/app/plugins/panel/live/LiveChannelEditor.tsx","webpack://grafana/./public/app/plugins/panel/live/types.ts","webpack://grafana/./public/app/plugins/panel/live/LivePublish.tsx","webpack://grafana/./public/app/plugins/panel/live/LivePanel.tsx","webpack://grafana/./public/app/plugins/panel/live/module.tsx","webpack://grafana/./public/app/plugins/panel/table/TablePanel.tsx","webpack://grafana/./public/app/plugins/panel/table/migrations.ts"],"sourcesContent":["import {\n  Action,\n  ActionModel,\n  AppEvents,\n  DataContextScopedVar,\n  DataFrame,\n  DataLink,\n  Field,\n  FieldType,\n  getFieldDataContextClone,\n  InterpolateFunction,\n  ScopedVars,\n  textUtil,\n  ValueLinkConfig,\n} from '@grafana/data';\nimport { BackendSrvRequest, getBackendSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\n\nimport { HttpRequestMethod } from '../../plugins/panel/canvas/panelcfg.gen';\nimport { createAbsoluteUrl, RelativeUrl } from '../alerting/unified/utils/url';\n\n/** @internal */\nexport const getActions = (\n  frame: DataFrame,\n  field: Field,\n  fieldScopedVars: ScopedVars,\n  replaceVariables: InterpolateFunction,\n  actions: Action[],\n  config: ValueLinkConfig\n): Array<ActionModel<Field>> => {\n  if (!actions || actions.length === 0) {\n    return [];\n  }\n\n  const actionModels = actions.map((action: Action) => {\n    const dataContext: DataContextScopedVar = getFieldDataContextClone(frame, field, fieldScopedVars);\n    const actionScopedVars = {\n      ...fieldScopedVars,\n      __dataContext: dataContext,\n    };\n\n    const boundReplaceVariables: InterpolateFunction = (value, scopedVars, format) => {\n      return replaceVariables(value, { ...actionScopedVars, ...scopedVars }, format);\n    };\n\n    // We are not displaying reduction result\n    if (config.valueRowIndex !== undefined && !isNaN(config.valueRowIndex)) {\n      dataContext.value.rowIndex = config.valueRowIndex;\n    } else {\n      dataContext.value.calculatedValue = config.calculatedValue;\n    }\n\n    const title = replaceVariables(action.title, actionScopedVars);\n    const confirmation = replaceVariables(\n      action.confirmation || `Are you sure you want to ${action.title}?`,\n      actionScopedVars\n    );\n\n    const actionModel: ActionModel<Field> = {\n      title,\n      confirmation,\n      onClick: (evt: MouseEvent, origin: Field) => {\n        buildActionOnClick(action, boundReplaceVariables);\n      },\n      oneClick: action.oneClick ?? false,\n    };\n\n    return actionModel;\n  });\n\n  return actionModels.filter((action): action is ActionModel => !!action);\n};\n\n/** @internal */\nconst buildActionOnClick = (action: Action, replaceVariables: InterpolateFunction) => {\n  try {\n    const url = new URL(getUrl(replaceVariables(action.fetch.url)));\n\n    const requestHeaders: Record<string, string> = {};\n\n    let request: BackendSrvRequest = {\n      url: url.toString(),\n      method: action.fetch.method,\n      data: getData(action, replaceVariables),\n      headers: requestHeaders,\n    };\n\n    if (action.fetch.headers) {\n      action.fetch.headers.forEach(([name, value]) => {\n        requestHeaders[replaceVariables(name)] = replaceVariables(value);\n      });\n    }\n\n    if (action.fetch.queryParams) {\n      action.fetch.queryParams?.forEach(([name, value]) => {\n        url.searchParams.append(replaceVariables(name), replaceVariables(value));\n      });\n\n      request.url = url.toString();\n    }\n\n    requestHeaders['X-Grafana-Action'] = '1';\n    request.headers = requestHeaders;\n\n    getBackendSrv()\n      .fetch(request)\n      .subscribe({\n        error: (error) => {\n          appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n          console.error(error);\n        },\n        complete: () => {\n          appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n        },\n      });\n  } catch (error) {\n    appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n    console.error(error);\n    return;\n  }\n};\n\n/** @internal */\n// @TODO update return type\nexport const getActionsDefaultField = (dataLinks: DataLink[] = [], actions: Action[] = []) => {\n  return {\n    name: 'Default field',\n    type: FieldType.string,\n    config: { links: dataLinks, actions: actions },\n    values: [],\n  };\n};\n\n/** @internal */\nconst getUrl = (endpoint: string) => {\n  const isRelativeUrl = endpoint.startsWith('/');\n  if (isRelativeUrl) {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const sanitizedRelativeURL = textUtil.sanitizeUrl(endpoint) as RelativeUrl;\n    endpoint = createAbsoluteUrl(sanitizedRelativeURL, []);\n  }\n\n  return endpoint;\n};\n\n/** @internal */\nconst getData = (action: Action, replaceVariables: InterpolateFunction) => {\n  let data: string | undefined = action.fetch.body ? replaceVariables(action.fetch.body) : '{}';\n  if (action.fetch.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n","import { SelectableValue, dataFrameFromJSON } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\n\ninterface ChannelInfo {\n  channel: string;\n  minute_rate: number; //\n  data: unknown; // the last payload\n}\n\ninterface ManagedChannels {\n  channels: ChannelInfo[];\n}\n\ninterface ChannelSelectionInfo {\n  channels: Array<SelectableValue<string>>;\n  channelFields: Record<string, Array<SelectableValue<string>>>;\n}\n\nexport async function getManagedChannelInfo(): Promise<ChannelSelectionInfo> {\n  return getBackendSrv()\n    .get<ManagedChannels>('api/live/list')\n    .then((v) => {\n      const channelInfo = v.channels ?? [];\n      const channelFields: Record<string, Array<SelectableValue<string>>> = {};\n      const channels: Array<SelectableValue<string>> = channelInfo.map((c) => {\n        if (c.data) {\n          const distinctFields = new Set<string>();\n          const frame = dataFrameFromJSON(c.data);\n          for (const f of frame.fields) {\n            distinctFields.add(f.name);\n          }\n          channelFields[c.channel] = Array.from(distinctFields).map((n) => ({\n            value: n,\n            label: n,\n          }));\n        }\n        return {\n          value: c.channel,\n          label: c.channel + ' [' + c.minute_rate + ' msg/min]',\n        };\n      });\n      return { channelFields, channels };\n    });\n}\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as ui from '@grafana/schema';\n\nexport enum HorizontalConstraint {\n  Center = 'center',\n  Left = 'left',\n  LeftRight = 'leftright',\n  Right = 'right',\n  Scale = 'scale',\n}\n\nexport enum VerticalConstraint {\n  Bottom = 'bottom',\n  Center = 'center',\n  Scale = 'scale',\n  Top = 'top',\n  TopBottom = 'topbottom',\n}\n\nexport interface Constraint {\n  horizontal?: HorizontalConstraint;\n  vertical?: VerticalConstraint;\n}\n\nexport interface Placement {\n  bottom?: number;\n  height?: number;\n  left?: number;\n  right?: number;\n  rotation?: number;\n  top?: number;\n  width?: number;\n}\n\nexport enum BackgroundImageSize {\n  Contain = 'contain',\n  Cover = 'cover',\n  Fill = 'fill',\n  Original = 'original',\n  Tile = 'tile',\n}\n\nexport interface BackgroundConfig {\n  color?: ui.ColorDimensionConfig;\n  image?: ui.ResourceDimensionConfig;\n  size?: BackgroundImageSize;\n}\n\nexport interface LineConfig {\n  color?: ui.ColorDimensionConfig;\n  radius?: number;\n  width?: number;\n}\n\nexport enum HttpRequestMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n}\n\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport interface CanvasConnection {\n  color?: ui.ColorDimensionConfig;\n  path: ConnectionPath;\n  size?: ui.ScaleDimensionConfig;\n  source: ConnectionCoordinates;\n  sourceOriginal?: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  targetOriginal?: ConnectionCoordinates;\n  vertices?: Array<ConnectionCoordinates>;\n}\n\nexport const defaultCanvasConnection: Partial<CanvasConnection> = {\n  vertices: [],\n};\n\nexport interface CanvasElementOptions {\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  /**\n   * TODO: figure out how to define this (element config(s))\n   */\n  config?: unknown;\n  connections?: Array<CanvasConnection>;\n  constraint?: Constraint;\n  name: string;\n  placement?: Placement;\n  type: string;\n}\n\nexport const defaultCanvasElementOptions: Partial<CanvasElementOptions> = {\n  connections: [],\n};\n\nexport interface Options {\n  /**\n   * Enable infinite pan\n   */\n  infinitePan: boolean;\n  /**\n   * Enable inline editing\n   */\n  inlineEditing: boolean;\n  /**\n   * Enable pan and zoom\n   */\n  panZoom: boolean;\n  /**\n   * The root element of canvas (frame), where all canvas elements are nested\n   * TODO: Figure out how to define a default value for this\n   */\n  root: {\n    /**\n     * Name of the root element\n     */\n    name: string;\n    /**\n     * Type of root element (frame)\n     */\n    type: 'frame';\n    /**\n     * The list of canvas elements attached to the root element\n     */\n    elements: Array<CanvasElementOptions>;\n  };\n  /**\n   * Show all available element types\n   */\n  showAdvancedTypes: boolean;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  infinitePan: true,\n  inlineEditing: true,\n  panZoom: true,\n  showAdvancedTypes: true,\n};\n","import { lastValueFrom, map } from 'rxjs';\n\nimport { FetchResponse, getBackendSrv } from '@grafana/runtime';\n\nimport { GroupVersionKind, ListMeta } from './types';\n\nexport type GroupDiscoveryResource = {\n  resource: string;\n  responseKind: GroupVersionKind;\n  scope: 'Namespaced' | 'Cluster';\n  singularResource: string;\n  verbs: string[];\n  subresources?: GroupDiscoverySubresource[];\n};\n\nexport type GroupDiscoverySubresource = {\n  subresource: string;\n  responseKind: GroupVersionKind;\n  verbs: string[];\n};\n\nexport type GroupDiscoveryVersion = {\n  version: string;\n  freshness: 'Current' | string;\n  resources: GroupDiscoveryResource[];\n};\n\nexport type GroupDiscoveryItem = {\n  metadata: {\n    name: string;\n  };\n  versions: GroupDiscoveryVersion[];\n};\n\nexport type APIGroupDiscoveryList = {\n  metadata: ListMeta;\n  items: GroupDiscoveryItem[];\n};\n\nexport async function getAPIGroupDiscoveryList(): Promise<APIGroupDiscoveryList> {\n  return await lastValueFrom(\n    getBackendSrv()\n      .fetch<APIGroupDiscoveryList>({\n        method: 'GET',\n        url: '/apis',\n        headers: {\n          Accept:\n            'application/json;g=apidiscovery.k8s.io;v=v2;as=APIGroupDiscoveryList,application/json;g=apidiscovery.k8s.io;v=v2beta1;as=APIGroupDiscoveryList,application/json',\n        },\n      })\n      .pipe(\n        map((response: FetchResponse<APIGroupDiscoveryList>) => {\n          // Fill in the group+version before returning\n          for (let api of response.data.items) {\n            for (let version of api.versions) {\n              for (let resource of version.resources) {\n                resource.responseKind.group = api.metadata.name;\n                resource.responseKind.version = version.version;\n                if (resource.subresources) {\n                  for (let sub of resource.subresources) {\n                    sub.responseKind.group = api.metadata.name;\n                    sub.responseKind.version = version.version;\n                  }\n                }\n              }\n            }\n          }\n          return response.data;\n        })\n      )\n  );\n}\n\nexport function discoveryResources(apis: APIGroupDiscoveryList): GroupDiscoveryResource[] {\n  const resources: GroupDiscoveryResource[] = [];\n  for (let api of apis.items) {\n    for (let version of api.versions) {\n      for (let resource of version.resources) {\n        resources.push(resource);\n      }\n    }\n  }\n  return resources;\n}\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport {\n  LiveChannelScope,\n  LiveChannelAddress,\n  SelectableValue,\n  StandardEditorProps,\n  GrafanaTheme2,\n  parseLiveChannelAddress,\n} from '@grafana/data';\nimport { Select, Alert, Label, stylesFactory, Combobox } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { discoveryResources, getAPIGroupDiscoveryList, GroupDiscoveryResource } from 'app/features/apiserver/discovery';\nimport { getManagedChannelInfo } from 'app/features/live/info';\n\nimport { LivePanelOptions } from './types';\n\ntype Props = StandardEditorProps<Partial<LiveChannelAddress>, {}, LivePanelOptions>;\n\nconst scopes: Array<SelectableValue<LiveChannelScope>> = [\n  { label: 'Grafana', value: LiveChannelScope.Grafana, description: 'Core grafana live features' },\n  { label: 'Data Sources', value: LiveChannelScope.DataSource, description: 'Data sources with live support' },\n  { label: 'Plugins', value: LiveChannelScope.Plugin, description: 'Plugins with live support' },\n  { label: 'Stream', value: LiveChannelScope.Stream, description: 'data streams (eg, influx style)' },\n  { label: 'Watch', value: LiveChannelScope.Watch, description: 'Watch k8s style resources' },\n];\n\nexport function LiveChannelEditor(props: Props) {\n  const [channels, setChannels] = useState<Array<SelectableValue<string>>>([]);\n  const [namespaces, paths] = useMemo(() => {\n    const namespaces: Array<SelectableValue<string>> = [];\n    const paths: Array<SelectableValue<string>> = [];\n    const scope = props.value.scope;\n    const namespace = props.value.namespace;\n    if (!scope?.length) {\n      return [namespaces, paths];\n    }\n    const used: Record<string, boolean> = {};\n\n    for (let channel of channels) {\n      const addr = parseLiveChannelAddress(channel.value);\n      if (!addr || addr.scope !== scope) {\n        continue;\n      }\n\n      if (!used[addr.namespace]) {\n        namespaces.push({\n          value: addr.namespace,\n          label: addr.namespace,\n        });\n        used[addr.namespace] = true;\n      }\n\n      if (namespace?.length && namespace === addr.namespace) {\n        paths.push({\n          ...channel,\n          value: addr.path,\n        });\n      }\n    }\n    return [namespaces, paths];\n  }, [channels, props.value.scope, props.value.namespace]);\n\n  useEffect(() => {\n    getManagedChannelInfo().then((v) => {\n      setChannels(v.channels);\n    });\n  }, [props.value.scope]);\n\n  const onScopeChanged = (v: SelectableValue<LiveChannelScope>) => {\n    if (v.value) {\n      props.onChange({\n        scope: v.value,\n        namespace: undefined,\n        path: undefined,\n      });\n    }\n  };\n\n  const onNamespaceChanged = (v: SelectableValue<string>) => {\n    props.onChange({\n      scope: props.value?.scope,\n      namespace: v?.value,\n      path: undefined,\n    });\n  };\n\n  const onPathChanged = (v: SelectableValue<string>) => {\n    const { value, onChange } = props;\n    onChange({\n      scope: value.scope,\n      namespace: value.namespace,\n      path: v?.value,\n    });\n  };\n\n  const getWatchableResources = async (v: string) => {\n    const apis = await getAPIGroupDiscoveryList();\n    return discoveryResources(apis)\n      .filter((v) => v.verbs.includes('watch'))\n      .map((r) => ({\n        value: `${r.responseKind.group}/${r.responseKind.version}/${r.resource}`, // must be string | number\n        resource: r,\n      }));\n  };\n\n  const { scope, namespace, path } = props.value;\n  const style = getStyles(config.theme2);\n\n  return (\n    <>\n      <Alert title=\"Grafana Live\" severity=\"info\">\n        This supports real-time event streams in grafana core. This feature is under heavy development. Expect the\n        intefaces and structures to change as this becomes more production ready.\n      </Alert>\n\n      <div>\n        <div className={style.dropWrap}>\n          <Label>Scope</Label>\n          <Select options={scopes} value={scopes.find((s) => s.value === scope)} onChange={onScopeChanged} />\n        </div>\n\n        {scope === LiveChannelScope.Watch && (\n          <div className={style.dropWrap}>\n            <Combobox\n              options={getWatchableResources}\n              placeholder=\"Select watchable resource\"\n              onChange={(v) => {\n                const resource = (v as any).resource as GroupDiscoveryResource;\n                if (resource) {\n                  props.onChange({\n                    scope: LiveChannelScope.Watch,\n                    namespace: resource.responseKind.group,\n                    path: `${resource.responseKind.version}/${resource.resource}/${config.bootData.user.uid}`, // only works for this user\n                  });\n                }\n              }}\n            />\n          </div>\n        )}\n\n        {scope && (\n          <div className={style.dropWrap}>\n            <Label>Namespace</Label>\n            <Select\n              options={namespaces}\n              value={\n                namespaces.find((s) => s.value === namespace) ??\n                (namespace ? { label: namespace, value: namespace } : undefined)\n              }\n              onChange={onNamespaceChanged}\n              allowCustomValue={true}\n              backspaceRemovesValue={true}\n              isClearable={true}\n            />\n          </div>\n        )}\n\n        {scope && namespace && (\n          <div className={style.dropWrap}>\n            <Label>Path</Label>\n            <Select\n              options={paths}\n              value={findPathOption(paths, path)}\n              onChange={onPathChanged}\n              allowCustomValue={true}\n              backspaceRemovesValue={true}\n              isClearable={true}\n            />\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\nfunction findPathOption(paths: Array<SelectableValue<string>>, path?: string): SelectableValue<string> | undefined {\n  const v = paths.find((s) => s.value === path);\n  if (v) {\n    return v;\n  }\n  if (path) {\n    return { label: path, value: path };\n  }\n  return undefined;\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2) => ({\n  dropWrap: css({\n    marginBottom: theme.spacing(1),\n  }),\n}));\n","import { LiveChannelAddress } from '@grafana/data';\n\nexport enum MessageDisplayMode {\n  Raw = 'raw', // Raw JSON string\n  JSON = 'json', // formatted JSON\n  Auto = 'auto', // pick a good display\n  None = 'none', // do not display\n}\n\nexport enum MessagePublishMode {\n  None = 'none', // do not display\n  JSON = 'json', // formatted JSON\n  Influx = 'influx', // influx line protocol\n}\n\nexport interface LivePanelOptions {\n  channel?: LiveChannelAddress;\n  display?: MessageDisplayMode;\n  publish?: MessagePublishMode;\n  message?: string | object; // likely JSON\n}\n","import { useMemo } from 'react';\n\nimport { LiveChannelAddress, isValidLiveChannelAddress } from '@grafana/data';\nimport { getBackendSrv, getGrafanaLiveSrv } from '@grafana/runtime';\nimport { CodeEditor, Button } from '@grafana/ui';\n\nimport { MessagePublishMode } from './types';\n\ninterface Props {\n  height: number;\n  addr?: LiveChannelAddress;\n  mode: MessagePublishMode;\n  body?: string | object;\n  onSave: (v: string | object) => void;\n}\n\nexport function LivePublish({ height, mode, body, addr, onSave }: Props) {\n  const txt = useMemo(() => {\n    if (mode === MessagePublishMode.JSON) {\n      return body ? JSON.stringify(body, null, 2) : '{ }';\n    }\n    return body == null ? '' : `${body}`;\n  }, [mode, body]);\n\n  const doSave = (v: string) => {\n    if (mode === MessagePublishMode.JSON) {\n      onSave(JSON.parse(v));\n    } else {\n      onSave(v);\n    }\n  };\n\n  const onPublishClicked = async () => {\n    if (mode === MessagePublishMode.Influx) {\n      if (addr?.scope !== 'stream') {\n        alert('expected stream scope!');\n        return;\n      }\n      return getBackendSrv().post(`api/live/push/${addr.namespace}`, body);\n    }\n\n    if (!isValidLiveChannelAddress(addr)) {\n      alert('invalid address');\n      return;\n    }\n\n    const rsp = await getGrafanaLiveSrv().publish(addr, body);\n    console.log('onPublishClicked (response from publish)', rsp);\n  };\n\n  return (\n    <>\n      <CodeEditor\n        height={height - 32}\n        language={mode === MessagePublishMode.JSON ? 'json' : 'text'}\n        value={txt}\n        onBlur={doSave}\n        onSave={doSave}\n        showMiniMap={false}\n        showLineNumbers={true}\n      />\n      <div style={{ height: 32 }}>\n        <Button onClick={onPublishClicked}>Publish</Button>\n      </div>\n    </>\n  );\n}\n","import { css, cx } from '@emotion/css';\nimport { isEqual } from 'lodash';\nimport { PureComponent } from 'react';\nimport { Unsubscribable, PartialObserver } from 'rxjs';\n\nimport {\n  GrafanaTheme2,\n  PanelProps,\n  LiveChannelStatusEvent,\n  isValidLiveChannelAddress,\n  LiveChannelEvent,\n  isLiveChannelStatusEvent,\n  isLiveChannelMessageEvent,\n  LiveChannelConnectionState,\n  PanelData,\n  LoadingState,\n  applyFieldOverrides,\n  LiveChannelAddress,\n  StreamingDataFrame,\n} from '@grafana/data';\nimport { config, getGrafanaLiveSrv } from '@grafana/runtime';\nimport { Alert, stylesFactory, JSONFormatter, CustomScrollbar } from '@grafana/ui';\n\nimport { TablePanel } from '../table/TablePanel';\n\nimport { LivePublish } from './LivePublish';\nimport { LivePanelOptions, MessageDisplayMode, MessagePublishMode } from './types';\n\ninterface Props extends PanelProps<LivePanelOptions> {}\n\ninterface State {\n  error?: unknown;\n  addr?: LiveChannelAddress;\n  status?: LiveChannelStatusEvent;\n  message?: unknown;\n  changed: number;\n}\n\nexport class LivePanel extends PureComponent<Props, State> {\n  private readonly isValid: boolean;\n  subscription?: Unsubscribable;\n  styles = getStyles(config.theme2);\n\n  constructor(props: Props) {\n    super(props);\n\n    this.isValid = !!getGrafanaLiveSrv();\n    this.state = { changed: 0 };\n  }\n\n  async componentDidMount() {\n    this.loadChannel();\n  }\n\n  componentWillUnmount() {\n    if (this.subscription) {\n      this.subscription.unsubscribe();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props): void {\n    if (this.props.options?.channel !== prevProps.options?.channel) {\n      this.loadChannel();\n    }\n  }\n\n  streamObserver: PartialObserver<LiveChannelEvent> = {\n    next: (event: LiveChannelEvent) => {\n      if (isLiveChannelStatusEvent(event)) {\n        this.setState({ status: event, changed: Date.now() });\n      } else if (isLiveChannelMessageEvent(event)) {\n        this.setState({ message: event.message, changed: Date.now() });\n      } else {\n        console.log('ignore', event);\n      }\n    },\n  };\n\n  unsubscribe = () => {\n    if (this.subscription) {\n      this.subscription.unsubscribe();\n      this.subscription = undefined;\n    }\n  };\n\n  async loadChannel() {\n    const addr = this.props.options?.channel;\n    if (!isValidLiveChannelAddress(addr)) {\n      console.log('INVALID', addr);\n      this.unsubscribe();\n      this.setState({\n        addr: undefined,\n      });\n      return;\n    }\n\n    if (isEqual(addr, this.state.addr)) {\n      console.log('Same channel', this.state.addr);\n      return;\n    }\n\n    const live = getGrafanaLiveSrv();\n    if (!live) {\n      console.log('INVALID', addr);\n      this.unsubscribe();\n      this.setState({\n        addr: undefined,\n      });\n      return;\n    }\n    this.unsubscribe();\n\n    console.log('LOAD', addr);\n\n    // Subscribe to new events\n    try {\n      this.subscription = live.getStream(addr).subscribe(this.streamObserver);\n      this.setState({ addr, error: undefined });\n    } catch (err) {\n      this.setState({ addr: undefined, error: err });\n    }\n  }\n\n  renderNotEnabled() {\n    const preformatted = `[feature_toggles]\n    enable = live`;\n    return (\n      <Alert title=\"Grafana Live\" severity=\"info\">\n        <p>Grafana live requires a feature flag to run</p>\n\n        <b>custom.ini:</b>\n        <pre>{preformatted}</pre>\n      </Alert>\n    );\n  }\n\n  renderMessage(height: number) {\n    const { options } = this.props;\n    const { message } = this.state;\n\n    if (!message) {\n      return (\n        <div>\n          <h4>Waiting for data:</h4>\n          {options.channel?.scope}/{options.channel?.namespace}/{options.channel?.path}\n        </div>\n      );\n    }\n\n    if (options.display === MessageDisplayMode.JSON) {\n      return <JSONFormatter json={message} open={5} />;\n    }\n\n    if (options.display === MessageDisplayMode.Auto) {\n      if (message instanceof StreamingDataFrame) {\n        const data: PanelData = {\n          series: applyFieldOverrides({\n            data: [message],\n            theme: config.theme2,\n            replaceVariables: (v: string) => v,\n            fieldConfig: {\n              defaults: {},\n              overrides: [],\n            },\n          }),\n          state: LoadingState.Streaming,\n        } as PanelData;\n        const props: PanelProps = {\n          ...this.props,\n          options: { frameIndex: 0, showHeader: true },\n        };\n        return <TablePanel {...props} data={data} height={height} />;\n      }\n    }\n\n    return <pre>{JSON.stringify(message)}</pre>;\n  }\n\n  renderPublish(height: number) {\n    const { options } = this.props;\n    return (\n      <LivePublish\n        height={height}\n        body={options.message}\n        mode={options.publish ?? MessagePublishMode.JSON}\n        onSave={(message) => this.props.onOptionsChange({ ...options, message })}\n        addr={this.state.addr}\n      />\n    );\n  }\n\n  renderStatus() {\n    const { status } = this.state;\n    if (status?.state === LiveChannelConnectionState.Connected) {\n      return; // nothing\n    }\n\n    let statusClass = '';\n    if (status) {\n      statusClass = this.styles.status[status.state];\n    }\n    return <div className={cx(statusClass, this.styles.statusWrap)}>{status?.state}</div>;\n  }\n\n  renderBody() {\n    const { status } = this.state;\n    const { options, height } = this.props;\n    const publish = options.publish === MessagePublishMode.JSON || options.publish === MessagePublishMode.Influx;\n\n    if (publish) {\n      if (options.display === MessageDisplayMode.None) {\n        return this.renderPublish(height);\n      }\n\n      // Both message and publish\n      const halfHeight = height / 2;\n      return (\n        <div>\n          <div style={{ height: halfHeight, overflow: 'hidden' }}>\n            <CustomScrollbar autoHeightMin=\"100%\" autoHeightMax=\"100%\">\n              {this.renderMessage(halfHeight)}\n            </CustomScrollbar>\n          </div>\n          <div>{this.renderPublish(halfHeight)}</div>\n        </div>\n      );\n    }\n    if (options.display === MessageDisplayMode.None) {\n      return <pre>{JSON.stringify(status)}</pre>;\n    }\n\n    // Only message\n    return (\n      <div style={{ overflow: 'hidden', height }}>\n        <CustomScrollbar autoHeightMin=\"100%\" autoHeightMax=\"100%\">\n          {this.renderMessage(height)}\n        </CustomScrollbar>\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.isValid) {\n      return this.renderNotEnabled();\n    }\n    const { addr, error } = this.state;\n    if (!addr) {\n      return (\n        <Alert title=\"Grafana Live\" severity=\"info\">\n          Use the panel editor to pick a channel\n        </Alert>\n      );\n    }\n    if (error) {\n      return (\n        <div>\n          <h2>ERROR</h2>\n          <div>{JSON.stringify(error)}</div>\n        </div>\n      );\n    }\n    return (\n      <>\n        {this.renderStatus()}\n        {this.renderBody()}\n      </>\n    );\n  }\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2) => ({\n  statusWrap: css({\n    margin: 'auto',\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    background: theme.components.panel.background,\n    padding: '10px',\n    zIndex: theme.zIndex.modal,\n  }),\n  status: {\n    [LiveChannelConnectionState.Pending]: css({\n      border: `1px solid ${theme.v1.palette.orange}`,\n    }),\n    [LiveChannelConnectionState.Connected]: css({\n      border: `1px solid ${theme.colors.success.main}`,\n    }),\n    [LiveChannelConnectionState.Connecting]: css({\n      border: `1px solid ${theme.v1.palette.brandWarning}`,\n    }),\n    [LiveChannelConnectionState.Disconnected]: css({\n      border: `1px solid ${theme.colors.warning.main}`,\n    }),\n    [LiveChannelConnectionState.Shutdown]: css({\n      border: `1px solid ${theme.colors.error.main}`,\n    }),\n    [LiveChannelConnectionState.Invalid]: css({\n      border: '1px solid red',\n    }),\n  },\n}));\n","import { PanelPlugin } from '@grafana/data';\n\nimport { LiveChannelEditor } from './LiveChannelEditor';\nimport { LivePanel } from './LivePanel';\nimport { LivePanelOptions, MessageDisplayMode, MessagePublishMode } from './types';\n\nexport const plugin = new PanelPlugin<LivePanelOptions>(LivePanel).setPanelOptions((builder) => {\n  builder.addCustomEditor({\n    category: ['Channel'],\n    id: 'channel',\n    path: 'channel',\n    name: 'Channel',\n    editor: LiveChannelEditor,\n    defaultValue: {},\n  });\n\n  builder\n    .addRadio({\n      path: 'display',\n      name: 'Show message',\n      description: 'Display the last message received on this channel',\n      settings: {\n        options: [\n          { value: MessageDisplayMode.Raw, label: 'Raw Text' },\n          { value: MessageDisplayMode.JSON, label: 'JSON' },\n          { value: MessageDisplayMode.Auto, label: 'Auto' },\n          { value: MessageDisplayMode.None, label: 'None' },\n        ],\n      },\n      defaultValue: MessageDisplayMode.JSON,\n    })\n    .addRadio({\n      path: 'publish',\n      name: 'Publish',\n      description: 'Display a form to publish values',\n      settings: {\n        options: [\n          { value: MessagePublishMode.None, label: 'None' },\n          { value: MessagePublishMode.JSON, label: 'JSON' },\n          { value: MessagePublishMode.Influx, label: 'Influx' },\n        ],\n      },\n      defaultValue: MessagePublishMode.None,\n    });\n});\n","import { css } from '@emotion/css';\n\nimport {\n  ActionModel,\n  DashboardCursorSync,\n  DataFrame,\n  FieldMatcherID,\n  getFrameDisplayName,\n  InterpolateFunction,\n  PanelProps,\n  SelectableValue,\n  Field,\n} from '@grafana/data';\nimport { config, PanelDataErrorView } from '@grafana/runtime';\nimport { Select, Table, usePanelContext, useTheme2 } from '@grafana/ui';\nimport { TableSortByFieldState } from '@grafana/ui/internal';\n\nimport { getActions } from '../../../features/actions/utils';\n\nimport { hasDeprecatedParentRowIndex, migrateFromParentRowIndexToNestedFrames } from './migrations';\nimport { Options } from './panelcfg.gen';\n\ninterface Props extends PanelProps<Options> {}\n\nexport function TablePanel(props: Props) {\n  const { data, height, width, options, fieldConfig, id, timeRange, replaceVariables } = props;\n\n  const theme = useTheme2();\n  const panelContext = usePanelContext();\n  const frames = hasDeprecatedParentRowIndex(data.series)\n    ? migrateFromParentRowIndexToNestedFrames(data.series)\n    : data.series;\n  const count = frames?.length;\n  const hasFields = frames.some((frame) => frame.fields.length > 0);\n  const currentIndex = getCurrentFrameIndex(frames, options);\n  const main = frames[currentIndex];\n\n  let tableHeight = height;\n\n  if (!count || !hasFields) {\n    return <PanelDataErrorView panelId={id} fieldConfig={fieldConfig} data={data} />;\n  }\n\n  if (count > 1) {\n    const inputHeight = theme.spacing.gridSize * theme.components.height.md;\n    const padding = theme.spacing.gridSize;\n\n    tableHeight = height - inputHeight - padding;\n  }\n\n  const enableSharedCrosshair = panelContext.sync && panelContext.sync() !== DashboardCursorSync.Off;\n\n  const tableElement = (\n    <Table\n      height={tableHeight}\n      width={width}\n      data={main}\n      noHeader={!options.showHeader}\n      showTypeIcons={options.showTypeIcons}\n      resizable={true}\n      initialSortBy={options.sortBy}\n      onSortByChange={(sortBy) => onSortByChange(sortBy, props)}\n      onColumnResize={(displayName, resizedWidth) => onColumnResize(displayName, resizedWidth, props)}\n      onCellFilterAdded={panelContext.onAddAdHocFilter}\n      footerOptions={options.footer}\n      enablePagination={options.footer?.enablePagination}\n      cellHeight={options.cellHeight}\n      timeRange={timeRange}\n      enableSharedCrosshair={config.featureToggles.tableSharedCrosshair && enableSharedCrosshair}\n      fieldConfig={fieldConfig}\n      getActions={getCellActions}\n      replaceVariables={replaceVariables}\n    />\n  );\n\n  if (count === 1) {\n    return tableElement;\n  }\n\n  const names = frames.map((frame, index) => {\n    return {\n      label: getFrameDisplayName(frame),\n      value: index,\n    };\n  });\n\n  return (\n    <div className={tableStyles.wrapper}>\n      {tableElement}\n      <div className={tableStyles.selectWrapper}>\n        <Select options={names} value={names[currentIndex]} onChange={(val) => onChangeTableSelection(val, props)} />\n      </div>\n    </div>\n  );\n}\n\nfunction getCurrentFrameIndex(frames: DataFrame[], options: Options) {\n  return options.frameIndex > 0 && options.frameIndex < frames.length ? options.frameIndex : 0;\n}\n\nfunction onColumnResize(fieldDisplayName: string, width: number, props: Props) {\n  const { fieldConfig } = props;\n  const { overrides } = fieldConfig;\n\n  const matcherId = FieldMatcherID.byName;\n  const propId = 'custom.width';\n\n  // look for existing override\n  const override = overrides.find((o) => o.matcher.id === matcherId && o.matcher.options === fieldDisplayName);\n\n  if (override) {\n    // look for existing property\n    const property = override.properties.find((prop) => prop.id === propId);\n    if (property) {\n      property.value = width;\n    } else {\n      override.properties.push({ id: propId, value: width });\n    }\n  } else {\n    overrides.push({\n      matcher: { id: matcherId, options: fieldDisplayName },\n      properties: [{ id: propId, value: width }],\n    });\n  }\n\n  props.onFieldConfigChange({\n    ...fieldConfig,\n    overrides,\n  });\n}\n\nfunction onSortByChange(sortBy: TableSortByFieldState[], props: Props) {\n  props.onOptionsChange({\n    ...props.options,\n    sortBy,\n  });\n}\n\nfunction onChangeTableSelection(val: SelectableValue<number>, props: Props) {\n  props.onOptionsChange({\n    ...props.options,\n    frameIndex: val.value || 0,\n  });\n}\n\n// placeholder function; assuming the values are already interpolated\nconst replaceVars: InterpolateFunction = (value: string) => value;\n\nconst getCellActions = (\n  dataFrame: DataFrame,\n  field: Field,\n  rowIndex: number,\n  replaceVariables: InterpolateFunction | undefined\n) => {\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const actionsModel = getActions(\n    dataFrame,\n    field,\n    field.state!.scopedVars!,\n    replaceVariables ?? replaceVars,\n    field.config.actions ?? [],\n    { valueRowIndex: rowIndex }\n  );\n\n  actionsModel.forEach((action) => {\n    const key = `${action.title}`;\n    if (!actionLookup.has(key)) {\n      actions.push(action);\n      actionLookup.add(key);\n    }\n  });\n\n  return actions;\n};\n\nconst tableStyles = {\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-between',\n    height: '100%',\n  }),\n  selectWrapper: css({\n    padding: '8px 8px 0px 8px',\n  }),\n};\n","import { omitBy, isNil, isNumber, defaultTo, groupBy } from 'lodash';\n\nimport {\n  PanelModel,\n  FieldMatcherID,\n  ConfigOverrideRule,\n  ThresholdsMode,\n  ThresholdsConfig,\n  FieldConfig,\n  DataFrame,\n  FieldType,\n} from '@grafana/data';\nimport { ReduceTransformerOptions } from '@grafana/data/internal';\n\nimport { Options } from './panelcfg.gen';\n\n/**\n * At 7.0, the `table` panel was swapped from an angular implementation to a react one.\n * The models do not match, so this process will delegate to the old implementation when\n * a saved table configuration exists.\n */\nexport const tableMigrationHandler = (panel: PanelModel<Options>): Partial<Options> => {\n  // Table was saved as an angular table, lets just swap to the 'table-old' panel\n  if (!panel.pluginVersion && 'columns' in panel) {\n    console.log('Was angular table', panel);\n  }\n\n  // Nothing changed\n  return panel.options;\n};\n\nconst transformsMap = {\n  timeseries_to_rows: 'seriesToRows',\n  timeseries_to_columns: 'seriesToColumns',\n  timeseries_aggregations: 'reduce',\n  table: 'merge',\n};\n\nconst columnsMap = {\n  avg: 'mean',\n  min: 'min',\n  max: 'max',\n  total: 'sum',\n  current: 'lastNotNull',\n  count: 'count',\n};\n\nconst colorModeMap = {\n  cell: 'color-background',\n  row: 'color-background',\n  value: 'color-text',\n};\n\ntype Transformations = keyof typeof transformsMap;\n\ntype Transformation = {\n  id: string;\n  options: ReduceTransformerOptions;\n};\n\ntype Columns = keyof typeof columnsMap;\n\ntype Column = {\n  value: Columns;\n  text: string;\n};\n\ntype ColorModes = keyof typeof colorModeMap;\n\nconst generateThresholds = (thresholds: string[], colors: string[]) => {\n  return [-Infinity, ...thresholds].map((threshold, idx) => ({\n    color: colors[idx],\n    value: isNumber(threshold) ? threshold : parseInt(threshold, 10),\n  }));\n};\n\nconst migrateTransformations = (\n  panel: PanelModel<Partial<Options>>,\n  oldOpts: { columns: any; transform: Transformations }\n) => {\n  const transformations: Transformation[] = panel.transformations ?? [];\n  if (Object.keys(transformsMap).includes(oldOpts.transform)) {\n    const opts: ReduceTransformerOptions = {\n      reducers: [],\n    };\n    if (oldOpts.transform === 'timeseries_aggregations') {\n      opts.includeTimeField = false;\n      opts.reducers = oldOpts.columns.map((column: Column) => columnsMap[column.value]);\n    }\n    transformations.push({\n      id: transformsMap[oldOpts.transform],\n      options: opts,\n    });\n  }\n  return transformations;\n};\n\ntype Style = {\n  unit: string;\n  type: string;\n  alias: string;\n  decimals: number;\n  colors: string[];\n  colorMode: ColorModes;\n  pattern: string;\n  thresholds: string[];\n  align?: string;\n  dateFormat: string;\n  link: boolean;\n  linkTargetBlank?: boolean;\n  linkTooltip?: string;\n  linkUrl?: string;\n};\n\nconst migrateTableStyleToOverride = (style: Style) => {\n  const fieldMatcherId = /^\\/.*\\/$/.test(style.pattern) ? FieldMatcherID.byRegexp : FieldMatcherID.byName;\n  const override: ConfigOverrideRule = {\n    matcher: {\n      id: fieldMatcherId,\n      options: style.pattern,\n    },\n    properties: [],\n  };\n\n  if (style.alias) {\n    override.properties.push({\n      id: 'displayName',\n      value: style.alias,\n    });\n  }\n\n  if (style.unit) {\n    override.properties.push({\n      id: 'unit',\n      value: style.unit,\n    });\n  }\n\n  if (style.decimals) {\n    override.properties.push({\n      id: 'decimals',\n      value: style.decimals,\n    });\n  }\n\n  if (style.type === 'date') {\n    override.properties.push({\n      id: 'unit',\n      value: `time: ${style.dateFormat}`,\n    });\n  }\n\n  if (style.type === 'hidden') {\n    override.properties.push({\n      id: 'custom.hidden',\n      value: true,\n    });\n  }\n\n  if (style.link) {\n    override.properties.push({\n      id: 'links',\n      value: [\n        {\n          title: defaultTo(style.linkTooltip, ''),\n          url: defaultTo(style.linkUrl, ''),\n          targetBlank: defaultTo(style.linkTargetBlank, false),\n        },\n      ],\n    });\n  }\n\n  if (style.colorMode) {\n    override.properties.push({\n      id: 'custom.cellOptions',\n      value: {\n        type: colorModeMap[style.colorMode],\n      },\n    });\n  }\n\n  if (style.align) {\n    override.properties.push({\n      id: 'custom.align',\n      value: style.align === 'auto' ? null : style.align,\n    });\n  }\n\n  if (style.thresholds?.length) {\n    override.properties.push({\n      id: 'thresholds',\n      value: {\n        mode: ThresholdsMode.Absolute,\n        steps: generateThresholds(style.thresholds, style.colors),\n      },\n    });\n  }\n\n  return override;\n};\n\nconst migrateDefaults = (prevDefaults: Style) => {\n  let defaults: FieldConfig = {\n    custom: {},\n  };\n  if (prevDefaults) {\n    defaults = omitBy(\n      {\n        unit: prevDefaults.unit,\n        decimals: prevDefaults.decimals,\n        displayName: prevDefaults.alias,\n        custom: {\n          align: prevDefaults.align === 'auto' ? null : prevDefaults.align,\n        },\n      },\n      isNil\n    );\n\n    if (prevDefaults.thresholds.length) {\n      const thresholds: ThresholdsConfig = {\n        mode: ThresholdsMode.Absolute,\n        steps: generateThresholds(prevDefaults.thresholds, prevDefaults.colors),\n      };\n      defaults.thresholds = thresholds;\n    }\n\n    if (prevDefaults.colorMode) {\n      defaults.custom.cellOptions = {\n        type: colorModeMap[prevDefaults.colorMode],\n      };\n    }\n  }\n  return defaults;\n};\n\n/**\n * This is called when the panel changes from another panel\n */\nexport const tablePanelChangedHandler = (\n  panel: PanelModel<Partial<Options>>,\n  prevPluginId: string,\n  prevOptions: any\n) => {\n  // Changing from angular table panel\n  if (prevPluginId === 'table-old' && prevOptions.angular) {\n    const oldOpts = prevOptions.angular;\n    const transformations = migrateTransformations(panel, oldOpts);\n    const prevDefaults = oldOpts.styles.find((style: any) => style.pattern === '/.*/');\n    const defaults = migrateDefaults(prevDefaults);\n    const overrides = oldOpts.styles.filter((style: any) => style.pattern !== '/.*/').map(migrateTableStyleToOverride);\n\n    panel.transformations = transformations;\n    panel.fieldConfig = {\n      defaults,\n      overrides,\n    };\n  }\n\n  return {};\n};\n\nconst getMainFrames = (frames: DataFrame[] | null) => {\n  return frames?.filter((df) => df.meta?.custom?.parentRowIndex === undefined) || [frames?.[0]];\n};\n\n/**\n * In 9.3 meta.custom.parentRowIndex was introduced to support sub-tables.\n * In 10.2 meta.custom.parentRowIndex was deprecated in favor of FieldType.nestedFrames, which supports multiple nested frames.\n * Migrate DataFrame[] from using meta.custom.parentRowIndex to using FieldType.nestedFrames\n */\nexport const migrateFromParentRowIndexToNestedFrames = (frames: DataFrame[] | null) => {\n  const migratedFrames: DataFrame[] = [];\n  const mainFrames = getMainFrames(frames).filter(\n    (frame: DataFrame | undefined): frame is DataFrame => !!frame && frame.length !== 0\n  );\n\n  mainFrames?.forEach((frame) => {\n    const subFrames = frames?.filter((df) => frame.refId === df.refId && df.meta?.custom?.parentRowIndex !== undefined);\n    const subFramesGrouped = groupBy(subFrames, (frame: DataFrame) => frame.meta?.custom?.parentRowIndex);\n    const subFramesByIndex = Object.keys(subFramesGrouped).map((key) => subFramesGrouped[key]);\n    const migratedFrame = { ...frame };\n\n    if (subFrames && subFrames.length > 0) {\n      migratedFrame.fields.push({\n        name: 'nested',\n        type: FieldType.nestedFrames,\n        config: {},\n        values: subFramesByIndex,\n      });\n    }\n    migratedFrames.push(migratedFrame);\n  });\n\n  return migratedFrames;\n};\n\nexport const hasDeprecatedParentRowIndex = (frames: DataFrame[] | null) => {\n  return frames?.some((df) => df.meta?.custom?.parentRowIndex !== undefined);\n};\n"],"names":["getActions","frame","field","fieldScopedVars","replaceVariables","actions","config","action","dataContext","actionScopedVars","boundReplaceVariables","value","scopedVars","format","title","confirmation","evt","origin","buildActionOnClick","url","getUrl","requestHeaders","request","getData","name","error","getActionsDefaultField","dataLinks","endpoint","sanitizedRelativeURL","data","getManagedChannelInfo","v","channelInfo","channelFields","channels","c","distinctFields","f","n","HorizontalConstraint","VerticalConstraint","BackgroundImageSize","HttpRequestMethod","ConnectionPath","defaultCanvasConnection","defaultCanvasElementOptions","defaultOptions","getAPIGroupDiscoveryList","lastValueFrom","map","response","api","version","resource","sub","discoveryResources","apis","resources","scopes","LiveChannelEditor","props","setChannels","namespaces","paths","scope","namespace","used","channel","addr","onScopeChanged","onNamespaceChanged","onPathChanged","onChange","getWatchableResources","r","path","style","getStyles","Alert","Label","Select","s","Combobox","findPathOption","stylesFactory","theme","MessageDisplayMode","MessagePublishMode","LivePublish","height","mode","body","onSave","txt","doSave","onPublishClicked","rsp","CodeEditor","Button","LivePanel","event","prevProps","live","err","options","message","JSONFormatter","StreamingDataFrame","TablePanel","status","statusClass","halfHeight","CustomScrollbar","PanelPlugin","builder","width","fieldConfig","id","timeRange","panelContext","frames","count","hasFields","currentIndex","getCurrentFrameIndex","main","tableHeight","inputHeight","padding","enableSharedCrosshair","tableElement","sortBy","onSortByChange","displayName","resizedWidth","onColumnResize","getCellActions","names","index","tableStyles","val","onChangeTableSelection","fieldDisplayName","overrides","matcherId","propId","override","o","property","prop","replaceVars","dataFrame","rowIndex","actionLookup","key","tableMigrationHandler","panel","transformsMap","columnsMap","colorModeMap","generateThresholds","thresholds","colors","threshold","idx","migrateTransformations","oldOpts","transformations","opts","column","migrateTableStyleToOverride","migrateDefaults","prevDefaults","defaults","tablePanelChangedHandler","prevPluginId","prevOptions","getMainFrames","df","migrateFromParentRowIndexToNestedFrames","migratedFrames","subFrames","subFramesGrouped","subFramesByIndex","migratedFrame","hasDeprecatedParentRowIndex"],"sourceRoot":""}