"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8259],{47220:(S,T,t)=>{t.d(T,{o:()=>a});var v=t(74848),P=t(96540),h=t(36638),f=t(57866),L=t(95004),C=t(60519),W=t(54735),R=t(36192),d=t(92790),i=t(17669);function u(l,e,s=[]){for(const n of s)if(typeof n=="function"){if(!n(l,e))return!1}else if(e[n]!==l[n])return!1;return!0}const g={x:h.sJ.get(f.Ct.firstTimeField).get({}),y:h.sJ.get(f.Ct.byTypes).get(new Set([L.PU.number,L.PU.enum]))};class a extends P.Component{constructor(e){super(e),this.getTimeRange=()=>this.props.timeRange;let s=this.prepState(e);s.alignedData=s.config.prepData([s.alignedFrame]),this.state=s,this.plotInstance=P.createRef()}prepState(e,s=!0){let n=null;const{frames:o,fields:r=g,preparePlotFrame:D,replaceVariables:A,dataLinkPostProcessor:M}=e,I=D??i.m,U=o.some(x=>x.fields.some(_=>(_.config.links?.length??0)>0)),c=I(o,{...r,y:U?()=>!0:r.y},e.timeRange);if((0,R.uY)("GraphNG",!1,"data aligned",c),c){let x=c;if(U){const B=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;let E=o.map((O,p)=>({...O,fields:c.fields.filter((m,y)=>y===0||m.state?.origin?.frameIndex===p),length:c.length}));E.forEach((O,p)=>{O.fields.forEach(m=>{m.getLinks=(0,C._M)(O,m,{...m.state?.scopedVars,__dataContext:{value:{data:E,field:m,frame:O,frameIndex:p}}},A,B,M)})}),x={...c,fields:c.fields.filter((O,p)=>p===0||r.y(O,c,[c]))}}if(e.omitHideFromViz){const B=x.fields.filter(E=>E.config.custom?.hideFrom?.viz!==!0);x={...x,fields:B,length:B.length}}let _=this.state?.config;s&&(_=e.prepConfig(x,this.props.frames,this.getTimeRange),(0,R.uY)("GraphNG",!1,"config prepared",_)),n={alignedFrame:x,config:_},(0,R.uY)("GraphNG",!1,"data prepared",n.alignedData)}return n}componentDidUpdate(e){const{frames:s,structureRev:n,timeZone:o,cursorSync:r,propsToDiff:D}=this.props,A=!u(e,this.props,D);if(s!==e.frames||A||o!==e.timeZone||r!==e.cursorSync){let M=this.prepState(this.props,!1);M&&((this.state.config===void 0||o!==e.timeZone||r!==e.cursorSync||n!==e.structureRev||!n||A)&&(M.config=this.props.prepConfig(M.alignedFrame,this.props.frames,this.getTimeRange),(0,R.uY)("GraphNG",!1,"config recreated",M.config)),M.alignedData=M.config.prepData([M.alignedFrame]),this.setState(M))}}render(){const{width:e,height:s,children:n,renderLegend:o}=this.props,{config:r,alignedFrame:D,alignedData:A}=this.state;return r?(0,v.jsx)(W.KU,{width:e,height:s,legend:o(r),children:(M,I)=>(0,v.jsx)(d.Z,{config:r,data:A,width:M,height:I,plotRef:U=>this.plotInstance.current=U,children:n?n(r,D):null})}):null}}},17669:(S,T,t)=>{t.d(T,{m:()=>d});var v=t(95004),P=t(63409),h=t(8721);function f(i,u,g){let a,l;for(let e=0;e<u.length;e++)if(u[e]==null)l==null&&a!=null&&(l=e);else{if(l!=null&&a!=null){if(i[e]-a<g)for(;l<e;)u[l++]=void 0;l=null}a=i[e]}return u}var L=t(739);function C(i){return i.type===v.PU.number&&i.config.custom?.drawStyle===L.GR.Bars&&!i.config.custom?.hideFrom?.viz}function W(i,u){return i.fields.find(g=>u!=null?g.name===u:g.type===v.PU.time)}function R(i,u){const g=W(i,u);let a=g?.values;for(let l=0;l<i.fields.length;l++){let e=i.fields[l];if(e===g||C(e))continue;let s=e.config.custom?.spanNulls;typeof s=="number"&&s!==-1&&a&&(e.values=f(a,e.values,s))}return i}function d(i,u,g){let a;t:for(let n of i)for(let o of n.fields)if(u.x(o,n,i)){a=o;break t}i=i.map(n=>a?.state?.nullThresholdApplied?n:(0,P.M)({frame:n,refFieldName:a.name,refFieldPseudoMin:g?.from.valueOf(),refFieldPseudoMax:g?.to.valueOf()}));let l=i.reduce((n,o)=>n+o.fields.reduce((r,D)=>r+(C(D)?1:0),0),0),e=1/0;l>1&&i.forEach(n=>{if(!n.fields.some(C))return;const o=a.values;for(let r=0;r<o.length;r++)r>0&&(e=Math.min(e,o[r]-o[r-1]))});let s=(0,h.Fd)({frames:i,joinBy:u.x,keep:u.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:n=>{if(C(n))return h.WO;let o=n.config.custom?.spanNulls;return o===!0?h.RC:o===-1?h.WO:h.JI}});return s?(s=R(s,a.name),e!==1/0&&(s.fields.forEach((n,o)=>{let r=n.values;if(o===0){let D=r[r.length-1];r.push(D+e,D+2*e)}else C(n)?r.push(null,null):r.push(void 0,void 0)}),s.length+=2),s):null}},16608:(S,T,t)=>{t.d(T,{I:()=>u});var v=t(74848),P=t(96540),h=t(64394),f=t(95004),L=t(739),C=t(54735),W=t(78055),R=t(47220),d=t(68706);const i=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip","paginationRev"];class u extends P.Component{constructor(){super(...arguments),this.getValueColor=(a,l,e)=>{const s=this.props.frames[a]?.fields[l];if(s?.display){const n=s.display(e);if(n.color)return n.color}return h.F},this.prepConfig=(a,l,e)=>(0,d.iE)({frame:a,getTimeRange:e,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:a.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===L.$N.Multi}),this.renderLegend=a=>{const{legend:l,legendItems:e}=this.props;return!a||!e||!l||l.showLegend===!1?null:(0,v.jsx)(C.KU.Legend,{placement:l.placement,children:(0,v.jsx)(W.t,{placement:l.placement,items:e,displayMode:l.displayMode,readonly:!0})})}}render(){return(0,v.jsx)(R.o,{...this.props,fields:{x:a=>a.type===f.PU.time,y:a=>a.type===f.PU.number||a.type===f.PU.boolean||a.type===f.PU.string||a.type===f.PU.enum},prepConfig:this.prepConfig,propsToDiff:i,renderLegend:this.renderLegend,omitHideFromViz:!0})}}},44391:(S,T,t)=>{t.d(T,{K:()=>g});var v=t(74848),P=t(95004),h=t(739),f=t(55302),L=t(39064),C=t(61048),W=t(41530),R=t(47466),d=t(68706),i=t(16913),u=t(76234);const g=({series:a,dataIdxs:l,seriesIdx:e,mode:s=h.$N.Single,sortOrder:n=h.xB.None,isPinned:o,annotate:r,timeRange:D,withDuration:A,maxHeight:M,replaceVariables:I,dataLinks:U})=>{const c=a.fields[0],x=e!=null?l[e]:l.find(p=>p!=null),_=c.display(c.values[x]).text;s=o?h.$N.Single:s;const B=(0,f.cp)(a.fields,c,l,e,s,n);if(A&&s===h.$N.Single){const p=a.fields[e],m=(0,d.GY)(p,x);let y;m&&(y=c.values[m]);const K=c.values[x];let F;if(y)F=y&&(0,d.c5)(y-K);else{const V=D.to.valueOf();F=(0,d.c5)(V-K)}B.push({label:"Duration",value:F})}let E;if(e!=null){const p=a.fields[e],m=U.some(y=>y.oneClick===!0);if(o||m){const y=l[e],K=(0,i.OG)(a,p,I,y);E=(0,v.jsx)(L.S,{dataLinks:U,actions:K,annotate:r})}}const O={label:c.type===P.PU.time?"":c.state?.displayName??c.name,value:_};return(0,v.jsxs)(C.i,{children:[(0,v.jsx)(W.A,{item:O,isPinned:o}),(0,v.jsx)(R.o,{items:B,isPinned:o,scrollable:(0,u.T5)({mode:s,maxHeight:M}),maxHeight:M}),E]})}},11686:(S,T,t)=>{t.d(T,{K:()=>P,Q:()=>h});var v=t(739);const P={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:v.yL.Auto},h={fillOpacity:70,lineWidth:0}},28343:(S,T,t)=>{t.d(T,{W:()=>i,i:()=>R});var v=t(74848),P=t(22803),h=t(96540),f=t(49185),L=t(34213),C=t(68706),W=t(11686);const R={container:(0,P.css)({display:"flex",flexDirection:"column"})},d={paginationContainer:(0,P.css)({display:"flex",justifyContent:"center",width:"100%"}),paginationElement:(0,P.css)({marginTop:"8px"})};function i(u,g){const[a,l]=(0,h.useState)(1),[e,{height:s,width:n}]=(0,f.A)(),o=(0,h.useMemo)(()=>!g||u==null?u:(0,C.uB)(u),[u,g]);if(!g||o==null)return{paginatedFrames:o,paginationRev:"disabled",paginationElement:void 0,paginationHeight:0};g||=W.K.perPage;const r=Math.ceil(o.length/g),D=Math.min(a,r),A=(D-1)*g,M=o.slice(A,A+g),I=`${D}/${g}`,U=n<550,c=(0,v.jsx)("div",{className:d.paginationContainer,ref:e,children:(0,v.jsx)(L.d,{className:d.paginationElement,currentPage:D,numberOfPages:r,showSmallVersion:U,onNavigate:l})});return{paginatedFrames:M,paginationRev:I,paginationElement:c,paginationHeight:s}}},24181:(S,T,t)=>{t.r(T),t.d(T,{plugin:()=>B});var v=t(16207),P=t(83340),h=t(64394),f=t(739),L=t(45013),C=t(44017),W=t(41069),R=t(79277),d=t(74848),i=t(96540),u=t(84229),g=t(63142),a=t(64400),l=t(18667),e=t(69234),s=t(16608),n=t(68706),o=t(44391),r=t(28343),D=t(36327),A=t(13507),M=t(76234);const I=({data:E,timeRange:O,timeZone:p,options:m,width:y,height:K,replaceVariables:F,onChangeTimeRange:V})=>{const j=(0,g.$j)(),[q,$]=(0,i.useState)(null),{sync:tt,eventsScope:et,canAddAnnotations:J,dataLinkPostProcessor:nt,eventBus:at}=(0,a.d2)(),z=tt?.()??u.y.Off,Q=!!(J&&J()),{frames:st,warn:X}=(0,i.useMemo)(()=>(0,n.Qe)(E.series,!1,O,j),[E.series,O,j]),{paginatedFrames:N,paginationRev:it,paginationElement:lt,paginationHeight:ot}=(0,r.W)(st,m.perPage),rt=(0,i.useMemo)(()=>(0,n.Or)(N,m.legend,j),[N,m.legend,j]),dt=(0,i.useMemo)(()=>(0,M.Fg)(m.timezone,p),[m.timezone,p]);return!N||X?(0,d.jsx)("div",{className:"panel-empty",children:(0,d.jsx)("p",{children:X??"No data found in response"})}):N[0].length>y/2?(0,d.jsx)("div",{className:"panel-empty",children:(0,d.jsxs)("p",{children:["Too many points to visualize properly. ",(0,d.jsx)("br",{}),"Update the query to return fewer points. ",(0,d.jsx)("br",{}),"(",N[0].length," points received)"]})}):(0,d.jsxs)("div",{className:r.i.container,children:[(0,d.jsx)(s.I,{theme:j,frames:N,structureRev:E.structureRev,paginationRev:it,timeRange:O,timeZone:dt,width:y,height:K-ot,legendItems:rt,...m,mode:n.pm.Samples,replaceVariables:F,dataLinkPostProcessor:nt,cursorSync:z,children:(H,G)=>(0,d.jsxs)(d.Fragment,{children:[z!==u.y.Off&&(0,d.jsx)(l.K,{config:H,eventBus:at,frame:G}),m.tooltip.mode!==f.$N.None&&(0,d.jsx)(e.xl,{config:H,hoverMode:m.tooltip.mode===f.$N.Multi?e.b3.xAll:e.b3.xOne,queryZoom:V,syncMode:z,syncScope:et,getDataLinks:(Z,Y)=>G.fields[Z].getLinks?.({valueRowIndex:Y})??[],render:(Z,Y,ut,ft,w,b,gt,mt)=>{if(Q&&b!=null){$(b),w();return}const ht=()=>{let k=Z.posToVal(Z.cursor.left,"x");$({from:k,to:k}),w()};return(0,d.jsx)(o.K,{series:G,dataIdxs:Y,seriesIdx:ut,mode:gt?f.$N.Multi:m.tooltip.mode,sortOrder:m.tooltip.sort,isPinned:ft,timeRange:O,annotate:Q?ht:void 0,withDuration:!1,maxHeight:m.tooltip.maxHeight,replaceVariables:F,dataLinks:mt})},maxWidth:m.tooltip.maxWidth}),G.fields[0].config.custom?.axisPlacement!==f.vM.Hidden&&(0,d.jsx)(D.W,{annotations:E.annotations??[],config:H,timeZone:p,newRange:q,setNewRange:$,canvasRegionRendering:!1}),(0,d.jsx)(A.U,{config:H,onChangeTimeRange:V})]})}),lt]})},U={colWidth:.9,perPage:20,rowHeight:.9,showValue:f.yL.Auto},c={fillOpacity:70,lineWidth:1};var x=t(73495);class _{getSuggestionsForData(O){const{dataSummary:p}=O;if(!p.hasData||!p.hasTimeField||!p.hasStringField&&!p.hasNumberField||p.numberFieldCount>=30||p.rowCountMax>100||p.preferredVisualisationType==="logs")return;O.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:h.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:y=>{y.options.colWidth=.7}}}).append({name:x.m.StatusHistory})}}const B=new v.m(I).useFieldConfig({standardOptions:{[P.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:h.Y.Thresholds}},[P.uo.Links]:{settings:{showOneClick:!0}},[P.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:E=>{E.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:c.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:c.fillOpacity,settings:{min:0,max:100,step:1}}),L.e(E),C.Wq(E,O=>O===f.vM.Auto||O===f.vM.Hidden),C.T4(E)}}).setPanelOptions(E=>{E.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:f.yL.Auto,label:"Auto"},{value:f.yL.Always,label:"Always"},{value:f.yL.Never,label:"Never"}]},defaultValue:f.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addNumberInput({path:"perPage",name:"Page size (enable pagination)",settings:{min:1,step:1,integer:!0}}),W.H(E,!1),R.D(E)}).setSuggestionsSupplier(new _).setDataSupport({annotations:!0})}}]);

//# sourceMappingURL=statusHistoryPanel.192ef084ca63132cf254.js.map