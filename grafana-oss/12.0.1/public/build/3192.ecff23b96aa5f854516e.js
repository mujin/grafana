"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3192],{83192:(ca,z,t)=>{t.d(z,{A:()=>na});var a=t(74848),M=t(22803),C=t(49785),Y=t(36490),V=t(63142),K=t(6975),D=t(34999),W=t(16780),B=t(37386),g=t(63527),j=t(45861),e=t(56840),m=t(51686),y=t(5358),T=t(77256),l=t(97539),O=t(1972),G=t(2543),$=t(96540),F=t(41654),L=t(30703),H=t(21285),X=t(97095),Z=t(18027),_=t(76319),ea=t(45967),ia=t(10427),q=t(78747);const ra="Times must be between 00:00 and 24:00 UTC",ma=({intervalIndex:n})=>{const u=(0,V.of)(la),{register:s,formState:v,getValues:S,watch:U}=(0,C.xW)(),k=U(`time_intervals.${n}.disable`),{fields:x,append:P,remove:d}=(0,C.jz)({name:`time_intervals.${n}.times`}),I=v.errors.time_intervals?.[n],R=I?.times?.some?.(p=>p?.start_time||p?.end_time)??!1;return(0,a.jsxs)("div",{children:[(0,a.jsx)(B.D,{className:u.field,label:(0,e.t)("alerting.mute-timing-time-range.label-time-range","Time range"),description:"The time inclusive of the start and exclusive of the end time (in UTC if no location has been selected, otherwise local time)",invalid:R,children:(0,a.jsx)(a.Fragment,{children:x.map((p,N)=>{const J=I?.times?.[N],oa=`time_intervals.${n}.times.${N}.start_time`,aa=`time_intervals.${n}.times.${N}.end_time`,Q=()=>{const w=S(oa),ua=S(aa);return[w,ua]};return(0,a.jsx)("div",{className:u.timeRange,children:(0,a.jsxs)(X.C,{children:[(0,a.jsx)(Z.I,{label:(0,e.t)("alerting.mute-timing-time-range.label-start-time","Start time"),invalid:!!J?.start_time,error:J?.start_time?.message,children:(0,a.jsx)(g.p,{...s(oa,{validate:w=>{if(!(0,q.Hy)(w))return ra;const[da,Aa]=Q();if(!(0,q.oB)(da,Aa))return"Start time must be before end time"}}),className:u.timeRangeInput,maxLength:5,readOnly:k,suffix:(0,a.jsx)(L.I,{name:"clock-nine"}),defaultValue:p.start_time,placeholder:(0,e.t)("alerting.mute-timing-time-range.mute-timing-starts-at-placeholder-hhmm","HH:mm"),"data-testid":"mute-timing-starts-at"})}),(0,a.jsx)(Z.I,{label:(0,e.t)("alerting.mute-timing-time-range.label-end-time","End time"),invalid:!!J?.end_time,error:J?.end_time?.message,children:(0,a.jsx)(g.p,{...s(`time_intervals.${n}.times.${N}.end_time`,{validate:w=>{if(!(0,q.Hy)(w))return ra;const[da,Aa]=Q();if(!(0,q.oB)(da,Aa))return"End time must be after start time"}}),className:u.timeRangeInput,maxLength:5,readOnly:k,suffix:(0,a.jsx)(L.I,{name:"clock-nine"}),defaultValue:p.end_time,placeholder:(0,e.t)("alerting.mute-timing-time-range.mute-timing-ends-at-placeholder-hhmm","HH:mm"),"data-testid":"mute-timing-ends-at"})}),(0,a.jsx)(_.K,{className:u.deleteTimeRange,title:(0,e.t)("alerting.mute-timing-time-range.title-remove","Remove"),name:"trash-alt",onClick:w=>{w.preventDefault(),d(N)},tooltip:(0,e.t)("alerting.mute-timing-time-range.tooltip-remove-time-range","Remove time range")})]})},p.id)})})}),(0,a.jsx)(ia.A,{shouldWrap:k,wrap:p=>(0,a.jsx)(ea.m,{content:"This time interval is disabled",placement:"right-start",children:p}),children:(0,a.jsx)(j.$n,{className:u.addTimeRange,variant:"secondary",type:"button",icon:"plus",disabled:k,onClick:()=>P({start_time:"",end_time:""}),children:(0,a.jsx)(e.x6,{i18nKey:"alerting.mute-timing-time-range.add-another-time-range",children:"Add another time range"})})})]})},la=n=>({field:(0,M.css)({marginBottom:0}),timeRange:(0,M.css)({marginBottom:n.spacing(1)}),timeRangeInput:(0,M.css)({width:"90px"}),deleteTimeRange:(0,M.css)({margin:`${n.spacing(1)} 0 0 ${n.spacing(.5)}`}),addTimeRange:(0,M.css)({marginBottom:n.spacing(2)})});var r=t(18857);const i=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Atikokan","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Ciudad_Juarez","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Nuuk","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Shiprock","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/South_Pole","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Chongqing","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Harbin","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yangon","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Kyiv","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","GMT","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Local","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kanton","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis","UTC"],c=n=>{const u=i.map(s=>({label:s,value:s}));return(0,a.jsx)(r.l6,{...n,options:u})},f=()=>{const n=(0,V.of)(A),{formState:u,register:s,setValue:v}=(0,C.xW)(),{fields:S,append:U,remove:k}=(0,C.jz)({name:"time_intervals"}),{isGrafanaAlertmanager:x}=(0,y.VI)();return(0,a.jsx)(W.n,{label:(0,e.t)("alerting.mute-timing-time-interval.label-time-intervals","Time intervals"),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"A time interval is a definition for a moment in time. All fields are lists, and at least one list element must be satisfied to match the field. If a field is left blank, any moment of time will match the field. For an instant of time to match a complete time interval, all fields must match. A mute timing can contain multiple time intervals."}),(0,a.jsx)(F.B,{direction:"column",gap:2,children:S.map((P,d)=>{const I=u.errors;return s(`time_intervals.${d}.location`),(0,a.jsxs)("div",{className:n.timeIntervalSection,children:[(0,a.jsx)(ma,{intervalIndex:d}),(0,a.jsx)(B.D,{label:(0,e.t)("alerting.mute-timing-time-interval.label-location","Location"),invalid:!!I.time_intervals?.[d]?.location,error:I.time_intervals?.[d]?.location?.message,children:(0,a.jsx)(c,{prefix:(0,a.jsx)(L.I,{name:"map-marker"}),width:50,onChange:R=>{v(`time_intervals.${d}.location`,R.value)},defaultValue:{label:P.location,value:P.location},"data-testid":"mute-timing-location"})}),(0,a.jsx)(B.D,{label:(0,e.t)("alerting.mute-timing-time-interval.label-days-of-the-week","Days of the week"),children:(0,a.jsx)(o,{onChange:R=>{v(`time_intervals.${d}.weekdays`,R)},defaultValue:P.weekdays})}),(0,a.jsx)(B.D,{label:(0,e.t)("alerting.mute-timing-time-interval.label-days-of-the-month","Days of the month"),description:"The days of the month, 1:31, of a month. Negative values can be used to represent days which begin at the end of the month",invalid:!!I.time_intervals?.[d]?.days_of_month,error:I.time_intervals?.[d]?.days_of_month?.message,children:(0,a.jsx)(g.p,{...s(`time_intervals.${d}.days_of_month`,{validate:E}),width:50,defaultValue:P.days_of_month,placeholder:(0,e.t)("alerting.mute-timing-time-interval.mute-timing-days-placeholder-example","Example: 1, 14:16, -1"),"data-testid":"mute-timing-days"})}),(0,a.jsx)(B.D,{label:(0,e.t)("alerting.mute-timing-time-interval.label-months","Months"),description:"The months of the year in either numerical or the full calendar month",invalid:!!I.time_intervals?.[d]?.months,error:I.time_intervals?.[d]?.months?.message,children:(0,a.jsx)(g.p,{...s(`time_intervals.${d}.months`,{validate:R=>(0,l.Ww)(R,p=>l.KR.includes(p)||parseInt(p,10)<13&&parseInt(p,10)>0,"Invalid month")}),width:50,placeholder:(0,e.t)("alerting.mute-timing-time-interval.mute-timing-months-placeholder-example-mayaugust-december","Example: 1:3, may:august, december"),defaultValue:P.months,"data-testid":"mute-timing-months"})}),(0,a.jsx)(B.D,{label:(0,e.t)("alerting.mute-timing-time-interval.label-years","Years"),invalid:!!I.time_intervals?.[d]?.years,error:I.time_intervals?.[d]?.years?.message??"",children:(0,a.jsx)(g.p,{...s(`time_intervals.${d}.years`,{validate:R=>(0,l.Ww)(R,p=>/^\d{4}$/.test(p),"Invalid year")}),width:50,placeholder:(0,e.t)("alerting.mute-timing-time-interval.mute-timing-years-placeholder-example","Example: 2021:2022, 2030"),defaultValue:P.years,"data-testid":"mute-timing-years"})}),(0,a.jsxs)(F.B,{direction:"row",gap:2,children:[(0,a.jsx)(j.$n,{type:"button",variant:"destructive",fill:"outline",icon:"trash-alt",onClick:()=>k(d),children:(0,a.jsx)(e.x6,{i18nKey:"alerting.mute-timing-time-interval.remove-time-interval",children:"Remove time interval"})}),!x&&(0,a.jsx)(H.K,{id:`time_intervals.${d}.disable`,label:(0,e.t)("alerting.mute-timing-time-interval.label-disable","Disable"),showLabel:!0,transparent:!0,...s(`time_intervals.${d}.disable`)})]})]},P.id)})}),(0,a.jsx)(j.$n,{type:"button",variant:"secondary",className:n.removeTimeIntervalButton,onClick:()=>{U(l.oU)},icon:"plus",children:(0,a.jsx)(e.x6,{i18nKey:"alerting.mute-timing-time-interval.add-another-time-interval",children:"Add another time interval"})})]})})},b=n=>{const u=n.split(",").map(s=>s.trim()).flatMap(s=>s.includes(":")?h(s):s).map(s=>s.toLowerCase()).filter(s=>l.jU.includes(s));return(0,G.uniq)(u)};function E(n){return(0,l.Ww)(n,u=>{if(!/^-?\d+$/.test(u))return!1;const s=parseInt(u,10);return s>-31&&s<0||s>0&&s<32},"Invalid day")}function h(n){const[u="",s=""]=n.split(":"),v=l.jU.indexOf(u),S=l.jU.indexOf(s);return l.jU.slice(v,S+1)}const o=({defaultValue:n="",onChange:u})=>{const s=(0,V.of)(A),v=b(n),[S,U]=(0,$.useState)(v),k=x=>{S.includes(x)?U(P=>(0,G.without)(P,x)):U(P=>(0,G.concat)(P,x))};return(0,$.useEffect)(()=>{u(S.join(", "))},[S,u]),(0,a.jsx)("div",{"data-testid":"mute-timing-weekdays",children:(0,a.jsx)(F.B,{gap:1,children:l.jU.map(x=>{const P=(0,M.cx)(s.dayOfTheWeek,S.includes(x)&&"selected"),d=x.slice(0,3);return(0,a.jsx)("button",{type:"button",className:P,onClick:()=>k(x),children:(0,G.upperFirst)(d)},x)})})})},A=n=>({input:(0,M.css)({width:"400px"}),timeIntervalSection:(0,M.css)({backgroundColor:n.colors.background.secondary,padding:n.spacing(2)}),removeTimeIntervalButton:(0,M.css)({marginTop:n.spacing(2)}),dayOfTheWeek:(0,M.css)({cursor:"pointer",userSelect:"none",padding:`${n.spacing(1)} ${n.spacing(3)}`,border:`solid 1px ${n.colors.border.medium}`,background:"none",borderRadius:n.shape.radius.default,color:n.colors.text.secondary,"&.selected":{fontWeight:n.typography.fontWeightBold,color:n.colors.primary.text,borderColor:n.colors.primary.border,background:n.colors.primary.transparent}})}),sa=n=>{const u={name:"",time_intervals:[l.oU]};if(!n)return u;const s=n.time_intervals.map(v=>({times:v.times,weekdays:v.weekdays?.join(", "),days_of_month:v.days_of_month?.join(", "),months:v.months?.join(", "),years:v.years?.join(", "),location:v.location??l.oU.location,disable:(0,l.jb)(v)}));return{name:n.name,time_intervals:s}},ga=({muteTiming:n,showError:u,loading:s,provisioned:v,editMode:S})=>{const{selectedAlertmanager:U}=(0,y.VI)(),k={alertmanager:U},[x]=(0,m.XW)(k),[P]=(0,m.SD)(k),d=(0,m.br)(k),I=(0,V.of)(ta),R=sa(n),p=(0,C.mN)({defaultValues:R,values:R}),N=p.formState.isSubmitting,J=(0,T.nL)("/alerting/routes/",U,{tab:"mute_timings"}),oa=async aa=>{const Q=(0,l.iF)(aa);return(async()=>S?P.execute({interval:Q,originalName:n?.metadata?.name||n.name}):x.execute({interval:Q}))().then(()=>{Y.Ny.push(J)})};return s?(0,a.jsx)(K._,{text:(0,e.t)("alerting.mute-timing-form.text-loading-mute-timing","Loading mute timing")}):u?(0,a.jsx)(D.F,{title:(0,e.t)("alerting.mute-timing-form.title-no-matching-mute-timing-found","No matching mute timing found")}):(0,a.jsxs)(a.Fragment,{children:[v&&(0,a.jsx)(O.Yi,{resource:O.hk.MuteTiming}),(0,a.jsx)(C.Op,{...p,children:(0,a.jsx)("form",{onSubmit:p.handleSubmit(oa),"data-testid":"mute-timing-form",children:(0,a.jsxs)(W.n,{disabled:v||N,children:[(0,a.jsx)(B.D,{required:!0,label:(0,e.t)("alerting.mute-timing-form.label-name","Name"),description:(0,e.t)("alerting.mute-timing-form.description-unique-timing","A unique name for the mute timing"),invalid:!!p.formState.errors?.name,error:p.formState.errors.name?.message,children:(0,a.jsx)(g.p,{...p.register("name",{required:!0,validate:async aa=>{const Q=S&&aa===n?.name;return d(aa,Q)}}),className:I.input,"data-testid":"mute-timing-name"})}),(0,a.jsx)(f,{}),(0,a.jsx)(j.$n,{type:"submit",className:I.submitButton,disabled:N,icon:N?"spinner":void 0,children:N?(0,a.jsx)(e.x6,{i18nKey:"alerting.mute-timings.saving",children:"Saving mute timing"}):(0,a.jsx)(e.x6,{i18nKey:"alerting.mute-timings.save",children:"Save mute timing"})}),(0,a.jsx)(j.z9,{type:"button",variant:"secondary",fill:"outline",href:J,disabled:N,children:(0,a.jsx)(e.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})})})]})},ta=n=>({input:(0,M.css)({width:"400px"}),submitButton:(0,M.css)({marginRight:n.spacing(1)})}),na=ga},51686:(ca,z,t)=>{t.d(z,{XW:()=>ea,gB:()=>ra,zm:()=>ia,Ad:()=>_,my:()=>la,SD:()=>q,br:()=>ma});var a=t(96540),M=t(91984),C=t(5709);const Y=["TimeInterval"],K=C.H.enhanceEndpoints({addTagTypes:Y}).injectEndpoints({endpoints:r=>({listNamespacedTimeInterval:r.query({query:i=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${i.namespace}/timeintervals`,params:{pretty:i.pretty,allowWatchBookmarks:i.allowWatchBookmarks,continue:i.continue,fieldSelector:i.fieldSelector,labelSelector:i.labelSelector,limit:i.limit,resourceVersion:i.resourceVersion,resourceVersionMatch:i.resourceVersionMatch,sendInitialEvents:i.sendInitialEvents,timeoutSeconds:i.timeoutSeconds,watch:i.watch}}),providesTags:["TimeInterval"]}),createNamespacedTimeInterval:r.mutation({query:i=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${i.namespace}/timeintervals`,method:"POST",body:i.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:i.pretty,dryRun:i.dryRun,fieldManager:i.fieldManager,fieldValidation:i.fieldValidation}}),invalidatesTags:["TimeInterval"]}),replaceNamespacedTimeInterval:r.mutation({query:i=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${i.namespace}/timeintervals/${i.name}`,method:"PUT",body:i.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:i.pretty,dryRun:i.dryRun,fieldManager:i.fieldManager,fieldValidation:i.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteNamespacedTimeInterval:r.mutation({query:i=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${i.namespace}/timeintervals/${i.name}`,method:"DELETE",body:i.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:i.pretty,dryRun:i.dryRun,gracePeriodSeconds:i.gracePeriodSeconds,orphanDependents:i.orphanDependents,propagationPolicy:i.propagationPolicy}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1});var D=t(78747),W=t(52161),B=t(22628),g=t(56476),j=t(85618),e=t(80218),m=t(43100),y=t(72748);const{useLazyGetAlertmanagerConfigurationQuery:T,useGetMuteTimingListQuery:l}=M.m,{useLazyListNamespacedTimeIntervalQuery:O,useCreateNamespacedTimeIntervalMutation:G,useReplaceNamespacedTimeIntervalMutation:$,useDeleteNamespacedTimeIntervalMutation:F}=K,L=r=>{const{metadata:i,spec:c}=r;return{...c,id:c.name,metadata:i,provisioned:(0,g.Uo)(r)}},H=(r,i)=>({...r,id:r.name,provisioned:!!(i&&i!==B.rh)}),X=()=>T({selectFromResult:({data:r,...i})=>{if(!r)return{data:r,...i};const{alertmanager_config:c}=r,f=c.muteTimeProvenances??{};return{data:(0,D.IT)(c).map(h=>H(h,f[h.name])),...i}}}),Z=()=>O({selectFromResult:({data:r,...i})=>({data:r?.items.map(c=>L(c)),...i})}),_=({alertmanager:r,skip:i})=>{const c=(0,g.dM)(r),[f,b]=Z(),[E,h]=X();return(0,a.useEffect)(()=>{if(!i)if(c){const o=(0,j.G)();f({namespace:o})}else E(r)},[r,E,f,i,c]),c?b:h},ea=({alertmanager:r})=>{const i=(0,g.dM)(r),[c]=G(),[f]=(0,m.d)(),b=(0,e.Yb)(({interval:h})=>{const o=(0,j.G)();return c({namespace:o,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{metadata:{},spec:h}}).unwrap()}),E=(0,e.Yb)(({interval:h})=>{const o=(0,y.X9)({interval:h});return f(o)});return i?b:E},ia=({alertmanager:r,name:i})=>{const c=(0,g.dM)(r),[f,b]=O({selectFromResult:({data:o,...A})=>o?o.items.length===0?{...A,data:void 0,isError:!0}:{data:L(o.items[0]),...A}:{data:o,...A}}),[E,h]=T({selectFromResult:({data:o,...A})=>{if(!o)return{data:o,...A};const sa=o?.alertmanager_config??{},ta=(0,D.IT)(sa).find(({name:na})=>na===i);if(ta){const na=sa?.muteTimeProvenances??{};return{data:H(ta,na[ta.name]),...A}}return{...A,data:void 0,isError:!0}}});return(0,a.useEffect)(()=>{if(c){const o=(0,j.G)(),A=(0,g.O)(i);f({namespace:o,fieldSelector:`spec.name=${A}`},!0)}else E(r,!0)},[r,E,f,i,c]),c?b:h},q=({alertmanager:r})=>{const i=(0,g.dM)(r),[c]=$(),[f]=(0,m.d)(),b=(0,e.Yb)(async({interval:h,originalName:o})=>{const A=(0,j.G)();return c({name:o,namespace:A,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{spec:h,metadata:{name:o}}}).unwrap()}),E=(0,e.Yb)(async({interval:h,originalName:o})=>{const A=(0,y.ov)({interval:h,originalName:o});return f(A)});return i?b:E},ra=({alertmanager:r})=>{const i=(0,g.dM)(r),[c,f]=(0,m.d)(),[b]=F(),E=(0,e.Yb)(async({name:o})=>{const A=(0,y.$8)({name:o});return c(A)}),h=(0,e.Yb)(async({name:o})=>{const A=(0,j.G)();await b({name:o,namespace:A,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap()});return i?h:E},ma=({alertmanager:r})=>{const i=(0,g.dM)(r),[c]=X();return i?()=>{}:async(f,b)=>{if(!b)return c(r).unwrap().then(E=>!!(0,D.IT)(E.alertmanager_config)?.find(A=>A.name===f)?`Mute timing already exists with name "${f}"`:void 0)}},la=({alertmanager:r,skip:i})=>{const c=(0,g.dM)(r),f=r===W.hY&&!c,b=l(void 0,{skip:i||!f}),E=_({alertmanager:r,skip:i||f});return f?b:E}},78747:(ca,z,t)=>{t.d(z,{Hy:()=>W,IT:()=>B,av:()=>j,oB:()=>g});var a=t(74848),M=t(95093),C=t.n(M),Y=t(96540),V=t(41654),K=t(86017);const D=/^((([01][0-9])|(2[0-3])):[0-5][0-9])$|(^24:00$)/,W=e=>e?D.test(e):!0,B=e=>[...e.mute_time_intervals??[],...e.time_intervals??[]],g=(e,m)=>{if(!e&&!m)return!0;if(!e&&m||e&&!m)return!1;const y="HH:mm",T=C()().startOf("day").add(e,y),l=C()().startOf("day").add(m,y);return!!(e&&m&&T.isBefore(l)||e&&m&&l.isAfter(T))};function j(e){const y=e.time_intervals.map((T,l)=>{const{times:O,weekdays:G,days_of_month:$,months:F,years:L,location:H}=T,X=(0,K.Dm)(O,H),Z=(0,K.uH)(G),_=(0,K.UL)($),ea=(0,K.$P)(F),ia=(0,K.mP)(L);return(0,a.jsx)(Y.Fragment,{children:(0,a.jsxs)("div",{children:[`${X} ${Z}`,(0,a.jsx)("br",{}),[_,ea,ia].join(" | "),(0,a.jsx)("br",{})]})},JSON.stringify(T)+l)});return(0,a.jsx)(V.B,{direction:"column",gap:1,children:y})}},97539:(ca,z,t)=>{t.d(z,{KR:()=>Y,Ww:()=>K,d6:()=>j,iF:()=>W,jU:()=>C,jb:()=>g,oU:()=>V});var a=t(2543),M=t.n(a);const C=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Y=["january","february","march","april","may","june","july","august","september","october","november","december"],V={times:[{start_time:"",end_time:""}],weekdays:"",days_of_month:"",months:"",years:"",location:"",disable:!1},K=(e,m,y)=>e?e.split(",").map(T=>T.trim()).every(T=>T.split(":").every(m))||y:!0,D=e=>e?e.split(",").map(m=>m.trim()):void 0,W=e=>{const m=e.time_intervals.map(({times:y,weekdays:T,days_of_month:l,months:O,years:G,location:$,disable:F})=>{const L={times:B(y,F),weekdays:D(T)?.map(H=>H.toLowerCase()),days_of_month:D(l),months:D(O),years:D(G),location:$||void 0};return(0,a.omitBy)(L,a.isUndefined)});return{name:e.name,time_intervals:m}};function B(e,m){if(m)return[];const y=e?.filter(({start_time:T,end_time:l})=>!!T&&!!l);return y?.length?y:void 0}function g(e){return e.times?.length===0||e.weekdays?.length===0||e.days_of_month?.length===0||e.months?.length===0||e.years?.length===0}function j(e){return e.time_intervals.every(m=>g(m))}}}]);

//# sourceMappingURL=3192.ecff23b96aa5f854516e.js.map