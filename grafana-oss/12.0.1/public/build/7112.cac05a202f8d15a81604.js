"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7112],{70159:(Ne,ne,t)=>{t.d(ne,{$Z:()=>e,OY:()=>c,r3:()=>l});const e={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage",commonLabels:"grafana.explore.logs.commonLabels"},c="grafana.explore.logs",l="grafana.explore.logs.visualisationType"},17896:(Ne,ne,t)=>{t.d(ne,{Dh:()=>O,K6:()=>ae,V7:()=>N,rg:()=>je,u8:()=>Y});var e=t(74848),c=t(22803),l=t(96540),b=t(17548),re=t(1906),L=t(43173),$=t(27489),F=t(739),s=t(45861),H=t(30703),S=t(56840),E=t(82212);const Y=({app:f,children:j,loading:I,loadMoreLogs:k,range:te,rows:X,scrollElement:V,sortOrder:Q,timeZone:h,topScrollEnabled:J=!1})=>{const[de,ue]=(0,l.useState)(!1),[ke,Le]=(0,l.useState)(!1),[pe,Re]=(0,l.useState)(!1),[Se,Ie]=(0,l.useState)(!1),Be=(0,l.useRef)(X),Fe=(0,l.useRef)(V?.scrollTop||0),Oe=(0,l.useRef)(null),We=(0,l.useRef)(0);(0,l.useEffect)(()=>{ue(!1),Le(!1)},[te,X,Q]),(0,l.useEffect)(()=>{I||(Re(!1),Ie(!1))},[I]),(0,l.useEffect)(()=>{Se&&V&&V.scrollTo(0,V.scrollHeight-V.clientHeight)},[Se,V]),(0,l.useEffect)(()=>{X!==Be.current&&X.length===Be.current.length&&(pe||Se)&&(Q===F.uH.Descending&&Se?Le(!0):Q===F.uH.Ascending&&pe&&ue(!0)),Be.current=X},[Se,X,Q,pe]),(0,l.useEffect)(()=>{if(!V||!k)return;function Ee(be){if(!V||!k||!X.length||I||!L.$.featureToggles.logsInfiniteScrolling)return;const fe=N(be,Oe.current,We,V,Fe.current);Oe.current=be,Fe.current=V.scrollTop,fe!==0&&(be.stopImmediatePropagation(),fe===-1&&J?ge():fe===1&&He(),Oe.current=null)}function ge(){const be=ve(ae(X),te,h,Q);if(!be){ue(!0);return}ue(!1),k?.(be),Re(!0),(0,$.rR)("grafana_logs_infinite_scrolling",{direction:"top",sort_order:Q})}function He(){const be=je(ae(X),te,h,Q);if(!be){Le(!0);return}Le(!1),k?.(be),Ie(!0),(0,$.rR)("grafana_logs_infinite_scrolling",{direction:"bottom",sort_order:Q})}return V.addEventListener("scroll",Ee),V.addEventListener("wheel",Ee),()=>{V.removeEventListener("scroll",Ee),V.removeEventListener("wheel",Ee)}},[k,I,te,X,V,Q,h,J]);const Ke=Q===F.uH.Descending&&b.isRelativeTime(te.raw.to),Ce=Q===F.uH.Ascending&&b.isRelativeTime(te.raw.to),$e=(0,l.useCallback)(()=>{(0,$.rR)("grafana_explore_logs_infinite_pagination_clicked",{pageType:"olderLogsButton"});const Ee=ve(ae(X),te,h,Q);if(!Ee){ue(!0);return}ue(!1),k?.(Ee),Re(!0),V?.scroll({behavior:"auto",top:0})},[k,te,X,V,Q,h]);return(0,e.jsxs)(e.Fragment,{children:[pe&&(0,e.jsx)(E.I,{adjective:Q===F.uH.Descending?"newer":"older"}),!Ke&&de&&m,Q===F.uH.Ascending&&f===re.Jk.Explore&&k&&(0,e.jsx)(s.$n,{className:z.navButton,variant:"secondary",onClick:$e,disabled:I,children:(0,e.jsxs)("div",{className:z.navButtonContent,children:[(0,e.jsx)(H.I,{name:"angle-up",size:"lg"}),(0,e.jsx)(S.x6,{i18nKey:"logs.infinite-scroll.older-logs",children:"Older logs"})]})}),j,!Ce&&ke&&m,Se&&(0,e.jsx)(E.I,{adjective:Q===F.uH.Descending?"older":"newer"})]})},z={messageContainer:(0,c.css)({textAlign:"center",padding:.25}),navButton:(0,c.css)({width:"58px",height:"68px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",lineHeight:"1",position:"absolute",top:0,right:-3,zIndex:1}),navButtonContent:(0,c.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",whiteSpace:"normal"})},m=(0,e.jsx)("div",{className:z.messageContainer,"data-testid":"end-of-range",children:(0,e.jsx)(S.x6,{i18nKey:"logs.out-of-range-message.end-of-the-selected-time-range",children:"End of the selected time range."})});var O=(f=>(f[f.Top=-1]="Top",f[f.Bottom=1]="Bottom",f[f.NoScroll=0]="NoScroll",f))(O||{});function N(f,j,I,k,te){if(k.scrollHeight<=k.clientHeight)return 0;const X=f instanceof WheelEvent?f.deltaY:k.scrollTop-te;if(X===0)return 0;const V=X<0?-1:1;return(V===-1?k.scrollTop:k.scrollHeight-k.scrollTop-k.clientHeight)>1||!j||ce(f,j,I)?0:V}function ce(f,j,I){const k=f.timeStamp-j.timeStamp;return k>500?(I.current=0,!1):(I.current++,k<100?I.current>=180?(I.current=0,!1):!0:k<400&&I.current>=25?(I.current=0,!1):!0)}function ae(f){const j=f[0].timeEpochMs,I=f[f.length-1].timeEpochMs;return I<j?{from:I,to:j}:{from:j,to:I}}function Te(f,j){return{from:j.from.valueOf(),to:f.from}}function q(f,j,I){return j=Z(j,I),{from:f.to,to:j.to.valueOf()}}const oe=1e3;function ve(f,j,I,k){return k===F.uH.Descending?(j=Z(j,I),j.to.valueOf()-f.to>oe?q(f,j,I):void 0):Math.abs(j.from.valueOf()-f.from)>oe?Te(f,j):void 0}function je(f,j,I,k){return k===F.uH.Descending?Math.abs(j.from.valueOf()-f.from)>oe?Te(f,j):void 0:(j=Z(j,I),j.to.valueOf()-f.to>oe?q(f,j,I):void 0)}function Z(f,j){return b.isRelativeTimeRange(f.raw)?b.convertRawToRange(f.raw,j):f}},82212:(Ne,ne,t)=>{t.d(ne,{I:()=>b});var e=t(74848),c=t(22803),l=t(68079);const b=({adjective:L="newer"})=>{const $=`Loading ${L} logs...`;return(0,e.jsx)("div",{className:re,children:(0,e.jsxs)("div",{children:[$," ",(0,e.jsx)(l.y,{inline:!0})]})})},re=(0,c.css)({display:"flex",justifyContent:"center"})},76487:(Ne,ne,t)=>{t.d(ne,{I:()=>s,b:()=>H});var e=t(74848),c=t(22803),l=t(41811),b=t(27489),re=t(76319),L=t(56840),$=t(21429);const F=(0,l.default)(S=>({buttonRow:(0,c.css)({display:"flex",flexDirection:"row",gap:S.spacing(.5),marginLeft:S.spacing(.5)})})),s="___LOG_LINE_BODY___",H=S=>{const E=()=>{const{onClickShowField:q,row:oe}=S;q&&q(s),(0,b.rR)("grafana_explore_logs_log_details_show_body_clicked",{datasourceType:oe.datasourceType,logRowUid:oe.uid,type:"enable",app:S.app})},Y=()=>{const{onClickHideField:q,row:oe}=S;q&&q(s),(0,b.rR)("grafana_explore_logs_log_details_show_body_clicked",{datasourceType:oe.datasourceType,logRowUid:oe.uid,type:"disable",app:S.app})},{theme:z,displayedFields:m,disableActions:O,row:N}=S,ce=F(z),ae=(0,$.D)(z),Te=m!=null&&m.includes(s)?(0,e.jsx)(re.K,{variant:"primary",tooltip:(0,L.t)("logs.log-details-body.toggle-field-button.tooltip-hide-log-line","Hide log line"),name:"eye",onClick:Y}):(0,e.jsx)(re.K,{tooltip:(0,L.t)("logs.log-details-body.toggle-field-button.tooltip-show-log-line","Show log line"),name:"eye",onClick:E});return(0,e.jsxs)("tr",{className:ae.logDetailsValue,children:[(0,e.jsx)("td",{className:ae.logsDetailsIcon,children:(0,e.jsx)("div",{className:ce.buttonRow,children:!O&&m&&Te})}),(0,e.jsx)("td",{className:ae.logDetailsLabel,colSpan:100,children:N.entry})]})}},59896:(Ne,ne,t)=>{t.d(ne,{A:()=>E,h:()=>S});var e=t(74848),c=t(22803),l=t(96540),b=t(63142),re=t(45967),L=t(45861),$=t(30703),F=t(56840),s=t(76487);const H=["detected_level","level","lvl","filename"],S=(0,l.memo)(({labels:m,emptyMessage:O,addTooltip:N=!0,displayMax:ce,onDisplayMaxToggle:ae,displayAll:Te=!1})=>{const[q,oe]=(0,l.useState)(ce?Te:void 0),ve=(0,b.of)(z),je=(0,l.useMemo)(()=>Object.keys(m).filter(f=>!f.startsWith("_")&&!H.includes(f)&&m[f]).map(f=>`${f}=${m[f]}`),[m]),Z=(0,l.useMemo)(()=>je.slice(0,!q&&ce?ce:1/0),[je,q,ce]);return Z.length===0&&O?(0,e.jsx)("span",{className:ve.logsLabels,children:(0,e.jsx)("span",{className:ve.logsLabel,children:O})}):(0,e.jsxs)("span",{className:ve.logsLabels,children:[Z.map(f=>N?(0,e.jsx)(re.m,{content:f,placement:"top",children:(0,e.jsx)(Y,{styles:ve,children:f})},f):(0,e.jsx)(Y,{styles:ve,tooltip:f,children:f},f)),Z.length<je.length&&!q&&(0,e.jsxs)(L.$n,{size:"sm",fill:"outline",variant:"secondary","aria-label":(0,F.t)("logs.log-labels.expand","Expand labels"),onClick:()=>{oe(!0),ae?.(!0)},children:[(0,e.jsx)($.I,{name:"plus",size:"xs"}),je.length-Z.length]}),q===!0&&(0,e.jsx)(L.$n,{size:"sm",fill:"outline",variant:"secondary","aria-label":(0,F.t)("logs.log-labels.collapse","Collapse labels"),onClick:()=>{oe(!1),ae?.(!1)},children:(0,e.jsx)($.I,{name:"minus",size:"xs"})})]})});S.displayName="LogLabels";const E=(0,l.memo)(({labels:m})=>{const O=(0,b.of)(z);return(0,e.jsx)("span",{className:O.logsLabels,children:m.map(N=>(0,e.jsx)(Y,{styles:O,tooltip:N,children:N===s.I?"log line":N},N))})});E.displayName="LogLabelsList";const Y=(0,l.forwardRef)(({styles:m,tooltip:O,children:N},ce)=>(0,e.jsx)("span",{className:m.logsLabel,ref:ce,children:(0,e.jsx)("span",{className:m.logsLabelValue,title:O,children:N})}));Y.displayName="LogLabel";const z=m=>({logsLabels:(0,c.css)({display:"flex",flexWrap:"wrap",fontSize:m.typography.size.xs,alignItems:"center"}),logsLabel:(0,c.css)({label:"logs-label",display:"flex",padding:m.spacing(0,.25),backgroundColor:m.colors.background.secondary,borderRadius:m.shape.radius.default,margin:m.spacing(.125,.5,0,0),textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxHeight:m.spacing(2)}),logsLabelValue:(0,c.css)({label:"logs-label__value",display:"inline-block",maxWidth:m.spacing(25),textOverflow:"ellipsis",overflow:"hidden"})})},25461:(Ne,ne,t)=>{t.d(ne,{$:()=>H});var e=t(74848),c=t(88838),l=t(96540),b=t(23257),re=t.n(b),L=t(38388),$=t(63142);function F(S,E){return E.split(/;\s*/).reduce((Y,z)=>{if(z==="color:rgba(0,0,0,0.5)")return{color:S.colors.text.secondary};const m=z.match(/([^:\s]+)\s*:\s*(.+)/);if(m&&m[1]&&m[2]){const O=m[1].replace(/-([a-z])/g,(N,ce)=>ce.toUpperCase());Y[O]=m[2]}return Y},{})}class s extends l.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(E,Y){return E.value===Y.prevValue?null:{chunks:c.Ay.parse(E.value).spans.map(m=>m.css?{style:F(E.theme,m.css),text:m.text}:{text:m.text}),prevValue:E.value}}render(){const{chunks:E}=this.state;return E.map((Y,z)=>{const m=this.props.highlight?.searchWords?(0,e.jsx)(re(),{textToHighlight:Y.text,searchWords:this.props.highlight.searchWords,findChunks:L.Oq,highlightClassName:this.props.highlight.highlightClassName},z):Y.text;return Y.style?(0,e.jsx)("span",{style:Y.style,"data-testid":"ansiLogLine",children:m},z):m})}}const H=(0,$.cV)(s);H.displayName="LogMessageAnsi"},20444:(Ne,ne,t)=>{t.d(ne,{k:()=>st});var e=t(74848),c=t(22803),l=t(96540),b=t(739),re=t(43173),L=t(63142),$=t(71599),F=t(30703),s=t(56840),H=t(27489),S=t(87063),E=t(74746);const Y=({x:n,y:a,onClickFilterString:o,onClickFilterOutString:r,selection:i,row:p,close:u,...v})=>{const A=(0,l.useRef)(null),M=(0,L.of)(m);(0,l.useEffect)(()=>{function R(d){d.key==="Escape"&&u()}return document.addEventListener("keyup",R),()=>{document.removeEventListener("keyup",R)}},[u]);const D=(0,l.useCallback)(()=>{z("popover_menu_disabled",i.length,p.datasourceType),v.onDisable()},[v,p.datasourceType,i.length]);return o||r?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:M.menu,style:{top:a,left:n},children:(0,e.jsxs)(S.W,{ref:A,children:[(0,e.jsx)(S.W.Item,{label:(0,s.t)("logs.popover-menu.copy","Copy selection"),onClick:()=>{(0,E.Dk)(i,A),u(),z("copy",i.length,p.datasourceType)}}),o&&(0,e.jsx)(S.W.Item,{label:(0,s.t)("logs.popover-menu.line-contains","Add as line contains filter"),onClick:()=>{o(i,p.dataFrame.refId),u(),z("line_contains",i.length,p.datasourceType)}}),r&&(0,e.jsx)(S.W.Item,{label:(0,s.t)("logs.popover-menu.line-contains-not","Add as line does not contain filter"),onClick:()=>{r(i,p.dataFrame.refId),u(),z("line_does_not_contain",i.length,p.datasourceType)}}),(0,e.jsx)(S.W.Divider,{}),(0,e.jsx)(S.W.Item,{label:(0,s.t)("logs.popover-menu.disable-menu","Disable menu"),onClick:D})]})})}):null};function z(n,a,o){(0,H.rR)("grafana_explore_logs_popover_menu",{action:n,selectionLength:a,datasourceType:o||"unknown"})}const m=n=>({menu:(0,c.css)({position:"fixed",zIndex:n.zIndex.modal})});class O{constructor(){this.seen=new Set,this.count=0}getKey(a){this.count+=1;const o=`k_${a}`;return this.seen.has(o)?`i_${this.count}`:(this.seen.add(o),o)}}var N=t(2543),ce=t(80011),ae=t(45967),Te=t(39443),q=t(76487),oe=t(41811),ve=t(1906),je=t(47931),Z=t(76319),f=t(28134),j=t(37234),I=t(65240);const k=n=>({logsStatsRow:(0,c.css)({label:"logs-stats-row",margin:`${parseInt(n.spacing(2),10)/1.75}px 0`}),logsStatsRowActive:(0,c.css)({label:"logs-stats-row--active",color:n.colors.primary.text,position:"relative"}),logsStatsRowLabel:(0,c.css)({label:"logs-stats-row__label",display:"flex",marginBottom:"1px"}),logsStatsRowValue:(0,c.css)({label:"logs-stats-row__value",flex:1,textOverflow:"ellipsis",overflow:"hidden"}),logsStatsRowCount:(0,c.css)({label:"logs-stats-row__count",textAlign:"right",marginLeft:n.spacing(.75)}),logsStatsRowPercent:(0,c.css)({label:"logs-stats-row__percent",textAlign:"right",marginLeft:n.spacing(.75),width:n.spacing(4.5)}),logsStatsRowBar:(0,c.css)({label:"logs-stats-row__bar",height:n.spacing(.5),overflow:"hidden",background:n.colors.text.disabled}),logsStatsRowInnerBar:(0,c.css)({label:"logs-stats-row__innerbar",height:n.spacing(.5),overflow:"hidden",background:n.colors.primary.main})}),te=({active:n,count:a,proportion:o,value:r})=>{const i=(0,L.of)(k),p=`${Math.round(o*100)}%`,u={width:p},v=n?(0,c.cx)([i.logsStatsRow,i.logsStatsRowActive]):(0,c.cx)([i.logsStatsRow]);return(0,e.jsxs)("div",{className:v,children:[(0,e.jsxs)("div",{className:(0,c.cx)([i.logsStatsRowLabel]),children:[(0,e.jsx)("div",{className:(0,c.cx)([i.logsStatsRowValue]),title:r,children:r}),(0,e.jsx)("div",{className:(0,c.cx)([i.logsStatsRowCount]),children:a}),(0,e.jsx)("div",{className:(0,c.cx)([i.logsStatsRowPercent]),children:p})]}),(0,e.jsx)("div",{className:(0,c.cx)([i.logsStatsRowBar]),children:(0,e.jsx)("div",{className:(0,c.cx)([i.logsStatsRowInnerBar]),style:u})})]})};te.displayName="LogLabelStatsRow";const X=5,V=(0,I.N)(n=>({logsStats:(0,c.css)({label:"logs-stats",background:"inherit",color:n.colors.text.primary,wordBreak:"break-all",width:"fit-content",maxWidth:"100%"}),logsStatsHeader:(0,c.css)({label:"logs-stats__header",borderBottom:`1px solid ${n.colors.border.medium}`,display:"flex"}),logsStatsTitle:(0,c.css)({label:"logs-stats__title",fontWeight:n.typography.fontWeightMedium,paddingRight:n.spacing(2),display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),logsStatsClose:(0,c.css)({label:"logs-stats__close",cursor:"pointer"}),logsStatsBody:(0,c.css)({label:"logs-stats__body",padding:"5px 0px"})}));class Q extends l.PureComponent{render(){const{label:a,rowCount:o,stats:r,value:i,theme:p,isLabel:u}=this.props,v=V(p),A=r.slice(0,X);let M=A.find(g=>g.value===i),D=r.slice(X);const T=!M;T&&(M=D.find(g=>g.value===i),D=D.filter(g=>g.value!==i));const R=D.reduce((g,x)=>g+x.count,0),y=A.reduce((g,x)=>g+x.count,0)+R,w=R/y;return(0,e.jsxs)("div",{className:v.logsStats,"data-testid":"logLabelStats",children:[(0,e.jsx)("div",{className:v.logsStatsHeader,children:(0,e.jsxs)("div",{className:v.logsStatsTitle,children:[a,": ",y," of ",o," rows have that ",u?"label":"field"]})}),(0,e.jsxs)("div",{className:v.logsStatsBody,children:[A.map(g=>(0,e.jsx)(te,{...g,active:g.value===i},g.value)),T&&M&&(0,e.jsx)(te,{...M,active:!0},M.value),R>0&&(0,e.jsx)(te,{count:R,value:"Other",proportion:w},"__OTHERS__")]})]})}}const h=(0,L.cV)(Q);h.displayName="LogLabelStats";var J=t(21429);const de=(0,oe.default)(n=>({labelType:(0,c.css)({border:`solid 1px ${n.colors.text.secondary}`,color:n.colors.text.secondary,borderRadius:n.shape.radius.circle,fontSize:n.spacing(1),lineHeight:n.spacing(1.25),height:n.spacing(1.5),width:n.spacing(1.5),display:"flex",justifyContent:"center",verticalAlign:"middle",marginLeft:n.spacing(1)}),wordBreakAll:(0,c.css)({label:"wordBreakAll",wordBreak:"break-all"}),copyButton:(0,c.css)({"& > button":{color:n.colors.text.secondary,padding:0,justifyContent:"center",borderRadius:n.shape.radius.circle,height:n.spacing(n.components.height.sm),width:n.spacing(n.components.height.sm),svg:{margin:0},"span > div":{top:"-5px","& button":{color:n.colors.success.main}}}}),adjoiningLinkButton:(0,c.css)({marginLeft:n.spacing(1)}),wrapLine:(0,c.css)({label:"wrapLine",whiteSpace:"pre-wrap"}),logDetailsStats:(0,c.css)({padding:`0 ${n.spacing(1)}`}),logDetailsValue:(0,c.css)({display:"flex",alignItems:"center",lineHeight:"22px",".log-details-value-copy":{visibility:"hidden"},"&:hover":{".log-details-value-copy":{visibility:"visible"}}}),buttonRow:(0,c.css)({display:"flex",flexDirection:"row",gap:n.spacing(.5),marginLeft:n.spacing(.5)})}));class ue extends l.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:a,parsedKeys:o,row:r}=this.props;a&&a(o[0]),(0,H.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:r.datasourceType,logRowUid:r.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:a,parsedKeys:o,row:r}=this.props;a&&a(o[0]),(0,H.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:r.datasourceType,logRowUid:r.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:a,parsedKeys:o,parsedValues:r,row:i}=this.props;return a?await a(o[0],r[0],i.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:a,parsedKeys:o,parsedValues:r,row:i}=this.props;a&&a(o[0],r[0],(0,j.f8)(i)||void 0),(0,H.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:i.datasourceType,filterType:"include",logRowUid:i.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:a,parsedKeys:o,parsedValues:r,row:i}=this.props;a&&a(o[0],r[0],(0,j.f8)(i)||void 0),(0,H.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:i.datasourceType,filterType:"exclude",logRowUid:i.uid})},this.updateStats=()=>{const{getStats:a}=this.props,o=a(),r=o?o.reduce((i,p)=>i+p.count,0):0;(!(0,N.isEqual)(this.state.fieldStats,o)||r!==this.state.fieldCount)&&this.setState({fieldStats:o,fieldCount:r})},this.showStats=()=>{const{isLabel:a,row:o,app:r}=this.props,{showFieldsStats:i}=this.state;i||this.updateStats(),this.toggleFieldsStats(),(0,H.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:o.datasourceType,fieldType:a?"label":"detectedField",type:i?"close":"open",logRowUid:o.uid,app:r})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(a=>({showFieldsStats:!a.showFieldsStats}))}generateClipboardButton(a){const{theme:o}=this.props,r=de(o);return(0,e.jsx)("div",{className:`log-details-value-copy ${r.copyButton}`,children:(0,e.jsx)(je.b,{getText:()=>a,title:(0,s.t)("logs.un-themed-log-details-row.title-copy-value-to-clipboard","Copy value to clipboard"),fill:"text",variant:"secondary",icon:"copy",size:"md"})})}generateMultiVal(a,o){return(0,e.jsx)("table",{children:(0,e.jsx)("tbody",{children:a?.map((r,i)=>(0,e.jsx)("tr",{children:(0,e.jsxs)("td",{children:[r,o&&r!==""&&this.generateClipboardButton(r)]})},`${r}-${i}`))})})}render(){const{theme:a,parsedKeys:o,parsedValues:r,isLabel:i,links:p,displayedFields:u,wrapLogMessage:v,onClickFilterLabel:A,onClickFilterOutLabel:M,disableActions:D,row:T,app:R,onPinLine:d,pinLineButtonTooltipTitle:y}=this.props,{showFieldsStats:w,fieldStats:g,fieldCount:x}=this.state,C=de(a),B=(0,J.D)(a),W=o==null?!1:o.length===1,ee=r==null?!1:r.length===1,U=!D&&A&&M,le=R===ve.Jk.Explore&&T.dataFrame?.refId?` in query ${T.dataFrame?.refId}`:"",G=W?(0,E.dO)(o[0],T):null,he=!ee&&r!=null&&!r.every(_=>_===""),ye=u&&o!=null&&u.includes(o[0])?(0,e.jsx)(Z.K,{variant:"primary",tooltip:(0,s.t)("logs.un-themed-log-details-row.toggle-field-button.tooltip-hide-this-field","Hide this field"),name:"eye",onClick:this.hideField}):(0,e.jsx)(Z.K,{tooltip:(0,s.t)("logs.un-themed-log-details-row.toggle-field-button.tooltip-field-instead-message","Show this field instead of the message"),name:"eye",onClick:this.showField});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("tr",{className:B.logDetailsValue,children:[(0,e.jsx)("td",{className:B.logsDetailsIcon,children:(0,e.jsxs)("div",{className:C.buttonRow,children:[U&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Le,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:le}),(0,e.jsx)(Z.K,{name:"search-minus",tooltip:`Filter out value${le}`,onClick:this.filterOutLabel})]}),!D&&u&&ye,!D&&(0,e.jsx)(Z.K,{variant:w?"primary":"secondary",name:"signal",tooltip:(0,s.t)("logs.un-themed-log-details-row.tooltip-adhoc-statistics","Ad-hoc statistics"),className:"stats-button",disabled:!W,onClick:this.showStats})]})}),(0,e.jsx)("td",{children:G&&(0,e.jsx)(ke,{type:G,styles:C})}),(0,e.jsx)("td",{className:B.logDetailsLabel,children:W?o[0]:this.generateMultiVal(o)}),(0,e.jsx)("td",{className:(0,c.cx)(C.wordBreakAll,v&&C.wrapLine),children:(0,e.jsxs)("div",{className:C.logDetailsValue,children:[ee?r[0]:this.generateMultiVal(r,!0),ee&&this.generateClipboardButton(r[0]),(0,e.jsx)("div",{className:(0,c.cx)((ee||he)&&C.adjoiningLinkButton),children:p?.map((_,xe)=>{if(_.onClick&&d){const Pe=_.onClick;_.onClick=(P,we)=>{d(T,!1),Pe(P,we)}}return(0,e.jsx)("span",{children:(0,e.jsx)(f.R,{buttonProps:{tooltip:typeof y=="object"&&_.onClick?y:void 0},link:_})},`${_.title}-${xe}`)})})]})})]}),w&&W&&ee&&(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{colSpan:2,children:(0,e.jsx)(Z.K,{variant:w?"primary":"secondary",name:"signal",tooltip:(0,s.t)("logs.un-themed-log-details-row.tooltip-hide-adhoc-statistics","Hide ad-hoc statistics"),onClick:this.showStats})}),(0,e.jsx)("td",{colSpan:2,children:(0,e.jsx)("div",{className:C.logDetailsStats,children:(0,e.jsx)(h,{stats:g,label:o[0],value:r[0],rowCount:x,isLabel:i})})})]})]})}}function ke({type:n,styles:a}){return(0,e.jsx)(ae.m,{content:n,children:(0,e.jsx)("div",{className:a.labelType,children:(0,e.jsx)("span",{children:n.substring(0,1)})})})}const Le=({isActive:n,tooltipSuffix:a,...o})=>{const[r,i]=(0,l.useState)(!1),p=r?"Remove filter":"Filter for value";return(0,l.useEffect)(()=>{n().then(i)},[n]),(0,e.jsx)(Z.K,{...o,variant:r?"primary":void 0,tooltip:p+a})},pe=(0,L.cV)(ue);pe.displayName="LogDetailsRow";var Re=t(62215);class Se extends l.PureComponent{render(){const{app:a,row:o,theme:r,hasError:i,onClickFilterOutLabel:p,onClickFilterLabel:u,getRows:v,showDuplicates:A,className:M,onClickShowField:D,onClickHideField:T,displayedFields:R,getFieldLinks:d,wrapLogMessage:y,onPinLine:w,styles:g,pinLineButtonTooltipTitle:x}=this.props,C=(0,J.L)(r,o.logLevel),B=o.labels?o.labels:{},W=Object.keys(B).length>0,ee=(0,Re.jE)(o,d);let U=ee.filter(P=>P.links?.length);const le=U.filter(P=>P.fieldIndex!==o.entryFieldIndex).sort(),G=U.filter(P=>P.fieldIndex===o.entryFieldIndex).sort(),he=(0,Re.qE)(G),ye=le&&le.length>0||he&&he.length>0,_=o.dataFrame.meta?.type===Te.m.LogLines?[]:ee.filter(P=>P.links?.length===0&&P.fieldIndex!==o.entryFieldIndex).sort(),xe=_&&_.length>0,Pe=i?"":`${C.logsRowLevelColor} ${g.logsRowLevel} ${g.logsRowLevelDetails}`;return(0,e.jsxs)("tr",{className:(0,c.cx)(M,g.logDetails),children:[A&&(0,e.jsx)("td",{}),(0,e.jsx)("td",{className:Pe,"aria-label":(0,s.t)("logs.un-themed-log-details.aria-label-log-level","Log level")}),(0,e.jsx)("td",{colSpan:4,children:(0,e.jsx)("div",{className:g.logDetailsContainer,children:(0,e.jsx)("table",{className:g.logDetailsTable,children:(0,e.jsxs)("tbody",{children:[R&&R.length>0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:100,className:g.logDetailsHeading,"aria-label":(0,s.t)("logs.un-themed-log-details.aria-label-fields","Fields"),children:(0,e.jsx)(s.x6,{i18nKey:"logs.log-details.log-line",children:"Log line"})})}),(0,e.jsx)(q.b,{onClickShowField:D,onClickHideField:T,row:o,app:a,displayedFields:R,disableActions:!1,theme:r})]}),(W||xe)&&(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:100,className:g.logDetailsHeading,"aria-label":(0,s.t)("logs.un-themed-log-details.aria-label-fields","Fields"),children:(0,e.jsx)(s.x6,{i18nKey:"logs.log-details.fields",children:"Fields"})})}),Object.keys(B).sort().map((P,we)=>{const se=B[P];return(0,e.jsx)(pe,{parsedKeys:[P],parsedValues:[se],isLabel:!0,getStats:()=>(0,E.Tj)(v(),P),onClickFilterOutLabel:p,onClickFilterLabel:u,onClickShowField:D,onClickHideField:T,row:o,app:a,wrapLogMessage:y,displayedFields:R,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${P}=${se}-${we}`)}),_.map((P,we)=>{const{keys:se,values:ie,fieldIndex:Me}=P;return(0,e.jsx)(pe,{parsedKeys:se,parsedValues:ie,onClickShowField:D,onClickHideField:T,onClickFilterOutLabel:p,onClickFilterLabel:u,getStats:()=>(0,E.s2)(o.dataFrame.fields[Me].values),displayedFields:R,wrapLogMessage:y,row:o,app:a,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${se[0]}=${ie[0]}-${we}`)}),ye&&(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:100,className:g.logDetailsHeading,"aria-label":(0,s.t)("logs.un-themed-log-details.aria-label-data-links","Data links"),children:(0,e.jsx)(s.x6,{i18nKey:"logs.log-details.links",children:"Links"})})}),le.map((P,we)=>{const{keys:se,values:ie,links:Me,fieldIndex:Ae}=P;return(0,e.jsx)(pe,{parsedKeys:se,parsedValues:ie,links:Me,onClickShowField:D,onClickHideField:T,onPinLine:w,pinLineButtonTooltipTitle:x,getStats:()=>(0,E.s2)(o.dataFrame.fields[Ae].values),displayedFields:R,wrapLogMessage:y,row:o,app:a,disableActions:!1},`${se[0]}=${ie[0]}-${we}`)}),he?.map((P,we)=>{const{keys:se,values:ie,links:Me,fieldIndex:Ae}=P;return(0,e.jsx)(pe,{parsedKeys:se,parsedValues:ie,links:Me,onClickShowField:D,onClickHideField:T,onPinLine:w,pinLineButtonTooltipTitle:x,getStats:()=>(0,E.s2)(o.dataFrame.fields[Ae].values),displayedFields:R,wrapLogMessage:y,row:o,app:a,disableActions:!0},`${se[0]}=${ie[0]}-${we}`)}),!xe&&!W&&!ye&&(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:100,"aria-label":(0,s.t)("logs.un-themed-log-details.aria-label-no-details","No details"),children:(0,e.jsx)(s.x6,{i18nKey:"logs.log-details.no-details",children:"No details available"})})})]})})})})]})}}const Ie=(0,L.cV)(Se);Ie.displayName="LogDetails";var Be=t(59896),Fe=t(23257),Oe=t.n(Fe),We=t(38388),Ke=t(25461);const Ce=(0,l.memo)(({logText:n,onOpenContext:a,onPermalinkClick:o,onPinLine:r,onUnpinLine:i,pinLineButtonTooltipTitle:p,pinned:u,row:v,showContextToggle:A,styles:M,mouseIsOver:D,onBlur:T,getRowContextQuery:R,addonBefore:d,addonAfter:y})=>{const w=(0,l.useMemo)(()=>A?A(v):!1,[v,A]),g=(0,l.useCallback)(U=>{U.stopPropagation()},[]),x=(0,l.useCallback)(async U=>{U.stopPropagation(),(0,E.R)(U,v,R,a)},[a,R,v]),C=(0,l.useCallback)(U=>{!U.currentTarget.contains(U.relatedTarget)&&T&&T()},[T]),B=(0,l.useCallback)(()=>n,[n]),W=(0,l.useMemo)(()=>d?$e(d,v):null,[d,v]),ee=(0,l.useMemo)(()=>y?$e(y,v):null,[y,v]);return(0,e.jsxs)("span",{className:`log-row-menu ${M.rowMenu}`,onClick:g,onBlur:C,children:[u&&!D&&(0,e.jsx)(Z.K,{className:M.unPinButton,size:"md",name:"gf-pin",onClick:()=>i&&i(v),tooltip:(0,s.t)("logs.log-row-menu-cell.tooltip-unpin-line","Unpin line"),tooltipPlacement:"top","aria-label":(0,s.t)("logs.log-row-menu-cell.aria-label-unpin-line","Unpin line"),tabIndex:0}),D&&(0,e.jsxs)(e.Fragment,{children:[W,w&&(0,e.jsx)(Z.K,{size:"md",name:"gf-show-context",onClick:x,tooltip:(0,s.t)("logs.log-row-menu-cell.tooltip-show-context","Show context"),tooltipPlacement:"top","aria-label":(0,s.t)("logs.log-row-menu-cell.aria-label-show-context","Show context"),tabIndex:0}),(0,e.jsx)(je.b,{className:M.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:B,tooltip:(0,s.t)("logs.log-row-menu-cell.tooltip-copy-to-clipboard","Copy to clipboard"),tooltipPlacement:"top",tabIndex:0}),u&&i&&(0,e.jsx)(Z.K,{className:M.unPinButton,size:"md",name:"gf-pin",onClick:()=>i&&i(v),tooltip:(0,s.t)("logs.log-row-menu-cell.tooltip-unpin-line","Unpin line"),tooltipPlacement:"top","aria-label":(0,s.t)("logs.log-row-menu-cell.aria-label-unpin-line","Unpin line"),tabIndex:0}),!u&&r&&(0,e.jsx)(Z.K,{className:M.unPinButton,size:"md",name:"gf-pin",onClick:()=>r&&r(v),tooltip:p??"Pin line",tooltipPlacement:"top","aria-label":(0,s.t)("logs.log-row-menu-cell.aria-label-pin-line","Pin line"),tabIndex:0}),o&&v.rowId!==void 0&&v.uid&&(0,e.jsx)(Z.K,{tooltip:(0,s.t)("logs.log-row-menu-cell.tooltip-copy-shortlink","Copy shortlink"),"aria-label":(0,s.t)("logs.log-row-menu-cell.aria-label-copy-shortlink","Copy shortlink"),tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>o(v),tabIndex:0}),ee]})]})});function $e(n,a){return n.map((o,r)=>{if((0,l.isValidElement)(o)){const i=o.props.onClick;return i?(0,l.cloneElement)(o,{onClick:p=>{i(p,a)},key:r}):o}return o})}Ce.displayName="LogRowMenuCell";const Ee=1e5,ge=({hasAnsi:n,entry:a,highlights:o,styles:r})=>{const i=(0,l.useMemo)(()=>a.length-Ee,[a]),p=o&&o.length>0&&o[0]&&o[0].length>0&&i<=0,u=o??[],[v,A]=(0,l.useState)(i<0),M=(0,l.useMemo)(()=>v?a:a.substring(0,Ee),[a,v]);if(n){const D=p?{searchWords:u,highlightClassName:r.logsRowMatchHighLight}:void 0;return(0,e.jsx)(Ke.$,{value:M,highlight:D})}else if(p)return(0,e.jsx)(Oe(),{textToHighlight:M,searchWords:u,findChunks:We.Oq,highlightClassName:r.logsRowMatchHighLight});return(0,e.jsxs)(e.Fragment,{children:[M,!v&&(0,e.jsx)(He,{showFull:v,toggle:A,diff:i})]})},He=({toggle:n,diff:a})=>{const o=be((0,L.$j)()),r=i=>{i.stopPropagation(),n(!0)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.x6,{i18nKey:"logs.log-row-message.ellipsis",children:"\u2026 "}),(0,e.jsxs)("span",{className:o.showMore,onClick:r,children:[a," ",(0,e.jsx)(s.x6,{i18nKey:"logs.log-row-message.more",children:"more"})]})]})},be=n=>({showMore:(0,c.css)({display:"inline-flex",fontWeight:n.typography.fontWeightMedium,fontSize:n.typography.size.sm,fontFamily:n.typography.fontFamily,height:n.spacing(3),padding:n.spacing(.25,1),color:n.colors.secondary.text,border:`1px solid ${n.colors.border.strong}`,"&:hover":{background:n.colors.secondary.transparent,borderColor:n.colors.emphasize(n.colors.border.strong,.25),color:n.colors.secondary.text}})}),fe=(n,a,o,r)=>{if(a)try{return JSON.stringify(JSON.parse(n),void 0,2)}catch{}return!o&&!r&&(n=n.replace(/(\r\n|\n|\r)/g,"")),n},Ue=(0,l.memo)(n=>{const{row:a,wrapLogMessage:o,prettifyLogMessage:r,showContextToggle:i,styles:p,onOpenContext:u,onPermalinkClick:v,onUnpinLine:A,onPinLine:M,pinLineButtonTooltipTitle:D,pinned:T,mouseIsOver:R,onBlur:d,getRowContextQuery:y,expanded:w,logRowMenuIconsBefore:g,logRowMenuIconsAfter:x}=n,{hasAnsi:C,raw:B}=a,W=(0,l.useMemo)(()=>fe(B,r,o,!!w),[B,r,o,w]),ee=R||T;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("td",{className:p.logsRowMessage,children:(0,e.jsx)("div",{className:o?p.positionRelative:p.horizontalScroll,children:(0,e.jsx)("div",{className:`${p.logLine} ${p.positionRelative}`,children:(0,e.jsx)(ge,{hasAnsi:C,entry:W,highlights:a.searchWords,styles:p})})})}),(0,e.jsx)("td",{className:`log-row-menu-cell ${p.logRowMenuCell}`,children:ee&&(0,e.jsx)(Ce,{logText:W,row:a,showContextToggle:i,getRowContextQuery:y,onOpenContext:u,onPermalinkClick:v,onPinLine:M,onUnpinLine:A,pinLineButtonTooltipTitle:D,pinned:T,styles:p,mouseIsOver:R,onBlur:d,addonBefore:g,addonAfter:x})})]})});Ue.displayName="LogRowMessage";const ze=(0,l.memo)(n=>{const{row:a,detectedFields:o,getFieldLinks:r,wrapLogMessage:i,styles:p,mouseIsOver:u,pinned:v,logRowMenuIconsBefore:A,logRowMenuIconsAfter:M,preview:D,...T}=n,R=i?"":Ye.noWrap,d=(0,l.useMemo)(()=>(0,Re.jE)(a,r),[r,a]),y=(0,l.useMemo)(()=>{let g="";for(let x=0;x<o.length;x++){const C=o[x];C===q.I&&(g+=` ${a.entry}`);const B=d.find(W=>W.keys[0]===C);B!=null&&(g+=` ${C}=${B.values}`),a.labels[C]!=null&&a.labels[C]!=null&&(g+=` ${C}=${a.labels[C]}`)}return g.trimStart()},[o,d,a.entry,a.labels]),w=u||v;return D?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("td",{children:(0,e.jsx)("div",{children:y})}),(0,e.jsx)("td",{})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("td",{className:p.logsRowMessage,children:(0,e.jsx)("div",{className:R,children:y})}),(0,e.jsx)("td",{className:`log-row-menu-cell ${p.logRowMenuCell}`,children:w&&(0,e.jsx)(Ce,{logText:y,row:a,styles:p,pinned:v,mouseIsOver:u,addonBefore:A,addonAfter:M,...T})})]})}),Ye={noWrap:(0,c.css)({whiteSpace:"nowrap"})};ze.displayName="LogRowMessageDisplayedFields";const Ve=({getRows:n,onClickFilterLabel:a,onClickFilterOutLabel:o,onClickShowField:r,onClickHideField:i,enableLogDetails:p,row:u,showDuplicates:v,showContextToggle:A,showLabels:M,showTime:D,displayedFields:T,wrapLogMessage:R,prettifyLogMessage:d,getFieldLinks:y,forceEscape:w,app:g,styles:x,getRowContextQuery:C,pinned:B,logRowMenuIconsBefore:W,logRowMenuIconsAfter:ee,timeZone:U,permalinkedRowId:le,scrollIntoView:G,handleTextSelection:he,onLogRowHover:ye,..._})=>{const[xe,Pe]=(0,l.useState)(!1),[P,we]=(0,l.useState)(!1),[se,ie]=(0,l.useState)(!1),[Me,Ae]=(0,l.useState)(!1),Ze=(0,l.useRef)(null),qe=(0,L.$j)(),K=(0,l.useMemo)(()=>(0,ce.LE)(u.timeEpochMs,{timeZone:U,defaultWithMS:!0}),[u.timeEpochMs,U]),De=(0,l.useMemo)(()=>(0,J.L)(qe,u.logLevel),[u.logLevel,qe]),me=(0,l.useMemo)(()=>u.hasUnescapedContent&&w?{...u,entry:(0,E.Hw)(u.entry),raw:(0,E.Hw)(u.raw)}:u,[w,u]),Xe=(0,E.Ei)(u),_e=Xe!==void 0,et=(0,E.qR)(u),tt=et!==void 0;(0,l.useEffect)(()=>{if(le!==u.uid){Ae(!1);return}if(!Me){Ae(!0);return}Ze.current&&G&&(G(Ze.current),(0,H.rR)("grafana_explore_logs_permalink_opened",{datasourceType:u.datasourceType??"unknown",logRowUid:u.uid}),Ae(!0))},[Me,le,u.datasourceType,u.uid,G]);const lt=(0,l.useCallback)((0,N.debounce)(()=>{Pe(!1)},3e3),[]),nt=(0,l.useCallback)(Je=>{Pe(!0),_.onOpenContext(Je,lt)},[lt,_]),it=(0,l.useCallback)(Je=>{he?.(Je,u)||p&&we(ct=>!ct)},[p,he,u]),at=(0,l.useCallback)(()=>{ie(!0),ye&&ye(u)},[ye,u]),rt=(0,l.useCallback)(Je=>{he&&document.getSelection()?.toString()&&Je.buttons>0&&ie(!1)},[he]),ot=(0,l.useCallback)(()=>{ie(!1)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("tr",{ref:Ze,className:`${x.logsRow} ${_e?x.errorLogRow:""} ${xe||Me||B?x.highlightBackground:""}`,onClick:it,onMouseEnter:at,onMouseLeave:ot,onMouseMove:rt,onFocus:at,children:[v&&(0,e.jsx)("td",{className:x.logsRowDuplicates,children:me.duplicates&&me.duplicates>0?`${me.duplicates+1}x`:null}),(0,e.jsxs)("td",{className:_e||tt?x.logsRowWithError:`${De.logsRowLevelColor} ${x.logsRowLevel}`,children:[_e&&(0,e.jsx)(ae.m,{content:`Error: ${Xe}`,placement:"right",theme:"error",children:(0,e.jsx)(F.I,{className:x.logIconError,name:"exclamation-triangle",size:"xs"})}),tt&&(0,e.jsx)(ae.m,{content:`${et}`,placement:"right",theme:"info",children:(0,e.jsx)(F.I,{className:x.logIconInfo,name:"info-circle",size:"xs"})})]}),(0,e.jsx)("td",{title:p?P?"Hide log details":"See log details":"",className:p?x.logsRowToggleDetails:"",children:p&&(0,e.jsx)("button",{"aria-label":(0,s.t)("logs.log-row-message.see-details","See log details"),className:x.detailsToggle,"aria-expanded":P,children:(0,e.jsx)(F.I,{className:x.topVerticalAlign,name:P?"angle-down":"angle-right"})})}),D&&(0,e.jsx)("td",{className:x.logsRowLocalTime,children:K}),M&&me.uniqueLabels&&(0,e.jsx)("td",{className:x.logsRowLabels,children:(0,e.jsx)(Be.h,{labels:me.uniqueLabels,addTooltip:!1})}),T&&T.length>0?(0,e.jsx)(ze,{row:me,showContextToggle:A,detectedFields:T,getFieldLinks:y,wrapLogMessage:R,onOpenContext:nt,onPermalinkClick:_.onPermalinkClick,styles:x,onPinLine:_.onPinLine,onUnpinLine:_.onUnpinLine,pinned:B,mouseIsOver:se,onBlur:ot,logRowMenuIconsBefore:W,logRowMenuIconsAfter:ee}):(0,e.jsx)(Ue,{row:me,showContextToggle:A,getRowContextQuery:C,wrapLogMessage:R,prettifyLogMessage:d,onOpenContext:nt,onPermalinkClick:_.onPermalinkClick,app:g,styles:x,onPinLine:_.onPinLine,onUnpinLine:_.onUnpinLine,pinLineButtonTooltipTitle:_.pinLineButtonTooltipTitle,pinned:B,mouseIsOver:se,onBlur:ot,expanded:P,logRowMenuIconsBefore:W,logRowMenuIconsAfter:ee})]}),P&&(0,e.jsx)(Ie,{onPinLine:_.onPinLine,className:`${x.logsRow} ${_e?x.errorLogRow:""} ${Me&&!P?x.highlightBackground:""}`,showDuplicates:v,getFieldLinks:y,onClickFilterLabel:a,onClickFilterOutLabel:o,onClickShowField:r,onClickHideField:i,getRows:n,row:me,wrapLogMessage:R,hasError:_e,displayedFields:T,app:g,styles:x,isFilterLabelActive:_.isFilterLabelActive,pinLineButtonTooltipTitle:_.pinLineButtonTooltipTitle})]})},Qe=()=>{},Ge=({row:n,showDuplicates:a,showLabels:o,showTime:r,displayedFields:i,...p})=>(0,e.jsxs)("tr",{children:[a&&(0,e.jsx)("td",{}),(0,e.jsx)("td",{}),(0,e.jsx)("td",{}),r&&(0,e.jsx)("td",{children:n.timeEpochMs}),o&&n.uniqueLabels&&(0,e.jsx)("td",{}),i&&i.length>0?(0,e.jsx)(ze,{...p,row:n,detectedFields:i,mouseIsOver:!1,onBlur:Qe,onOpenContext:Qe,preview:!0}):(0,e.jsx)("td",{className:p.styles.logsRowMessage,children:n.entry}),(0,e.jsx)("td",{className:`log-row-menu-cell ${p.styles.logRowMenuCell}`})]}),st=(0,l.memo)(({deduplicatedRows:n,logRows:a=[],dedupStrategy:o,logsSortOrder:r,previewLimit:i,pinnedLogs:p,onOpenContext:u,onClickFilterOutString:v,onClickFilterString:A,scrollElement:M,renderPreview:D=!1,enableLogDetails:T,permalinkedRowId:R,...d})=>{const[y,w]=(0,l.useState)(D&&!R?Math.max(2*Math.ceil(window.innerHeight/20),Math.ceil(a.length/3)):1/0),[g,x]=(0,l.useState)({selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}}),[C,B]=(0,l.useState)(!1),W=(0,l.useRef)(null),ee=(0,L.$j)(),U=(0,J.D)(ee),le=n||a,G=(0,l.useMemo)(()=>le.reduce((K,De)=>De.duplicates?K+De.duplicates:K,0),[le]),he=o!==b.fY.none&&G>0,ye=(0,l.useMemo)(()=>r?(0,E.oR)(le,r):le,[le,r]),_=(0,l.useMemo)(()=>()=>ye,[ye]),xe=(0,l.useRef)(null),Pe=new O;(0,l.useEffect)(()=>()=>{xe.current&&(document.removeEventListener("click",xe.current),document.removeEventListener("contextmenu",xe.current))},[]),(0,l.useEffect)(()=>{if(!M)return;function K(){w(1/0),M?.removeEventListener("scroll",K),M?.removeEventListener("wheel",K)}M.addEventListener("scroll",K),M.addEventListener("wheel",K)},[a.length,M]);const P=(0,l.useCallback)((K,De)=>{u&&u(K,De)},[u]),we=(0,l.useCallback)(()=>!re.$.featureToggles.logRowsPopoverMenu||(0,E.Vu)()?!1:!!(v||A),[v,A]),se=(0,l.useCallback)(()=>{xe.current&&(document.removeEventListener("click",xe.current),document.removeEventListener("contextmenu",xe.current),xe.current=null),x({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},[]),ie=(0,l.useCallback)(K=>{if((0,E.a8)(K.target)&&!W.current?.contains(K.target)){se();return}document.getSelection()?.toString()||se()},[se]),Me=(0,l.useCallback)((K,De)=>{const me=document.getSelection()?.toString();if(!me)return!1;if(K.altKey&&(0,E.Ck)(),we()===!1)return!!me;if(!W.current)return!1;const Xe=270,_e=105,et=K.clientX+Xe>window.innerWidth?window.innerWidth-Xe:K.clientX,tt=K.clientY+_e>window.innerHeight?window.innerHeight-_e:K.clientY;return x({selection:me,popoverMenuCoordinates:{x:et,y:tt},selectedRow:De}),xe.current=ie,document.addEventListener("click",ie),document.addEventListener("contextmenu",ie),!0},[ie,we]),Ae=(0,l.useCallback)(()=>{B(!0)},[]),Ze=(0,l.useCallback)(()=>{B(!1)},[]),qe=(0,l.useCallback)(()=>{(0,E.PO)(),B(!1)},[]);return(0,e.jsxs)("div",{className:U.logRows,ref:W,children:[g.selection&&g.selectedRow&&(0,e.jsx)(Y,{close:se,row:g.selectedRow,selection:g.selection,...g.popoverMenuCoordinates,onClickFilterString:A,onClickFilterOutString:v,onDisable:Ae}),C&&(0,e.jsx)($.u,{isOpen:!0,title:(0,s.t)("logs.log-rows.disable-popover.title","Disable menu"),body:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.x6,{i18nKey:"logs.log-rows.disable-popover.message",children:"You are about to disable the logs filter menu. To re-enable it, select text in a log line while holding the alt key."}),(0,e.jsxs)("div",{className:U.shortcut,children:[(0,e.jsx)(F.I,{name:"keyboard"}),(0,e.jsx)(s.x6,{i18nKey:"logs.log-rows.disable-popover-message.shortcut",children:"alt+select to enable again"})]})]}),confirmText:(0,s.t)("logs.log-rows.disable-popover.confirm","Confirm"),icon:"exclamation-triangle",onConfirm:qe,onDismiss:Ze}),(0,e.jsx)("table",{className:(0,c.cx)(U.logsRowsTable,d.overflowingContent?"":U.logsRowsTableContain),children:(0,e.jsx)("tbody",{children:ye.map((K,De)=>De<y?(0,e.jsx)(Ve,{getRows:_,row:K,showDuplicates:he,logsSortOrder:r,onOpenContext:P,styles:U,onPermalinkClick:d.onPermalinkClick,scrollIntoView:d.scrollIntoView,permalinkedRowId:R,onPinLine:d.onPinLine,onUnpinLine:d.onUnpinLine,pinLineButtonTooltipTitle:d.pinLineButtonTooltipTitle,pinned:p?.some(me=>me===K.rowId||me===K.uid),isFilterLabelActive:d.isFilterLabelActive,handleTextSelection:Me,enableLogDetails:T,...d},Pe.getKey(K.uid)):(0,e.jsx)(Ge,{enableLogDetails:!1,getRows:_,onOpenContext:P,styles:U,showDuplicates:he,...d,row:K},`preview_${Pe.getKey(K.uid)}`))})})]})})},21429:(Ne,ne,t)=>{t.d(ne,{D:()=>F,L:()=>$});var e=t(22803),c=t(41811),l=t(84140),b=t(67770),re=t(6773),L=t(35484);const $=(s,H)=>{let S=s.isLight?s.v1.palette.gray5:s.v1.palette.gray2;switch(H){case b.$b.crit:case b.$b.critical:S="#705da0";break;case b.$b.error:case b.$b.err:S="#e24d42";break;case b.$b.warning:case b.$b.warn:S=s.colors.warning.main;break;case b.$b.info:S="#7eb26d";break;case b.$b.debug:S="#1f78c1";break;case b.$b.trace:S="#6ed0e0";break}return{logsRowLevelColor:(0,e.css)({"&::after":{backgroundColor:S}})}},F=(0,c.default)(s=>{const H=L.hoverColor(s.colors.background.secondary,s),S=(0,l.A)(s.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,e.css)({label:"logs-row__level",maxWidth:s.spacing(1.25),cursor:"default","&::after":{content:"''",display:"block",position:"absolute",top:"1px",bottom:"1px",width:"3px",left:s.spacing(.5)}}),logsRowWithError:(0,e.css)({maxWidth:`${s.spacing(1.5)}`}),logsRowMatchHighLight:(0,e.css)({label:"logs-row__match-highlight",background:"inherit",padding:"inherit",color:s.components.textHighlight.text,backgroundColor:s.components.textHighlight.background}),logRows:(0,e.css)({position:"relative"}),shortcut:(0,e.css)({display:"inline-flex",alignItems:"center",gap:s.spacing(1),color:s.colors.text.secondary,opacity:.7,fontSize:s.typography.bodySmall.fontSize,marginTop:s.spacing(1)}),logsRowsTable:(0,e.css)({label:"logs-rows",fontFamily:s.typography.fontFamilyMonospace,fontSize:s.typography.bodySmall.fontSize,width:"100%",position:"relative"}),logsRowsTableContain:(0,e.css)({contain:"strict"}),highlightBackground:(0,e.css)({backgroundColor:(0,l.A)(s.colors.info.transparent).setAlpha(.25).toString()}),logsRow:(0,e.css)({label:"logs-row",width:"100%",cursor:"pointer",verticalAlign:"top","&:focus-within":{outline:`2px solid ${s.colors.primary.border}`,outlineOffset:"-2px"},"&:hover":{".log-row-menu":{zIndex:1},background:H},"td:not(.log-row-menu-cell):last-child":{width:"100%"},"> td:not(.log-row-menu-cell)":{position:"relative",paddingRight:s.spacing(1),borderTop:"1px solid transparent",borderBottom:"1px solid transparent",height:"100%"}}),logsRowDuplicates:(0,e.css)({label:"logs-row__duplicates",textAlign:"right",width:"4em",cursor:"default"}),logIconError:(0,e.css)({color:s.colors.warning.main,position:"relative",top:"-2px"}),logIconInfo:(0,e.css)({color:s.colors.info.main,position:"relative",top:"-2px"}),logsRowToggleDetails:(0,e.css)({label:"logs-row-toggle-details__level",fontSize:"9px",maxWidth:"15px"}),logsRowLocalTime:(0,e.css)({label:"logs-row__localtime",whiteSpace:"nowrap"}),logsRowLabels:(0,e.css)({label:"logs-row__labels",whiteSpace:"nowrap",maxWidth:"22em","> span":{marginTop:"0.75px"}}),logsRowMessage:(0,e.css)({label:"logs-row__message",whiteSpace:"pre-wrap",wordBreak:"break-all",overflowWrap:"anywhere",width:"100%",textAlign:"left"}),copyLogButton:(0,e.css)({padding:s.spacing(0,0,0,.5),height:s.spacing(3),width:s.spacing(3.25),lineHeight:s.spacing(2.5),overflow:"hidden","&:hover":{backgroundColor:re.MV.alpha(s.colors.text.primary,.12)}}),logDetailsContainer:(0,e.css)({label:"logs-row-details-table",border:`1px solid ${s.colors.border.medium}`,padding:s.spacing(0,1,1),borderRadius:s.shape.radius.default,margin:s.spacing(2.5,1,2.5,2),cursor:"default"}),logDetailsTable:(0,e.css)({label:"logs-row-details-table",lineHeight:"18px",width:"100%","td:last-child":{width:"100%"}}),logsDetailsIcon:(0,e.css)({label:"logs-row-details__icon",position:"relative",color:s.v1.palette.gray3,paddingTop:"1px",paddingBottom:"1px",paddingRight:s.spacing(.75)}),logDetailsLabel:(0,e.css)({label:"logs-row-details__label",maxWidth:"30em",minMidth:"20em",padding:s.spacing(0,1),overflowWrap:"break-word"}),logDetailsHeading:(0,e.css)({label:"logs-row-details__heading",fontWeight:s.typography.fontWeightBold,padding:s.spacing(1,0,.5)}),logDetailsValue:(0,e.css)({label:"logs-row-details__row",position:"relative",verticalAlign:"middle",cursor:"default","&:hover":{backgroundColor:H}}),detailsToggle:(0,e.css)({appearance:"none",background:"none",border:"none",padding:0,maxHeight:"19px","&:focus-visible":{boxShadow:"none"},"&:focus":{outline:0},"&:after":{content:'""',inset:0,position:"absolute"}}),topVerticalAlign:(0,e.css)({label:"topVerticalAlign",marginTop:s.spacing(-.9),marginLeft:s.spacing(-.25)}),detailsOpen:(0,e.css)({"&:hover":{backgroundColor:L.hoverColor(s.colors.background.primary,s)}}),errorLogRow:(0,e.css)({label:"erroredLogRow",color:s.colors.text.secondary}),positionRelative:(0,e.css)({label:"positionRelative",position:"relative"}),rowWithContext:(0,e.css)({label:"rowWithContext",zIndex:1,outline:`9999px solid ${S}`,display:"inherit"}),horizontalScroll:(0,e.css)({label:"horizontalScroll",whiteSpace:"pre"}),contextNewline:(0,e.css)({display:"block",marginLeft:"0px"}),rowMenu:(0,e.css)({label:"rowMenu",display:"flex",flexWrap:"nowrap",flexDirection:"row",alignContent:"flex-end",justifyContent:"space-evenly",alignItems:"center",position:"absolute",top:0,bottom:"auto",background:s.colors.background.primary,boxShadow:s.shadows.z3,padding:s.spacing(.5,1,.5,1),zIndex:100,gap:s.spacing(.5),"& > button":{margin:0}}),logRowMenuCell:(0,e.css)({position:"sticky",zIndex:s.zIndex.dropdown,marginTop:s.spacing(-.125),right:0,"& > span":{transform:"translateX(-100%)"}}),logLine:(0,e.css)({fontFamily:s.typography.fontFamilyMonospace,fontSize:s.typography.bodySmall.fontSize,letterSpacing:s.typography.bodySmall.letterSpacing,textAlign:"left",padding:0,userSelect:"text"}),logsRowLevelDetails:(0,e.css)({label:"logs-row__level_details","&::after":{top:"-3px"}}),logDetails:(0,e.css)({label:"logDetailsDefaultCursor",cursor:"default","&:hover":{backgroundColor:s.colors.background.primary}}),visibleRowMenu:(0,e.css)({label:"visibleRowMenu",aspectRatio:"1/1",zIndex:90}),linkButton:(0,e.css)({label:"linkButton","> button":{paddingTop:s.spacing(.5)}}),hidden:(0,e.css)({label:"hidden",visibility:"hidden"}),unPinButton:(0,e.css)({height:s.spacing(3),lineHeight:s.spacing(2.5)})}})},27789:(Ne,ne,t)=>{t.d(ne,{V:()=>Q});var e=t(74848),c=t(22803),l=t(2543),b=t(96540),re=t(16817),L=t(28105),$=t(739),F=t(67770),s=t(25229),H=t(27489),S=t(43173),E=t(63142),Y=t(22787),z=t(45861),m=t(56840),O=t(29043),N=t(70159),ce=t(35231),ae=t(96673),Te=t(37234),q=t(74746),oe=t(82212),ve=t(20444),je=t(21285);function Z(h){return{buttons:(0,c.css)({display:"flex",gap:h.spacing(1)})}}const f=h=>{const J=(0,E.of)(Z),{wrapLines:de,onChangeWrapLines:ue,onScrollCenterClick:ke}=h,Le=(0,b.useCallback)(pe=>{const Re=pe.currentTarget.checked;(0,H.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:Re}),ue(Re)},[ue]);return(0,e.jsxs)("div",{className:J.buttons,children:[(0,e.jsx)(je.K,{showLabel:!0,value:de,onChange:Le,label:(0,m.t)("logs.log-context-buttons.label-wrap-lines","Wrap lines")}),(0,e.jsx)(z.$n,{variant:"secondary",onClick:ke,children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-context-buttons.center-matched-line",children:"Center matched line"})})]})},j=h=>({modal:(0,c.css)({width:"85vw",[h.breakpoints.down("md")]:{width:"100%"},top:"50%",left:"50%",transform:"translate(-50%, -50%)"}),sticky:(0,c.css)({position:"sticky",zIndex:1,top:"-1px",bottom:"-1px"}),entry:(0,c.css)({"& > td":{padding:h.spacing(1,0,1,0)},background:h.colors.emphasize(h.colors.background.secondary),"& > table":{marginBottom:0},"& .log-row-menu":{marginTop:"-6px"}}),datasourceUi:(0,c.css)({paddingBottom:h.spacing(1.25),display:"flex",alignItems:"center"}),logRowGroups:(0,c.css)({overflow:"auto",maxHeight:"75%",alignSelf:"stretch",display:"inline-block",border:`1px solid ${h.colors.border.weak}`,borderRadius:h.shape.radius.default,"& > table":{minWidth:"100%"}}),flexColumn:(0,c.css)({display:"flex",flexDirection:"column",padding:h.spacing(0,3,3,3)}),flexRow:(0,c.css)({display:"flex",flexDirection:"row",alignItems:"center","& > div:last-child":{marginLeft:"auto"}}),noMarginBottom:(0,c.css)({"& > table":{marginBottom:0}}),hidden:(0,c.css)({display:"none"}),paddingTop:(0,c.css)({paddingTop:h.spacing(1)}),paddingBottom:(0,c.css)({paddingBottom:h.spacing(1)}),link:(0,c.css)({color:h.colors.text.secondary,fontSize:h.typography.bodySmall.fontSize,":hover":{color:h.colors.text.link}}),loadingCell:(0,c.css)({position:"sticky",left:"50%",display:"inline-block",transform:"translateX(-50%)"})}),I=()=>({above:{loadingState:L.Gu.NotStarted,rows:[]},below:{loadingState:L.Gu.NotStarted,rows:[]}}),k=(h,J)=>h==="above"&&J===$.uH.Descending||h==="below"&&J===$.uH.Ascending?F.ZF.Forward:F.ZF.Backward,te=(h,J)=>({...h,dataFrame:{...h.dataFrame,refId:`context_${J.above}_${J.below}`}}),X=(h,J)=>h.some(de=>de.entry===J.entry&&de.timeEpochNs===J.timeEpochNs),V=100,Q=({row:h,open:J,logsSortOrder:de,timeZone:ue,getLogRowContextUi:ke,getRowContextQuery:Le,onClose:pe,getRowContext:Re})=>{const Se=(0,b.useRef)(null),Ie=(0,b.useRef)(null),Be=(0,b.useRef)(null),Fe=(0,b.useRef)(null),Oe=(0,b.useRef)(null),We=(0,b.useRef)(null),Ke=(0,b.useRef)(null),Ce=(0,b.useRef)({above:0,below:0}),$e=(0,ae.useDispatch)(),Ee=(0,E.$j)(),ge=j(Ee),[He,be]=(0,b.useState)(!0),[fe,Ue]=(0,b.useState)(I()),ze=(d,y)=>{Ue(w=>{const g={...w};return g[d]=y(w[d]),g})},Ye=(0,b.useRef)(1),[Ve,Qe]=(0,b.useState)(null),[Ge,st]=(0,b.useState)(O.A.getBool(N.$Z.logContextWrapLogMessage,O.A.getBool(N.$Z.wrapLogMessage,!0))),n=(0,b.useCallback)(()=>{const{below:d,above:y}=fe,w=(0,q.oR)([...d.rows,h,...y.rows],$.uH.Ascending),g=w[0].timeEpochMs;let x=w[w.length-1].timeEpochMs;g===x&&(x+=1);const C=(0,s.KQ)(g),B=(0,s.KQ)(x);return{from:C,to:B,raw:{from:C,to:B}}},[fe,h]),a=(0,b.useCallback)(async()=>{const d=Le?await Le(h):null;Qe(d)},[h,Le]),o=async()=>{await a(),Ue(I()),Ce.current={above:0,below:0},Ye.current+=1},r=async(d,y)=>{Ce.current[d]+=1;const w=y.at(d==="above"?0:-1);if(w==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,H.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:w.datasourceType,above:Ce.current.above,below:Ce.current.below});const g=k(d,de),x=await Re(te(w,Ce.current),{limit:V,direction:g}),C=(0,Te.HT)(x.data).rows;return de===$.uH.Ascending&&C.reverse(),C.filter(W=>!X(y,W))};(0,b.useEffect)(()=>{J&&a()},[a,J]);const[i,p]=(0,b.useState)([]),u=d=>{i.indexOf(d)===-1&&p([...i,d])},v=d=>{const y=i.indexOf(d);y>-1&&(i.splice(y,1),p([...i]))},A=async d=>{const{below:y,above:w}=fe;if(fe[d].loadingState===L.Gu.Loading)return;ze(d,C=>({...C,loadingState:L.Gu.Loading}));const x=Ye.current;try{const C=[...w.rows,h,...y.rows],B=(await r(d,C)).map(G=>!G.searchWords||!G.searchWords?.length?{...G,searchWords:h.searchWords}:G),[W,ee]=(0,l.partition)(B,G=>G.timeEpochNs>h.timeEpochNs),U=de===$.uH.Ascending?ee:W,le=de===$.uH.Ascending?W:ee;x===Ye.current&&Ue(G=>{const he=U.length>0?(0,q.oR)([...U,...G.above.rows],de):G.above.rows,ye=le.length>0?(0,q.oR)([...G.below.rows,...le],de):G.below.rows;return{above:{rows:he,loadingState:d==="above"?B.length===0?L.Gu.Done:L.Gu.NotStarted:G.above.loadingState},below:{rows:ye,loadingState:d==="below"?B.length===0?L.Gu.Done:L.Gu.NotStarted:G.below.loadingState}}})}catch{ze(d,C=>({rows:C.rows,loadingState:L.Gu.Error}))}},M=async(d,y)=>{for(const w of d){if(!w.isIntersecting)continue;const g=w.target;g===We.current?A("above"):g===Ke.current&&A("below")}};(0,b.useEffect)(()=>{const d=Se.current,y=We.current,w=Ke.current;if(d==null)return;const g=new IntersectionObserver(M,{root:d});return y!=null&&g.observe(y),w!=null&&g.observe(w),()=>{g.disconnect()}});const D=(0,b.useCallback)(()=>{Be.current?.scrollIntoView({block:"center"}),Ie.current?.scrollIntoView({block:"center"})},[Be,Ie]);(0,b.useLayoutEffect)(()=>{const d=Se.current;if(d==null)return;const y=Oe.current,w=d.clientHeight;if(Oe.current=w,y!==w){D();return}if(Ce.current.above<=1&&Ce.current.below<=1){D();return}const g=Fe.current,x=d.scrollHeight;if(Fe.current=x,g!=null){const C=d.scrollTop+(x-g);d.scrollTop=C}},[fe.above.rows,D]),(0,re.A)(a,[Le,h]);const T=fe.above.loadingState,R=fe.below.loadingState;return(0,e.jsxs)(Y.a,{isOpen:J,title:(0,m.t)("logs.log-row-context-modal.title-log-context","Log context"),contentClassName:ge.flexColumn,className:ge.modal,onDismiss:pe,children:[S.$.featureToggles.logsContextDatasourceUi&&ke&&(0,e.jsx)("div",{className:ge.datasourceUi,children:ke(h,o)}),(0,e.jsx)("div",{className:(0,c.cx)(ge.flexRow,ge.paddingBottom),children:(0,e.jsx)("div",{children:(0,e.jsx)(f,{wrapLines:Ge,onChangeWrapLines:st,onScrollCenterClick:D})})}),(0,e.jsx)("div",{ref:Se,className:ge.logRowGroups,children:(0,e.jsx)("table",{children:(0,e.jsxs)("tbody",{children:[(0,e.jsx)("tr",{children:(0,e.jsxs)("td",{className:ge.loadingCell,children:[T!==L.Gu.Done&&T!==L.Gu.Error&&(0,e.jsx)("div",{ref:We,children:(0,e.jsx)(oe.I,{adjective:"newer"})}),T===L.Gu.Error&&(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-row-context-modal.error-loading-log-more-logs",children:"Error loading more logs."})}),T===L.Gu.Done&&(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-row-context-modal.no-more-logs-available",children:"No more logs available."})})]})}),(0,e.jsx)("tr",{children:(0,e.jsx)("td",{className:ge.noMarginBottom,children:(0,e.jsx)(ve.k,{logRows:fe.above.rows,dedupStrategy:$.fY.none,showLabels:O.A.getBool(N.$Z.showLabels,!1),showTime:O.A.getBool(N.$Z.showTime,!0),wrapLogMessage:Ge,prettifyLogMessage:O.A.getBool(N.$Z.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:ue,displayedFields:i,onClickShowField:u,onClickHideField:v,scrollElement:null})})}),(0,e.jsx)("tr",{ref:Be}),(0,e.jsx)("tr",{ref:Ie,className:(0,c.cx)(ge.entry,He?ge.sticky:null),"data-testid":"entry-row",children:(0,e.jsx)("td",{className:ge.noMarginBottom,children:(0,e.jsx)(ve.k,{logRows:[h],dedupStrategy:$.fY.none,showLabels:O.A.getBool(N.$Z.showLabels,!1),showTime:O.A.getBool(N.$Z.showTime,!0),wrapLogMessage:Ge,prettifyLogMessage:O.A.getBool(N.$Z.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:ue,displayedFields:i,onClickShowField:u,onClickHideField:v,onUnpinLine:()=>be(!1),onPinLine:()=>be(!0),pinnedLogs:He?[h.uid]:void 0,overflowingContent:!0,scrollElement:null})})}),(0,e.jsx)("tr",{children:(0,e.jsx)("td",{children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ve.k,{logRows:fe.below.rows,dedupStrategy:$.fY.none,showLabels:O.A.getBool(N.$Z.showLabels,!1),showTime:O.A.getBool(N.$Z.showTime,!0),wrapLogMessage:Ge,prettifyLogMessage:O.A.getBool(N.$Z.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:ue,displayedFields:i,onClickShowField:u,onClickHideField:v,scrollElement:null})})})}),(0,e.jsx)("tr",{children:(0,e.jsxs)("td",{className:ge.loadingCell,children:[R!==L.Gu.Done&&R!==L.Gu.Error&&(0,e.jsx)("div",{ref:Ke,children:(0,e.jsx)(oe.I,{adjective:"older"})}),R===L.Gu.Error&&(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-row-context-modal.error-loading-log-more-logs",children:"Error loading more logs."})}),R===L.Gu.Done&&(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-row-context-modal.no-more-logs-available",children:"No more logs available."})})]})})]})})}),(0,e.jsx)(Y.a.ButtonRow,{children:Ve?.datasource?.uid&&(0,e.jsx)(z.$n,{variant:"secondary",onClick:async()=>{let d=h.uid;h.dataFrame.refId&&(d=h.uid.replace(h.dataFrame.refId,Ve.refId)),$e((0,ce.ve)({queries:[Ve],range:n(),datasourceUid:Ve.datasource.uid,panelsState:{logs:{id:d}}})),pe(),(0,H.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:h.datasourceType,logRowUid:h.uid})},children:(0,e.jsx)(m.x6,{i18nKey:"logs.log-row-context-modal.open-in-split-view",children:"Open in split view"})})})]})}}}]);

//# sourceMappingURL=7112.cac05a202f8d15a81604.js.map