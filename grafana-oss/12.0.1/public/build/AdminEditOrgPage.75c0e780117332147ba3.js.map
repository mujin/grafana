{"version":3,"file":"AdminEditOrgPage.75c0e780117332147ba3.js","mappings":"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","sources":["webpack://grafana/./public/app/core/components/RolePicker/UserRolePicker.tsx","webpack://grafana/./public/app/core/components/RolePickerDrawer/RolePickerDrawer.tsx","webpack://grafana/./public/app/features/admin/api.ts","webpack://grafana/./public/app/features/admin/AdminEditOrgPage.tsx","webpack://grafana/./public/app/features/admin/OrgRolePicker.tsx","webpack://grafana/./public/app/core/components/RolePickerDrawer/RolePickerBadges.tsx","webpack://grafana/./public/app/features/admin/Users/OrgUsersTable.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { useAsyncFn } from 'react-use';\n\nimport { contextSrv } from 'app/core/core';\nimport { Role, OrgRole, AccessControlAction } from 'app/types';\n\nimport { RolePicker } from './RolePicker';\nimport { fetchUserRoles, updateUserRoles } from './api';\n\nexport interface Props {\n  basicRole: OrgRole;\n  roles?: Role[];\n  userId: number;\n  orgId?: number;\n  onBasicRoleChange: (newRole: OrgRole) => void;\n  roleOptions: Role[];\n  disabled?: boolean;\n  basicRoleDisabled?: boolean;\n  basicRoleDisabledMessage?: string;\n  /**\n   * Set whether the component should send a request with the new roles to the\n   * backend in UserRolePicker.onRolesChange (apply=false), or call {@link onApplyRoles}\n   * with the updated list of roles (apply=true).\n   *\n   * Besides it sets the RolePickerMenu's Button title to\n   *   * `Update` in case apply equals false\n   *   * `Apply` in case apply equals true\n   *\n   * @default false\n   */\n  apply?: boolean;\n  onApplyRoles?: (newRoles: Role[], userId: number, orgId: number | undefined) => void;\n  pendingRoles?: Role[];\n  maxWidth?: string | number;\n  width?: string | number;\n  isLoading?: boolean;\n}\n\nexport const UserRolePicker = ({\n  basicRole,\n  roles,\n  userId,\n  orgId,\n  onBasicRoleChange,\n  roleOptions,\n  disabled,\n  basicRoleDisabled,\n  basicRoleDisabledMessage,\n  apply = false,\n  onApplyRoles,\n  pendingRoles,\n  maxWidth,\n  width,\n  isLoading,\n}: Props) => {\n  const [{ loading, value: appliedRoles = roles || [] }, getUserRoles] = useAsyncFn(async () => {\n    try {\n      if (roles) {\n        return roles;\n      }\n      if (apply && Boolean(pendingRoles?.length)) {\n        return pendingRoles;\n      }\n\n      if (contextSrv.hasPermission(AccessControlAction.ActionUserRolesList) && userId > 0) {\n        return await fetchUserRoles(userId, orgId);\n      }\n    } catch (e) {\n      // TODO handle error\n      console.error('Error loading options');\n    }\n    return [];\n  }, [orgId, userId, pendingRoles, roles]);\n\n  useEffect(() => {\n    // only load roles when there is an Org selected\n    if (orgId) {\n      getUserRoles();\n    }\n  }, [getUserRoles, orgId]);\n\n  const onRolesChange = async (roles: Role[]) => {\n    if (!apply) {\n      await updateUserRoles(roles, userId, orgId);\n      await getUserRoles();\n    } else if (onApplyRoles) {\n      onApplyRoles(roles, userId, orgId);\n    }\n  };\n\n  const canUpdateRoles =\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesAdd) &&\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesRemove);\n\n  return (\n    <RolePicker\n      appliedRoles={appliedRoles}\n      basicRole={basicRole}\n      onRolesChange={onRolesChange}\n      onBasicRoleChange={onBasicRoleChange}\n      roleOptions={roleOptions}\n      isLoading={loading || isLoading}\n      disabled={disabled}\n      basicRoleDisabled={basicRoleDisabled}\n      basicRoleDisabledMessage={basicRoleDisabledMessage}\n      showBasicRole\n      apply={apply}\n      canUpdateRoles={canUpdateRoles}\n      maxWidth={maxWidth}\n      width={width}\n    />\n  );\n};\n","import { Controller, useFormContext } from 'react-hook-form';\n\nimport { toOption } from '@grafana/data';\nimport { Drawer, Field, RadioButtonGroup, TextLink } from '@grafana/ui';\nimport { t, Trans } from 'app/core/internationalization';\nimport { OrgRole } from 'app/types';\n\nconst roleOptions = Object.keys(OrgRole).map(toOption);\n\nconst drawerSubtitle = (\n  <Trans i18nKey=\"role-picker.title.description\">\n    Assign roles to users to ensure granular control over access to Grafana&lsquo;s features and resources. Find out\n    more in our{' '}\n    <TextLink\n      external\n      href=\"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles\"\n    >\n      documentation\n    </TextLink>\n    .\n  </Trans>\n);\n\nexport interface Props {\n  onClose: () => void;\n}\n\nexport const RolePickerDrawer = ({ onClose }: Props) => {\n  const methods = useFormContext();\n  const { control, getValues, setValue } = methods;\n  const [name, roles] = getValues(['name', 'roles']);\n  return (\n    <Drawer title={name} subtitle={drawerSubtitle} onClose={onClose}>\n      <Field label={t('role-picker-drawer.basic-roles.label', 'Basic Roles')}>\n        <Controller\n          name=\"role\"\n          control={control}\n          render={({ field: { onChange, ref, ...fields } }) => (\n            <RadioButtonGroup\n              {...fields}\n              options={roleOptions}\n              onChange={(v) => {\n                setValue('roleCollection', [v, ...roles]);\n                onChange(v);\n              }}\n            />\n          )}\n        />\n      </Field>\n    </Drawer>\n  );\n};\n","import { UrlQueryValue } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { contextSrv } from 'app/core/core';\nimport { accessControlQueryParam } from 'app/core/utils/accessControl';\nimport { OrgUser, AccessControlAction } from 'app/types';\n\nconst perPage = 30;\n\nexport const getOrg = async (orgId: UrlQueryValue) => {\n  return await getBackendSrv().get(`/api/orgs/${orgId}`);\n};\n\nexport const getOrgUsers = async (orgId: UrlQueryValue, page: number) => {\n  if (contextSrv.hasPermission(AccessControlAction.OrgUsersRead)) {\n    return getBackendSrv().get(`/api/orgs/${orgId}/users/search`, accessControlQueryParam({ perpage: perPage, page }));\n  }\n  return { orgUsers: [] };\n};\n\nexport const getUsersRoles = async (orgId: number, users: OrgUser[]) => {\n  const userIds = users.map((u) => u.userId);\n  const roles = await getBackendSrv().post(`/api/access-control/users/roles/search?includeMapped=true`, {\n    userIds,\n    orgId,\n  });\n  users.forEach((u) => {\n    u.roles = roles ? roles[u.userId] || [] : [];\n  });\n};\n\nexport const updateOrgUserRole = (orgUser: OrgUser, orgId: UrlQueryValue) => {\n  return getBackendSrv().patch(`/api/orgs/${orgId}/users/${orgUser.userId}`, orgUser);\n};\n\nexport const removeOrgUser = (orgUser: OrgUser, orgId: UrlQueryValue) => {\n  return getBackendSrv().delete(`/api/orgs/${orgId}/users/${orgUser.userId}`);\n};\n\nexport const updateOrgName = (name: string, orgId: number) => {\n  return getBackendSrv().put(`/api/orgs/${orgId}`, { name });\n};\n","import { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useParams } from 'react-router-dom-v5-compat';\nimport { useAsyncFn } from 'react-use';\n\nimport { NavModelItem } from '@grafana/data';\nimport { Field, Input, Button, Legend, Alert } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/core';\nimport { Trans, t } from 'app/core/internationalization';\nimport { OrgUser, AccessControlAction, OrgRole } from 'app/types';\n\nimport { OrgUsersTable } from './Users/OrgUsersTable';\nimport { getOrg, getOrgUsers, getUsersRoles, removeOrgUser, updateOrgName, updateOrgUserRole } from './api';\n\ninterface OrgNameDTO {\n  orgName: string;\n}\n\nconst AdminEditOrgPage = () => {\n  const { id = '' } = useParams();\n  const orgId = parseInt(id, 10);\n  const canWriteOrg = contextSrv.hasPermission(AccessControlAction.OrgsWrite);\n  const canReadUsers = contextSrv.hasPermission(AccessControlAction.OrgUsersRead);\n\n  const [users, setUsers] = useState<OrgUser[]>([]);\n  const [page, setPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n\n  const [orgState, fetchOrg] = useAsyncFn(() => getOrg(orgId), []);\n  const {\n    handleSubmit,\n    register,\n    formState: { errors },\n  } = useForm<OrgNameDTO>();\n  const [, fetchOrgUsers] = useAsyncFn(async (page) => {\n    const result = await getOrgUsers(orgId, page);\n\n    if (contextSrv.licensedAccessControlEnabled()) {\n      await getUsersRoles(orgId, result.orgUsers);\n    }\n\n    const totalPages = result?.perPage !== 0 ? Math.ceil(result.totalCount / result.perPage) : 0;\n    setTotalPages(totalPages);\n    setUsers(result.orgUsers);\n    return result.orgUsers;\n  }, []);\n\n  useEffect(() => {\n    fetchOrg();\n    fetchOrgUsers(page);\n  }, [fetchOrg, fetchOrgUsers, page]);\n\n  const onUpdateOrgName = async ({ orgName }: OrgNameDTO) => {\n    await updateOrgName(orgName, orgId);\n  };\n\n  const renderMissingPermissionMessage = () => (\n    <Alert\n      severity=\"info\"\n      title={t('admin.admin-edit-org-page.render-missing-permission-message.title-access-denied', 'Access denied')}\n    >\n      <Trans i18nKey=\"admin.edit-org.access-denied\">\n        You do not have permission to see users in this organization. To update this organization, contact your server\n        administrator.\n      </Trans>\n    </Alert>\n  );\n\n  const onPageChange = (toPage: number) => {\n    setPage(toPage);\n  };\n\n  const onRemoveUser = async (orgUser: OrgUser) => {\n    await removeOrgUser(orgUser, orgId);\n    fetchOrgUsers(page);\n  };\n\n  const onRoleChange = async (role: OrgRole, orgUser: OrgUser) => {\n    await updateOrgUserRole({ ...orgUser, role }, orgId);\n    fetchOrgUsers(page);\n  };\n\n  const pageNav: NavModelItem = {\n    text: orgState?.value?.name ?? '',\n    icon: 'shield',\n    subTitle: 'Manage settings and user roles for an organization.',\n  };\n\n  return (\n    <Page navId=\"global-orgs\" pageNav={pageNav} subTitle=\"Manage settings for this specific org.\">\n      <Page.Contents>\n        <>\n          <Legend>\n            <Trans i18nKey=\"admin.edit-org.heading\">Edit Organization</Trans>\n          </Legend>\n          {orgState.value && (\n            <form onSubmit={handleSubmit(onUpdateOrgName)} style={{ maxWidth: '600px' }}>\n              <Field\n                label={t('admin.admin-edit-org-page.label-name', 'Name')}\n                invalid={!!errors.orgName}\n                error=\"Name is required\"\n                disabled={!canWriteOrg}\n              >\n                <Input\n                  {...register('orgName', { required: true })}\n                  id=\"org-name-input\"\n                  defaultValue={orgState.value.name}\n                />\n              </Field>\n              <Button type=\"submit\" disabled={!canWriteOrg}>\n                <Trans i18nKey=\"admin.edit-org.update-button\">Update</Trans>\n              </Button>\n            </form>\n          )}\n\n          <div style={{ marginTop: '20px' }}>\n            <Legend>\n              <Trans i18nKey=\"admin.edit-org.users-heading\">Organization users</Trans>\n            </Legend>\n            {!canReadUsers && renderMissingPermissionMessage()}\n            {canReadUsers && !!users.length && (\n              <OrgUsersTable\n                users={users}\n                orgId={orgId}\n                onRoleChange={onRoleChange}\n                onRemoveUser={onRemoveUser}\n                changePage={onPageChange}\n                page={page}\n                totalPages={totalPages}\n              />\n            )}\n          </div>\n        </>\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default AdminEditOrgPage;\n","import { OrgRole } from '@grafana/data';\nimport { Select } from '@grafana/ui';\nimport { t } from 'app/core/internationalization';\n\ninterface Props {\n  value: OrgRole;\n  disabled?: boolean;\n  'aria-label'?: string;\n  inputId?: string;\n  onChange: (role: OrgRole) => void;\n  autoFocus?: boolean;\n  width?: number | 'auto';\n}\n\nconst basicRoles = Object.values(OrgRole).filter((r) => r !== OrgRole.None);\nconst options = basicRoles.map((r) => ({ label: r, value: r }));\n\nexport function OrgRolePicker({ value, onChange, 'aria-label': ariaLabel, inputId, autoFocus, ...restProps }: Props) {\n  return (\n    <Select\n      inputId={inputId}\n      value={value}\n      options={options}\n      onChange={(val) => onChange(val.value ?? OrgRole.None)}\n      placeholder={t('admin.org-role-picker.placeholder-choose-role', 'Choose role...')}\n      aria-label={ariaLabel}\n      autoFocus={autoFocus}\n      {...restProps}\n    />\n  );\n}\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2, Badge, Stack } from '@grafana/ui';\nimport { OrgUser } from 'app/types';\n\nimport { t } from '../../internationalization';\n\nimport { RolePickerDrawer } from './RolePickerDrawer';\n\nexport interface Props {\n  disabled?: boolean;\n  user: OrgUser;\n}\n\nexport const RolePickerBadges = ({ disabled, user }: Props) => {\n  const [isDrawerOpen, setIsDrawerOpen] = useState(false);\n\n  const { badge, badgeDisabled } = useStyles2(getStyles);\n  const badgeStyle = disabled ? badgeDisabled : badge;\n\n  const methods = useForm({\n    defaultValues: {\n      name: user.name,\n      role: user.role,\n      roles: user.roles,\n    },\n  });\n  const { watch } = methods;\n\n  const drawerControl = () => {\n    if (!disabled) {\n      setIsDrawerOpen(true);\n    }\n  };\n\n  return (\n    <>\n      <Stack gap={1}>\n        <Badge className={badgeStyle} color=\"blue\" onClick={drawerControl} text={watch('role')} />\n        {user.roles && user.roles.length > 0 && (\n          <Badge\n            className={badgeStyle}\n            color=\"blue\"\n            onClick={drawerControl}\n            text={t('role-picker-drawer.user-count', '+{{numUsers}}', { numUsers: user.roles.length })}\n          />\n        )}\n      </Stack>\n      {isDrawerOpen && (\n        <FormProvider {...methods}>\n          <RolePickerDrawer onClose={() => setIsDrawerOpen(false)} />\n        </FormProvider>\n      )}\n    </>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    badge: css({\n      cursor: 'pointer',\n    }),\n    badgeDisabled: css({\n      cursor: 'not-allowed',\n    }),\n  };\n}\n","import { useEffect, useMemo, useState } from 'react';\n\nimport { OrgRole } from '@grafana/data';\nimport { selectors as e2eSelectors } from '@grafana/e2e-selectors';\nimport { config } from '@grafana/runtime';\nimport {\n  Avatar,\n  Box,\n  Button,\n  CellProps,\n  Column,\n  ConfirmModal,\n  FetchDataFunc,\n  Icon,\n  InteractiveTable,\n  Pagination,\n  Stack,\n  Tag,\n  Text,\n  Tooltip,\n} from '@grafana/ui';\nimport { UserRolePicker } from 'app/core/components/RolePicker/UserRolePicker';\nimport { fetchRoleOptions, updateUserRoles } from 'app/core/components/RolePicker/api';\nimport { RolePickerBadges } from 'app/core/components/RolePickerDrawer/RolePickerBadges';\nimport { TagBadge } from 'app/core/components/TagFilter/TagBadge';\nimport { contextSrv } from 'app/core/core';\nimport { Trans, t } from 'app/core/internationalization';\nimport { AccessControlAction, OrgUser, Role } from 'app/types';\n\nimport { OrgRolePicker } from '../OrgRolePicker';\n\ntype Cell<T extends keyof OrgUser = keyof OrgUser> = CellProps<OrgUser, OrgUser[T]>;\n\nconst disabledRoleMessage = `This user's role is not editable because it is synchronized from your auth provider.\nRefer to the Grafana authentication docs for details.`;\n\nconst getBasicRoleDisabled = (user: OrgUser) => {\n  const isUserSynced = user?.isExternallySynced;\n  return !contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersWrite, user) || isUserSynced;\n};\n\nconst selectors = e2eSelectors.pages.UserListPage.UsersListPage;\n\nexport interface Props {\n  users: OrgUser[];\n  orgId?: number;\n  onRoleChange: (role: OrgRole, user: OrgUser) => void;\n  onRemoveUser: (user: OrgUser) => void;\n  fetchData?: FetchDataFunc<OrgUser>;\n  changePage: (page: number) => void;\n  page: number;\n  totalPages: number;\n  rolesLoading?: boolean;\n  onUserRolesChange?: () => void;\n}\n\nexport const OrgUsersTable = ({\n  users,\n  orgId,\n  onRoleChange,\n  onUserRolesChange,\n  onRemoveUser,\n  fetchData,\n  changePage,\n  page,\n  totalPages,\n  rolesLoading,\n}: Props) => {\n  const [userToRemove, setUserToRemove] = useState<OrgUser | null>(null);\n  const [roleOptions, setRoleOptions] = useState<Role[]>([]);\n\n  useEffect(() => {\n    async function fetchOptions() {\n      try {\n        if (contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n          let options = await fetchRoleOptions(orgId);\n          setRoleOptions(options);\n        }\n      } catch (e) {\n        console.error('Error loading options');\n      }\n    }\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchOptions();\n    }\n  }, [orgId]);\n\n  const columns: Array<Column<OrgUser>> = useMemo(\n    () => [\n      {\n        id: 'avatarUrl',\n        header: '',\n        cell: ({ cell: { value } }: Cell<'avatarUrl'>) => value && <Avatar src={value} alt=\"User avatar\" />,\n      },\n      {\n        id: 'login',\n        header: 'Login',\n        cell: ({ cell: { value } }: Cell<'login'>) => <div>{value}</div>,\n        sortType: 'string',\n      },\n      {\n        id: 'email',\n        header: 'Email',\n        cell: ({ cell: { value } }: Cell<'email'>) => value,\n        sortType: 'string',\n      },\n      {\n        id: 'name',\n        header: 'Name',\n        cell: ({ cell: { value } }: Cell<'name'>) => value,\n        sortType: 'string',\n      },\n      {\n        id: 'lastSeenAtAge',\n        header: 'Last active',\n        cell: ({ cell: { value } }: Cell<'lastSeenAtAge'>) => {\n          return (\n            <>\n              {value && (\n                <>\n                  {value === '10 years' ? (\n                    <Text color={'disabled'}>\n                      <Trans i18nKey=\"admin.org-uers.last-seen-never\">Never</Trans>\n                    </Text>\n                  ) : (\n                    value\n                  )}\n                </>\n              )}\n            </>\n          );\n        },\n        sortType: (a, b) => new Date(a.original.lastSeenAt).getTime() - new Date(b.original.lastSeenAt).getTime(),\n      },\n      {\n        id: 'role',\n        header: 'Role',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          const basicRoleDisabled = getBasicRoleDisabled(original);\n          const onUserRolesUpdate = async (newRoles: Role[], userId: number, orgId: number | undefined) => {\n            await updateUserRoles(newRoles, userId, orgId);\n            if (onUserRolesChange) {\n              onUserRolesChange();\n            }\n          };\n\n          if (config.featureToggles.rolePickerDrawer) {\n            return <RolePickerBadges disabled={basicRoleDisabled} user={original} />;\n          }\n\n          return contextSrv.licensedAccessControlEnabled() ? (\n            <UserRolePicker\n              userId={original.userId}\n              roles={original.roles}\n              apply={true}\n              onApplyRoles={onUserRolesUpdate}\n              isLoading={rolesLoading}\n              orgId={orgId}\n              roleOptions={roleOptions}\n              basicRole={value}\n              onBasicRoleChange={(newRole) => onRoleChange(newRole, original)}\n              basicRoleDisabled={basicRoleDisabled}\n              basicRoleDisabledMessage={disabledRoleMessage}\n              width={40}\n            />\n          ) : (\n            <OrgRolePicker\n              aria-label={t('admin.org-users-table.columns.aria-label-role', 'Role')}\n              value={value}\n              disabled={basicRoleDisabled}\n              onChange={(newRole) => onRoleChange(newRole, original)}\n            />\n          );\n        },\n      },\n      {\n        id: 'info',\n        header: '',\n        cell: ({ row: { original } }: Cell) => {\n          const basicRoleDisabled = getBasicRoleDisabled(original);\n          return (\n            basicRoleDisabled && (\n              <Box display={'flex'} alignItems={'center'} marginLeft={1}>\n                <Tooltip\n                  interactive={true}\n                  content={\n                    <div>\n                      <Trans i18nKey=\"admin.org-users.not-editable\">\n                        This user&apos;s role is not editable because it is synchronized from your auth provider. Refer\n                        to the&nbsp;\n                        <a\n                          href={\n                            'https://grafana.com/docs/grafana/latest/administration/user-management/manage-org-users/#change-a-users-organization-permissions'\n                          }\n                          rel=\"noreferrer\"\n                          target=\"_blank\"\n                        >\n                          Grafana authentication docs\n                        </a>\n                        &nbsp;for details.\n                      </Trans>\n                    </div>\n                  }\n                >\n                  <Icon name=\"question-circle\" />\n                </Tooltip>\n              </Box>\n            )\n          );\n        },\n      },\n      {\n        id: 'authLabels',\n        header: 'Origin',\n        cell: ({ cell: { value } }: Cell<'authLabels'>) => (\n          <>{Array.isArray(value) && value.length > 0 && <TagBadge label={value[0]} removeIcon={false} count={0} />}</>\n        ),\n      },\n      {\n        id: 'isProvisioned',\n        header: 'Provisioned',\n        cell: ({ cell: { value } }: Cell<'isProvisioned'>) => (\n          <>{value && <Tag colorIndex={14} name={'Provisioned'} />}</>\n        ),\n      },\n      {\n        id: 'isDisabled',\n        header: '',\n        cell: ({ cell: { value } }: Cell<'isDisabled'>) => <>{value && <Tag colorIndex={9} name={'Disabled'} />}</>,\n      },\n      {\n        id: 'delete',\n        header: '',\n        cell: ({ row: { original } }: Cell) => {\n          return (\n            contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersRemove, original) && (\n              <Button\n                size=\"sm\"\n                variant=\"destructive\"\n                onClick={() => {\n                  setUserToRemove(original);\n                }}\n                icon=\"times\"\n                aria-label={t('admin.org-users-table.delete-aria-label', 'Delete user: {{name}}', {\n                  name: original.name,\n                })}\n              />\n            )\n          );\n        },\n      },\n    ],\n    [rolesLoading, orgId, roleOptions, onUserRolesChange, onRoleChange]\n  );\n\n  return (\n    <Stack direction={'column'} gap={2} data-testid={selectors.container}>\n      <InteractiveTable columns={columns} data={users} getRowId={(user) => String(user.userId)} fetchData={fetchData} />\n      <Stack justifyContent=\"flex-end\">\n        <Pagination onNavigate={changePage} currentPage={page} numberOfPages={totalPages} hideWhenSinglePage={true} />\n      </Stack>\n      {Boolean(userToRemove) && (\n        <ConfirmModal\n          body={`Are you sure you want to delete user ${userToRemove?.login}?`}\n          confirmText=\"Delete\"\n          title={t('admin.org-users-table.title-delete', 'Delete')}\n          onDismiss={() => {\n            setUserToRemove(null);\n          }}\n          isOpen={true}\n          onConfirm={() => {\n            if (!userToRemove) {\n              return;\n            }\n            onRemoveUser(userToRemove);\n            setUserToRemove(null);\n          }}\n        />\n      )}\n    </Stack>\n  );\n};\n"],"names":["UserRolePicker","basicRole","roles","userId","orgId","onBasicRoleChange","roleOptions","disabled","basicRoleDisabled","basicRoleDisabledMessage","apply","onApplyRoles","pendingRoles","maxWidth","width","isLoading","loading","appliedRoles","getUserRoles","onRolesChange","canUpdateRoles","drawerSubtitle","RolePickerDrawer","onClose","methods","control","getValues","setValue","name","onChange","ref","fields","v","perPage","getOrg","getOrgUsers","page","accessControl","getUsersRoles","users","userIds","u","updateOrgUserRole","orgUser","removeOrgUser","updateOrgName","id","canWriteOrg","canReadUsers","setUsers","setPage","totalPages","setTotalPages","orgState","fetchOrg","useAsyncFn","handleSubmit","register","errors","fetchOrgUsers","result","onUpdateOrgName","orgName","renderMissingPermissionMessage","Alert","onPageChange","toPage","onRemoveUser","onRoleChange","role","pageNav","Page","Legend","Field","Input","Button","OrgUsersTable","options","r","OrgRolePicker","value","ariaLabel","inputId","autoFocus","restProps","val","RolePickerBadges","user","isDrawerOpen","setIsDrawerOpen","badge","badgeDisabled","getStyles","badgeStyle","watch","drawerControl","Stack","Badge","theme","disabledRoleMessage","getBasicRoleDisabled","isUserSynced","onUserRolesChange","fetchData","changePage","rolesLoading","userToRemove","setUserToRemove","setRoleOptions","fetchOptions","columns","Avatar","Text","a","b","original","onUserRolesUpdate","newRoles","config","newRole","Box","Tooltip","Icon","TagBadge","Tag","InteractiveTable","Pagination","ConfirmModal"],"sourceRoot":""}