{"version":3,"file":"ServiceAccountPage.4d24a4e62e2c1dd55a07.js","mappings":"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","sources":["webpack://grafana/./public/app/core/components/RolePicker/UserRolePicker.tsx","webpack://grafana/./public/app/features/admin/OrgRolePicker.tsx","webpack://grafana/./public/app/features/serviceaccounts/ServiceAccountPermissions.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/ServiceAccountProfileRow.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/ServiceAccountRoleRow.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/ServiceAccountProfile.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/ServiceAccountTokensTable.tsx","webpack://grafana/./public/app/features/serviceaccounts/state/actionsServiceAccountPage.ts","webpack://grafana/./public/app/features/serviceaccounts/ServiceAccountPage.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/CreateTokenModal.tsx","webpack://grafana/./public/app/features/serviceaccounts/state/actions.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport { useAsyncFn } from 'react-use';\n\nimport { contextSrv } from 'app/core/core';\nimport { Role, OrgRole, AccessControlAction } from 'app/types';\n\nimport { RolePicker } from './RolePicker';\nimport { fetchUserRoles, updateUserRoles } from './api';\n\nexport interface Props {\n  basicRole: OrgRole;\n  roles?: Role[];\n  userId: number;\n  orgId?: number;\n  onBasicRoleChange: (newRole: OrgRole) => void;\n  roleOptions: Role[];\n  disabled?: boolean;\n  basicRoleDisabled?: boolean;\n  basicRoleDisabledMessage?: string;\n  /**\n   * Set whether the component should send a request with the new roles to the\n   * backend in UserRolePicker.onRolesChange (apply=false), or call {@link onApplyRoles}\n   * with the updated list of roles (apply=true).\n   *\n   * Besides it sets the RolePickerMenu's Button title to\n   *   * `Update` in case apply equals false\n   *   * `Apply` in case apply equals true\n   *\n   * @default false\n   */\n  apply?: boolean;\n  onApplyRoles?: (newRoles: Role[], userId: number, orgId: number | undefined) => void;\n  pendingRoles?: Role[];\n  maxWidth?: string | number;\n  width?: string | number;\n  isLoading?: boolean;\n}\n\nexport const UserRolePicker = ({\n  basicRole,\n  roles,\n  userId,\n  orgId,\n  onBasicRoleChange,\n  roleOptions,\n  disabled,\n  basicRoleDisabled,\n  basicRoleDisabledMessage,\n  apply = false,\n  onApplyRoles,\n  pendingRoles,\n  maxWidth,\n  width,\n  isLoading,\n}: Props) => {\n  const [{ loading, value: appliedRoles = roles || [] }, getUserRoles] = useAsyncFn(async () => {\n    try {\n      if (roles) {\n        return roles;\n      }\n      if (apply && Boolean(pendingRoles?.length)) {\n        return pendingRoles;\n      }\n\n      if (contextSrv.hasPermission(AccessControlAction.ActionUserRolesList) && userId > 0) {\n        return await fetchUserRoles(userId, orgId);\n      }\n    } catch (e) {\n      // TODO handle error\n      console.error('Error loading options');\n    }\n    return [];\n  }, [orgId, userId, pendingRoles, roles]);\n\n  useEffect(() => {\n    // only load roles when there is an Org selected\n    if (orgId) {\n      getUserRoles();\n    }\n  }, [getUserRoles, orgId]);\n\n  const onRolesChange = async (roles: Role[]) => {\n    if (!apply) {\n      await updateUserRoles(roles, userId, orgId);\n      await getUserRoles();\n    } else if (onApplyRoles) {\n      onApplyRoles(roles, userId, orgId);\n    }\n  };\n\n  const canUpdateRoles =\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesAdd) &&\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesRemove);\n\n  return (\n    <RolePicker\n      appliedRoles={appliedRoles}\n      basicRole={basicRole}\n      onRolesChange={onRolesChange}\n      onBasicRoleChange={onBasicRoleChange}\n      roleOptions={roleOptions}\n      isLoading={loading || isLoading}\n      disabled={disabled}\n      basicRoleDisabled={basicRoleDisabled}\n      basicRoleDisabledMessage={basicRoleDisabledMessage}\n      showBasicRole\n      apply={apply}\n      canUpdateRoles={canUpdateRoles}\n      maxWidth={maxWidth}\n      width={width}\n    />\n  );\n};\n","import { OrgRole } from '@grafana/data';\nimport { Select } from '@grafana/ui';\nimport { t } from 'app/core/internationalization';\n\ninterface Props {\n  value: OrgRole;\n  disabled?: boolean;\n  'aria-label'?: string;\n  inputId?: string;\n  onChange: (role: OrgRole) => void;\n  autoFocus?: boolean;\n  width?: number | 'auto';\n}\n\nconst basicRoles = Object.values(OrgRole).filter((r) => r !== OrgRole.None);\nconst options = basicRoles.map((r) => ({ label: r, value: r }));\n\nexport function OrgRolePicker({ value, onChange, 'aria-label': ariaLabel, inputId, autoFocus, ...restProps }: Props) {\n  return (\n    <Select\n      inputId={inputId}\n      value={value}\n      options={options}\n      onChange={(val) => onChange(val.value ?? OrgRole.None)}\n      placeholder={t('admin.org-role-picker.placeholder-choose-role', 'Choose role...')}\n      aria-label={ariaLabel}\n      autoFocus={autoFocus}\n      {...restProps}\n    />\n  );\n}\n","import { Permissions } from 'app/core/components/AccessControl';\nimport { t } from 'app/core/internationalization';\nimport { contextSrv } from 'app/core/services/context_srv';\n\nimport { AccessControlAction, ServiceAccountDTO } from '../../types';\n\ntype ServiceAccountPermissionsProps = {\n  serviceAccount: ServiceAccountDTO;\n};\n\nexport const ServiceAccountPermissions = (props: ServiceAccountPermissionsProps) => {\n  const canSetPermissions = contextSrv.hasPermissionInMetadata(\n    AccessControlAction.ServiceAccountsPermissionsWrite,\n    props.serviceAccount\n  );\n\n  return (\n    <Permissions\n      title={t('serviceaccounts.service-account-permissions.title-permissions', 'Permissions')}\n      addPermissionTitle=\"Add permission\"\n      buttonLabel=\"Add permission\"\n      resource=\"serviceaccounts\"\n      resourceId={props.serviceAccount.uid}\n      canSetPermissions={canSetPermissions}\n    />\n  );\n};\n","import { css, cx } from '@emotion/css';\nimport { useEffect, useRef, useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { ConfirmButton, Input, Label, LegacyInputStatus, useStyles2 } from '@grafana/ui';\n\ninterface Props {\n  label: string;\n  value?: string;\n  inputType?: string;\n  disabled?: boolean;\n  onChange?: (value: string) => void;\n}\n\nexport const ServiceAccountProfileRow = ({ label, value, inputType, disabled, onChange }: Props): JSX.Element => {\n  const inputElem = useRef<HTMLInputElement>(null);\n  const [inputValue, setInputValue] = useState(value);\n  const [isEditing, setIsEditing] = useState(false);\n  const styles = useStyles2(getStyles);\n  const inputId = `${label}-input`;\n\n  useEffect(() => {\n    if (isEditing) {\n      focusInput();\n    }\n  }, [isEditing]);\n\n  const onEditClick = () => {\n    setIsEditing(true);\n  };\n\n  const onCancelClick = () => {\n    setIsEditing(false);\n    setInputValue(value || '');\n  };\n\n  const onInputChange = (event: React.ChangeEvent<HTMLInputElement>, status?: LegacyInputStatus) => {\n    if (status === LegacyInputStatus.Invalid) {\n      return;\n    }\n    setInputValue(event.target.value);\n  };\n\n  const onInputBlur = (event: React.FocusEvent<HTMLInputElement>, status?: LegacyInputStatus) => {\n    if (status === LegacyInputStatus.Invalid) {\n      return;\n    }\n    setInputValue(event.target.value);\n  };\n\n  const focusInput = () => {\n    inputElem?.current?.focus();\n  };\n\n  const onSave = () => {\n    setIsEditing(false);\n    if (onChange) {\n      onChange(inputValue!);\n    }\n  };\n\n  return (\n    <tr>\n      <td>\n        <Label htmlFor={inputId}>{label}</Label>\n      </td>\n      <td className=\"width-25\" colSpan={2}>\n        {!disabled && isEditing ? (\n          <Input\n            id={inputId}\n            type={inputType}\n            defaultValue={value}\n            onBlur={onInputBlur}\n            onChange={onInputChange}\n            ref={inputElem}\n            width={30}\n          />\n        ) : (\n          <span className={cx({ [styles.disabled]: disabled })}>{value}</span>\n        )}\n      </td>\n      <td>\n        {onChange && (\n          <ConfirmButton\n            closeOnConfirm\n            confirmText=\"Save\"\n            onConfirm={onSave}\n            onClick={onEditClick}\n            onCancel={onCancelClick}\n            disabled={disabled}\n          >\n            Edit\n          </ConfirmButton>\n        )}\n      </td>\n    </tr>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    disabled: css({\n      color: theme.colors.text.secondary,\n    }),\n  };\n};\n","import { Label } from '@grafana/ui';\nimport { UserRolePicker } from 'app/core/components/RolePicker/UserRolePicker';\nimport { contextSrv } from 'app/core/core';\nimport { t } from 'app/core/internationalization';\nimport { OrgRolePicker } from 'app/features/admin/OrgRolePicker';\nimport { AccessControlAction, OrgRole, Role, ServiceAccountDTO } from 'app/types';\n\ninterface Props {\n  label: string;\n  serviceAccount: ServiceAccountDTO;\n  onRoleChange: (role: OrgRole) => void;\n  roleOptions: Role[];\n}\n\nexport const ServiceAccountRoleRow = ({ label, serviceAccount, roleOptions, onRoleChange }: Props): JSX.Element => {\n  const inputId = `${label}-input`;\n  const canUpdateRole = contextSrv.hasPermissionInMetadata(AccessControlAction.ServiceAccountsWrite, serviceAccount);\n\n  return (\n    <tr>\n      <td>\n        <Label htmlFor={inputId}>{label}</Label>\n      </td>\n      {contextSrv.licensedAccessControlEnabled() ? (\n        <td colSpan={3}>\n          <UserRolePicker\n            userId={serviceAccount.id}\n            orgId={serviceAccount.orgId}\n            basicRole={serviceAccount.role}\n            onBasicRoleChange={onRoleChange}\n            roleOptions={roleOptions}\n            basicRoleDisabled={!canUpdateRole}\n            disabled={serviceAccount.isExternal || serviceAccount.isDisabled}\n          />\n        </td>\n      ) : (\n        <>\n          <td>\n            <OrgRolePicker\n              width={24}\n              inputId={inputId}\n              aria-label={t('serviceaccounts.service-account-role-row.aria-label-role', 'Role')}\n              value={serviceAccount.role}\n              disabled={serviceAccount.isExternal || serviceAccount.isDisabled}\n              onChange={onRoleChange}\n            />\n          </td>\n          <td colSpan={2}></td>\n        </>\n      )}\n    </tr>\n  );\n};\n","import { css } from '@emotion/css';\nimport { useEffect, useState } from 'react';\n\nimport { GrafanaTheme2, OrgRole, TimeZone, dateTimeFormat } from '@grafana/data';\nimport { Label, TextLink, useStyles2 } from '@grafana/ui';\nimport { fetchRoleOptions } from 'app/core/components/RolePicker/api';\nimport { contextSrv } from 'app/core/core';\nimport { Trans, t } from 'app/core/internationalization';\nimport { AccessControlAction, Role, ServiceAccountDTO } from 'app/types';\n\nimport { ServiceAccountProfileRow } from './ServiceAccountProfileRow';\nimport { ServiceAccountRoleRow } from './ServiceAccountRoleRow';\n\ninterface Props {\n  serviceAccount: ServiceAccountDTO;\n  timeZone: TimeZone;\n  onChange: (serviceAccount: ServiceAccountDTO) => void;\n}\n\nexport function ServiceAccountProfile({ serviceAccount, timeZone, onChange }: Props): JSX.Element {\n  const styles = useStyles2(getStyles);\n  const ableToWrite = contextSrv.hasPermission(AccessControlAction.ServiceAccountsWrite);\n  const [roles, setRoleOptions] = useState<Role[]>([]);\n\n  const onRoleChange = (role: OrgRole) => {\n    onChange({ ...serviceAccount, role: role });\n  };\n\n  const onNameChange = (newValue: string) => {\n    onChange({ ...serviceAccount, name: newValue });\n  };\n\n  useEffect(() => {\n    async function fetchOptions() {\n      try {\n        if (contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n          let options = await fetchRoleOptions(serviceAccount.orgId);\n          setRoleOptions(options);\n        }\n      } catch (e) {\n        console.error('Error loading options for service account');\n      }\n    }\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchOptions();\n    }\n  }, [serviceAccount.orgId]);\n\n  return (\n    <div className={styles.section}>\n      <h3>\n        <Trans i18nKey=\"serviceaccounts.service-account-profile.information\">Information</Trans>\n      </h3>\n      <table className=\"filter-table\">\n        <tbody>\n          {serviceAccount.id && (\n            <ServiceAccountProfileRow\n              label={t('serviceaccounts.service-account-profile.label-numerical-identifier', 'Numerical identifier')}\n              value={serviceAccount.id.toString()}\n              disabled={true}\n            />\n          )}\n          <ServiceAccountProfileRow\n            label={t('serviceaccounts.service-account-profile.label-name', 'Name')}\n            value={serviceAccount.name}\n            onChange={!serviceAccount.isExternal ? onNameChange : undefined}\n            disabled={!ableToWrite || serviceAccount.isDisabled}\n          />\n          <ServiceAccountProfileRow\n            label={t('serviceaccounts.service-account-profile.label-id', 'ID')}\n            value={serviceAccount.login}\n            disabled={serviceAccount.isDisabled}\n          />\n          <ServiceAccountRoleRow\n            label={t('serviceaccounts.service-account-profile.label-roles', 'Roles')}\n            serviceAccount={serviceAccount}\n            onRoleChange={onRoleChange}\n            roleOptions={roles}\n          />\n          <ServiceAccountProfileRow\n            label={t('serviceaccounts.service-account-profile.label-creation-date', 'Creation date')}\n            value={dateTimeFormat(serviceAccount.createdAt, { timeZone })}\n            disabled={serviceAccount.isDisabled}\n          />\n          {serviceAccount.isExternal && serviceAccount.requiredBy && (\n            <tr>\n              <td>\n                <Label>\n                  <Trans i18nKey=\"serviceaccounts.service-account-profile.used-by\">Used by</Trans>\n                </Label>\n              </td>\n              <td>\n                <TextLink href={`/plugins/${serviceAccount.requiredBy}`}>{serviceAccount.requiredBy}</TextLink>\n              </td>\n            </tr>\n          )}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport const getStyles = (theme: GrafanaTheme2) => ({\n  section: css({\n    marginBottom: theme.spacing(4),\n  }),\n});\n","import { css, cx } from '@emotion/css';\n\nimport { dateTimeFormat, GrafanaTheme2, TimeZone } from '@grafana/data';\nimport { DeleteButton, Icon, Tooltip, useStyles2, useTheme2 } from '@grafana/ui';\nimport { Trans } from 'app/core/internationalization';\nimport { ApiKey } from 'app/types';\n\ninterface Props {\n  tokens: ApiKey[];\n  timeZone: TimeZone;\n  tokenActionsDisabled?: boolean;\n  onDelete: (token: ApiKey) => void;\n}\n\nexport const ServiceAccountTokensTable = ({ tokens, timeZone, tokenActionsDisabled, onDelete }: Props): JSX.Element => {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n\n  return (\n    <table className={cx(styles.section, 'filter-table')}>\n      <thead>\n        <tr>\n          <th>\n            <Trans i18nKey=\"serviceaccounts.service-account-tokens-table.name\">Name</Trans>\n          </th>\n          <th>\n            <Trans i18nKey=\"serviceaccounts.service-account-tokens-table.expires\">Expires</Trans>\n          </th>\n          <th>\n            <Trans i18nKey=\"serviceaccounts.service-account-tokens-table.created\">Created</Trans>\n          </th>\n          <th>\n            <Trans i18nKey=\"serviceaccounts.service-account-tokens-table.last-used-at\">Last used at</Trans>\n          </th>\n          <th />\n          <th />\n        </tr>\n      </thead>\n      <tbody>\n        {tokens.map((key) => {\n          return (\n            <tr key={key.id} className={styles.tableRow(key.hasExpired || key.isRevoked)}>\n              <td>{key.name}</td>\n              <td>\n                <TokenExpiration timeZone={timeZone} token={key} />\n              </td>\n              <td>{formatDate(timeZone, key.created)}</td>\n              <td>{formatLastUsedAtDate(timeZone, key.lastUsedAt)}</td>\n              <td className=\"width-1 text-center\">{key.isRevoked && <TokenRevoked />}</td>\n              <td>\n                <DeleteButton\n                  aria-label={`Delete service account token ${key.name}`}\n                  size=\"sm\"\n                  onConfirm={() => onDelete(key)}\n                  disabled={tokenActionsDisabled}\n                />\n              </td>\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n};\n\nfunction formatLastUsedAtDate(timeZone: TimeZone, lastUsedAt?: string): string {\n  if (!lastUsedAt) {\n    return 'Never';\n  }\n  return dateTimeFormat(lastUsedAt, { timeZone });\n}\n\nfunction formatDate(timeZone: TimeZone, expiration?: string): string {\n  if (!expiration) {\n    return 'No expiration date';\n  }\n  return dateTimeFormat(expiration, { timeZone });\n}\n\nfunction formatSecondsLeftUntilExpiration(secondsUntilExpiration: number): string {\n  const days = Math.ceil(secondsUntilExpiration / (3600 * 24));\n  const daysFormat = days > 1 ? `${days} days` : `${days} day`;\n  return `Expires in ${daysFormat}`;\n}\n\nconst TokenRevoked = () => {\n  const styles = useStyles2(getStyles);\n  return (\n    <span className={styles.hasExpired}>\n      Revoked\n      <span className={styles.tooltipContainer}>\n        <Tooltip content=\"This token has been publicly exposed. Please rotate this token\">\n          <Icon name=\"exclamation-triangle\" className={styles.toolTipIcon} />\n        </Tooltip>\n      </span>\n    </span>\n  );\n};\n\ninterface TokenExpirationProps {\n  timeZone: TimeZone;\n  token: ApiKey;\n}\n\nconst TokenExpiration = ({ timeZone, token }: TokenExpirationProps) => {\n  const styles = useStyles2(getStyles);\n  if (!token.expiration) {\n    return (\n      <span className={styles.neverExpire}>\n        <Trans i18nKey=\"serviceaccounts.token-expiration.never\">Never</Trans>\n      </span>\n    );\n  }\n  if (token.secondsUntilExpiration) {\n    return (\n      <span className={styles.secondsUntilExpiration}>\n        {formatSecondsLeftUntilExpiration(token.secondsUntilExpiration)}\n      </span>\n    );\n  }\n  if (token.hasExpired) {\n    return (\n      <span className={styles.hasExpired}>\n        Expired\n        <span className={styles.tooltipContainer}>\n          <Tooltip content=\"This token has expired\">\n            <Icon name=\"exclamation-triangle\" className={styles.toolTipIcon} />\n          </Tooltip>\n        </span>\n      </span>\n    );\n  }\n  return <span>{formatDate(timeZone, token.expiration)}</span>;\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  tableRow: (hasExpired: boolean | undefined) =>\n    css({\n      color: hasExpired ? theme.colors.text.secondary : theme.colors.text.primary,\n    }),\n  tooltipContainer: css({\n    marginLeft: theme.spacing(1),\n  }),\n  toolTipIcon: css({\n    color: theme.colors.error.text,\n  }),\n  secondsUntilExpiration: css({\n    color: theme.colors.warning.text,\n  }),\n  hasExpired: css({\n    color: theme.colors.error.text,\n  }),\n  neverExpire: css({\n    color: theme.colors.text.secondary,\n  }),\n  section: css({\n    marginBottom: theme.spacing(4),\n  }),\n});\n","import { getBackendSrv, locationService } from '@grafana/runtime';\nimport { accessControlQueryParam } from 'app/core/utils/accessControl';\nimport { ServiceAccountDTO, ThunkResult } from 'app/types';\n\nimport { ServiceAccountToken } from '../components/CreateTokenModal';\n\nimport {\n  serviceAccountFetchBegin,\n  serviceAccountFetchEnd,\n  serviceAccountLoaded,\n  serviceAccountTokensLoaded,\n} from './reducers';\n\nconst BASE_URL = `/api/serviceaccounts`;\n\nexport function loadServiceAccount(saUid: string): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(serviceAccountFetchBegin());\n    try {\n      const response = await getBackendSrv().get(`${BASE_URL}/${saUid}`, accessControlQueryParam());\n      dispatch(serviceAccountLoaded(response));\n    } catch (error) {\n      console.error(error);\n    } finally {\n      dispatch(serviceAccountFetchEnd());\n    }\n  };\n}\n\nexport function updateServiceAccount(serviceAccount: ServiceAccountDTO): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`${BASE_URL}/${serviceAccount.uid}?accesscontrol=true`, {\n      ...serviceAccount,\n    });\n    dispatch(loadServiceAccount(serviceAccount.uid));\n  };\n}\n\nexport function deleteServiceAccount(serviceAccountUid: string): ThunkResult<void> {\n  return async () => {\n    await getBackendSrv().delete(`${BASE_URL}/${serviceAccountUid}`);\n    locationService.push('/org/serviceaccounts');\n  };\n}\n\nexport function createServiceAccountToken(\n  saUid: string,\n  token: ServiceAccountToken,\n  onTokenCreated: (key: string) => void\n): ThunkResult<void> {\n  return async (dispatch) => {\n    const result = await getBackendSrv().post(`${BASE_URL}/${saUid}/tokens`, token);\n    onTokenCreated(result.key);\n    dispatch(loadServiceAccountTokens(saUid));\n  };\n}\n\nexport function deleteServiceAccountToken(saUid: string, id: number): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`${BASE_URL}/${saUid}/tokens/${id}`);\n    dispatch(loadServiceAccountTokens(saUid));\n  };\n}\n\nexport function loadServiceAccountTokens(saUid: string): ThunkResult<void> {\n  return async (dispatch) => {\n    try {\n      const response = await getBackendSrv().get(`${BASE_URL}/${saUid}/tokens`);\n      dispatch(serviceAccountTokensLoaded(response));\n    } catch (error) {\n      console.error(error);\n    }\n  };\n}\n","import { useEffect, useState } from 'react';\nimport { ConnectedProps, connect } from 'react-redux';\nimport { useParams } from 'react-router-dom-v5-compat';\n\nimport { NavModelItem, getTimeZone } from '@grafana/data';\nimport { Button, ConfirmModal, IconButton, Stack } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/core';\nimport { Trans, t } from 'app/core/internationalization';\nimport { AccessControlAction, ApiKey, ServiceAccountDTO, StoreState } from 'app/types';\n\nimport { ServiceAccountPermissions } from './ServiceAccountPermissions';\nimport { CreateTokenModal, ServiceAccountToken } from './components/CreateTokenModal';\nimport { ServiceAccountProfile } from './components/ServiceAccountProfile';\nimport { ServiceAccountTokensTable } from './components/ServiceAccountTokensTable';\nimport { fetchACOptions } from './state/actions';\nimport {\n  createServiceAccountToken,\n  deleteServiceAccount,\n  deleteServiceAccountToken,\n  loadServiceAccount,\n  loadServiceAccountTokens,\n  updateServiceAccount,\n} from './state/actionsServiceAccountPage';\n\ninterface OwnProps {\n  serviceAccount?: ServiceAccountDTO;\n  tokens: ApiKey[];\n  isLoading: boolean;\n}\n\nfunction mapStateToProps(state: StoreState) {\n  return {\n    serviceAccount: state.serviceAccountProfile.serviceAccount,\n    tokens: state.serviceAccountProfile.tokens,\n    isLoading: state.serviceAccountProfile.isLoading,\n    timezone: getTimeZone(state.user),\n  };\n}\n\nconst mapDispatchToProps = {\n  createServiceAccountToken,\n  deleteServiceAccount,\n  deleteServiceAccountToken,\n  loadServiceAccount,\n  loadServiceAccountTokens,\n  updateServiceAccount,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport type Props = OwnProps & ConnectedProps<typeof connector>;\n\nexport const ServiceAccountPageUnconnected = ({\n  serviceAccount,\n  tokens,\n  timezone,\n  isLoading,\n  createServiceAccountToken,\n  deleteServiceAccount,\n  deleteServiceAccountToken,\n  loadServiceAccount,\n  loadServiceAccountTokens,\n  updateServiceAccount,\n}: Props): JSX.Element => {\n  const [newToken, setNewToken] = useState('');\n  const [isTokenModalOpen, setIsTokenModalOpen] = useState(false);\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [isDisableModalOpen, setIsDisableModalOpen] = useState(false);\n  const { id = '' } = useParams();\n\n  const tokenActionsDisabled =\n    serviceAccount.isDisabled ||\n    serviceAccount.isExternal ||\n    !contextSrv.hasPermission(AccessControlAction.ServiceAccountsWrite);\n\n  const ableToWrite = contextSrv.hasPermission(AccessControlAction.ServiceAccountsWrite);\n  const canReadPermissions = contextSrv.hasPermissionInMetadata(\n    AccessControlAction.ServiceAccountsPermissionsRead,\n    serviceAccount!\n  );\n\n  const pageNav: NavModelItem = {\n    text: serviceAccount.name,\n    img: serviceAccount.avatarUrl,\n    subTitle: 'Manage settings for an individual service account.',\n  };\n\n  useEffect(() => {\n    loadServiceAccount(id);\n    loadServiceAccountTokens(id);\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchACOptions();\n    }\n  }, [loadServiceAccount, loadServiceAccountTokens, id]);\n\n  const onProfileChange = (serviceAccount: ServiceAccountDTO) => {\n    updateServiceAccount(serviceAccount);\n  };\n\n  const showDeleteServiceAccountModal = (show: boolean) => () => {\n    setIsDeleteModalOpen(show);\n  };\n\n  const showDisableServiceAccountModal = (show: boolean) => () => {\n    setIsDisableModalOpen(show);\n  };\n\n  const handleServiceAccountDelete = () => {\n    deleteServiceAccount(serviceAccount.uid);\n  };\n\n  const handleServiceAccountDisable = () => {\n    updateServiceAccount({ ...serviceAccount, isDisabled: true });\n    setIsDisableModalOpen(false);\n  };\n\n  const handleServiceAccountEnable = () => {\n    updateServiceAccount({ ...serviceAccount, isDisabled: false });\n  };\n\n  const onDeleteServiceAccountToken = (key: ApiKey) => {\n    deleteServiceAccountToken(serviceAccount?.uid, key.id!);\n  };\n\n  const onCreateToken = (token: ServiceAccountToken) => {\n    createServiceAccountToken(serviceAccount?.uid, token, setNewToken);\n  };\n\n  const onTokenModalClose = () => {\n    setIsTokenModalOpen(false);\n    setNewToken('');\n  };\n\n  return (\n    <Page navId=\"serviceaccounts\" pageNav={pageNav}>\n      <Page.Contents isLoading={isLoading}>\n        <div>\n          {serviceAccount && !serviceAccount.isExternal && (\n            <Stack gap={2} height=\"auto\" justifyContent=\"flex-end\">\n              <Button\n                type={'button'}\n                variant=\"destructive\"\n                onClick={showDeleteServiceAccountModal(true)}\n                disabled={!contextSrv.hasPermission(AccessControlAction.ServiceAccountsDelete)}\n              >\n                <Trans i18nKey=\"serviceaccounts.service-account-page-unconnected.delete-service-account\">\n                  Delete service account\n                </Trans>\n              </Button>\n              {serviceAccount.isDisabled ? (\n                <Button\n                  type={'button'}\n                  variant=\"secondary\"\n                  onClick={handleServiceAccountEnable}\n                  disabled={!ableToWrite}\n                >\n                  <Trans i18nKey=\"serviceaccounts.service-account-page-unconnected.enable-service-account\">\n                    Enable service account\n                  </Trans>\n                </Button>\n              ) : (\n                <Button\n                  type={'button'}\n                  variant=\"secondary\"\n                  onClick={showDisableServiceAccountModal(true)}\n                  disabled={!ableToWrite}\n                >\n                  <Trans i18nKey=\"serviceaccounts.service-account-page-unconnected.disable-service-account\">\n                    Disable service account\n                  </Trans>\n                </Button>\n              )}\n            </Stack>\n          )}\n          {serviceAccount && serviceAccount.isExternal && (\n            <Stack gap={2} height=\"auto\" justifyContent=\"flex-end\">\n              <IconButton\n                disabled={true}\n                name=\"lock\"\n                size=\"md\"\n                tooltip={t(\n                  'serviceaccounts.service-account-page-unconnected.tooltip-managed-service-account-cannot-modified',\n                  'This is a managed service account and cannot be modified'\n                )}\n              />\n            </Stack>\n          )}\n          {serviceAccount && (\n            <ServiceAccountProfile serviceAccount={serviceAccount} timeZone={timezone} onChange={onProfileChange} />\n          )}\n          <Stack justifyContent=\"space-between\" height=\"auto\">\n            <h3>\n              <Trans i18nKey=\"serviceaccounts.service-account-page-unconnected.tokens\">Tokens</Trans>\n            </h3>\n            {!serviceAccount.isExternal && (\n              <Button\n                onClick={() => setIsTokenModalOpen(true)}\n                disabled={tokenActionsDisabled}\n                key=\"add-service-account-token\"\n                icon=\"plus\"\n              >\n                <Trans i18nKey=\"serviceaccounts.service-account-page-unconnected.add-service-account-token\">\n                  Add service account token\n                </Trans>\n              </Button>\n            )}\n          </Stack>\n          {tokens && (\n            <ServiceAccountTokensTable\n              tokens={tokens}\n              timeZone={timezone}\n              onDelete={onDeleteServiceAccountToken}\n              tokenActionsDisabled={tokenActionsDisabled}\n            />\n          )}\n          {!serviceAccount.isExternal && canReadPermissions && (\n            <ServiceAccountPermissions serviceAccount={serviceAccount} />\n          )}\n        </div>\n\n        <ConfirmModal\n          isOpen={isDeleteModalOpen}\n          title={t(\n            'serviceaccounts.service-account-page-unconnected.title-delete-service-account',\n            'Delete service account'\n          )}\n          body=\"Are you sure you want to delete this service account?\"\n          confirmText=\"Delete service account\"\n          onConfirm={handleServiceAccountDelete}\n          onDismiss={showDeleteServiceAccountModal(false)}\n        />\n        <ConfirmModal\n          isOpen={isDisableModalOpen}\n          title={t(\n            'serviceaccounts.service-account-page-unconnected.title-disable-service-account',\n            'Disable service account'\n          )}\n          body=\"Are you sure you want to disable this service account?\"\n          confirmText=\"Disable service account\"\n          onConfirm={handleServiceAccountDisable}\n          onDismiss={showDisableServiceAccountModal(false)}\n        />\n        <CreateTokenModal\n          isOpen={isTokenModalOpen}\n          token={newToken}\n          serviceAccountLogin={serviceAccount.login}\n          onCreateToken={onCreateToken}\n          onClose={onTokenModalClose}\n        />\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default connector(ServiceAccountPageUnconnected);\n","import { css } from '@emotion/css';\nimport { useEffect, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport {\n  Button,\n  ClipboardButton,\n  DatePickerWithInput,\n  Field,\n  Input,\n  Modal,\n  RadioButtonGroup,\n  useStyles2,\n} from '@grafana/ui';\nimport { t, Trans } from 'app/core/internationalization';\n\nconst EXPIRATION_OPTIONS = [\n  { label: 'No expiration', value: false },\n  { label: 'Set expiration date', value: true },\n];\n\nexport type ServiceAccountToken = {\n  name: string;\n  secondsToLive?: number;\n};\n\ninterface Props {\n  isOpen: boolean;\n  token: string;\n  serviceAccountLogin: string;\n  onCreateToken: (token: ServiceAccountToken) => void;\n  onClose: () => void;\n}\n\nexport const CreateTokenModal = ({ isOpen, token, serviceAccountLogin, onCreateToken, onClose }: Props) => {\n  const tomorrow = new Date();\n  tomorrow.setDate(tomorrow.getDate() + 1);\n\n  const maxExpirationDate = new Date();\n  if (config.tokenExpirationDayLimit !== undefined && config.tokenExpirationDayLimit > -1) {\n    maxExpirationDate.setDate(maxExpirationDate.getDate() + config.tokenExpirationDayLimit + 1);\n  } else {\n    maxExpirationDate.setDate(8640000000000000);\n  }\n  const defaultExpirationDate = config.tokenExpirationDayLimit !== undefined && config.tokenExpirationDayLimit > 0;\n\n  const [defaultTokenName, setDefaultTokenName] = useState('');\n  const [newTokenName, setNewTokenName] = useState('');\n  const [isWithExpirationDate, setIsWithExpirationDate] = useState(defaultExpirationDate);\n  const [newTokenExpirationDate, setNewTokenExpirationDate] = useState<Date | string>(tomorrow);\n  const [isExpirationDateValid, setIsExpirationDateValid] = useState(newTokenExpirationDate !== '');\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    // Generate new token name every time we open modal\n    if (isOpen) {\n      setDefaultTokenName(`${serviceAccountLogin}-${uuidv4()}`);\n    }\n  }, [serviceAccountLogin, isOpen]);\n\n  const onExpirationDateChange = (value: Date | string) => {\n    const isValid = value !== '';\n    setIsExpirationDateValid(isValid);\n    setNewTokenExpirationDate(value);\n  };\n\n  const onGenerateToken = () => {\n    onCreateToken({\n      name: newTokenName || defaultTokenName,\n      secondsToLive: isWithExpirationDate ? getSecondsToLive(newTokenExpirationDate) : undefined,\n    });\n  };\n\n  const onCloseInternal = () => {\n    setNewTokenName('');\n    setDefaultTokenName('');\n    setIsWithExpirationDate(defaultExpirationDate);\n    setNewTokenExpirationDate(tomorrow);\n    setIsExpirationDateValid(newTokenExpirationDate !== '');\n    onClose();\n  };\n\n  const modalTitle = !token ? 'Add service account token' : 'Service account token created';\n\n  return (\n    <Modal isOpen={isOpen} title={modalTitle} onDismiss={onCloseInternal} className={styles.modal}>\n      {!token ? (\n        <div>\n          <Field\n            label={t('serviceaccounts.create-token-modal.label-display-name', 'Display name')}\n            description={t(\n              'serviceaccounts.create-token-modal.description-name-to-easily-identify-the-token',\n              'Name to easily identify the token'\n            )}\n            // for now this is required\n            // need to make this optional in backend as well\n            required={true}\n          >\n            <Input\n              name=\"tokenName\"\n              value={newTokenName}\n              placeholder={defaultTokenName}\n              onChange={(e) => {\n                setNewTokenName(e.currentTarget.value);\n              }}\n            />\n          </Field>\n          <Field label={t('serviceaccounts.create-token-modal.label-expiration', 'Expiration')}>\n            <RadioButtonGroup\n              options={EXPIRATION_OPTIONS}\n              value={isWithExpirationDate}\n              onChange={setIsWithExpirationDate}\n              size=\"md\"\n            />\n          </Field>\n          {isWithExpirationDate && (\n            <Field label={t('serviceaccounts.create-token-modal.label-expiration-date', 'Expiration date')}>\n              <DatePickerWithInput\n                onChange={onExpirationDateChange}\n                value={newTokenExpirationDate}\n                placeholder=\"\"\n                minDate={tomorrow}\n                maxDate={maxExpirationDate}\n              />\n            </Field>\n          )}\n          <Modal.ButtonRow>\n            <Button onClick={onGenerateToken} disabled={isWithExpirationDate && !isExpirationDateValid}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.generate-token\">Generate token</Trans>\n            </Button>\n          </Modal.ButtonRow>\n        </div>\n      ) : (\n        <>\n          <Field\n            label={t('serviceaccounts.create-token-modal.label-token', 'Token')}\n            description={t(\n              'serviceaccounts.create-token-modal.description-token',\n              'Copy the token now as you will not be able to see it again. Losing a token requires creating a new one.'\n            )}\n          >\n            <div className={styles.modalTokenRow}>\n              <Input name=\"tokenValue\" value={token} readOnly />\n              <ClipboardButton\n                className={styles.modalCopyToClipboardButton}\n                variant=\"primary\"\n                size=\"md\"\n                icon=\"copy\"\n                getText={() => token}\n              >\n                <Trans i18nKey=\"serviceaccounts.create-token-modal.copy-clipboard\">Copy to clipboard</Trans>\n              </ClipboardButton>\n            </div>\n          </Field>\n          <Modal.ButtonRow>\n            <ClipboardButton variant=\"primary\" getText={() => token} onClipboardCopy={onCloseInternal}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.copy-to-clipboard-and-close\">\n                Copy to clipboard and close\n              </Trans>\n            </ClipboardButton>\n            <Button variant=\"secondary\" onClick={onCloseInternal}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.close\">Close</Trans>\n            </Button>\n          </Modal.ButtonRow>\n        </>\n      )}\n    </Modal>\n  );\n};\n\nconst getSecondsToLive = (date: Date | string) => {\n  const dateAsDate = new Date(date);\n  const now = new Date();\n\n  return Math.ceil((dateAsDate.getTime() - now.getTime()) / 1000);\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    modal: css({\n      width: '550px',\n    }),\n    modalTokenRow: css({\n      display: 'flex',\n    }),\n    modalCopyToClipboardButton: css({\n      marginLeft: theme.spacing(0.5),\n    }),\n  };\n};\n","import { debounce } from 'lodash';\n\nimport { getBackendSrv } from '@grafana/runtime';\nimport { fetchRoleOptions } from 'app/core/components/RolePicker/api';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AccessControlAction, ServiceAccountDTO, ServiceAccountStateFilter, ThunkResult } from 'app/types';\n\nimport { ServiceAccountToken } from '../components/CreateTokenModal';\n\nimport {\n  acOptionsLoaded,\n  pageChanged,\n  queryChanged,\n  rolesFetchBegin,\n  rolesFetchEnd,\n  serviceAccountsFetchBegin,\n  serviceAccountsFetched,\n  serviceAccountsFetchEnd,\n  stateFilterChanged,\n} from './reducers';\n\nconst BASE_URL = `/api/serviceaccounts`;\n\nexport function fetchACOptions(): ThunkResult<void> {\n  return async (dispatch) => {\n    try {\n      if (contextSrv.licensedAccessControlEnabled() && contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n        const options = await fetchRoleOptions();\n        dispatch(acOptionsLoaded(options));\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n}\n\ninterface FetchServiceAccountsParams {\n  withLoadingIndicator: boolean;\n}\n\nexport function fetchServiceAccounts(\n  { withLoadingIndicator }: FetchServiceAccountsParams = { withLoadingIndicator: false }\n): ThunkResult<void> {\n  return async (dispatch, getState) => {\n    try {\n      if (contextSrv.hasPermission(AccessControlAction.ServiceAccountsRead)) {\n        if (withLoadingIndicator) {\n          dispatch(serviceAccountsFetchBegin());\n        }\n        const { perPage, page, query, serviceAccountStateFilter } = getState().serviceAccounts;\n        const result = await getBackendSrv().get(\n          `/api/serviceaccounts/search?perpage=${perPage}&page=${page}&query=${query}${getStateFilter(\n            serviceAccountStateFilter\n          )}&accesscontrol=true`\n        );\n\n        if (\n          contextSrv.licensedAccessControlEnabled() &&\n          contextSrv.hasPermission(AccessControlAction.ActionUserRolesList)\n        ) {\n          dispatch(rolesFetchBegin());\n          const orgId = contextSrv.user.orgId;\n          const userIds = result?.serviceAccounts.map((u: ServiceAccountDTO) => u.id);\n          const roles = await getBackendSrv().post(`/api/access-control/users/roles/search`, { userIds, orgId });\n          result.serviceAccounts.forEach((u: ServiceAccountDTO) => {\n            u.roles = roles ? roles[u.id] || [] : [];\n          });\n          dispatch(rolesFetchEnd());\n        }\n\n        dispatch(serviceAccountsFetched(result));\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      dispatch(serviceAccountsFetchEnd());\n    }\n  };\n}\n\nconst fetchServiceAccountsWithDebounce = debounce((dispatch) => dispatch(fetchServiceAccounts()), 500, {\n  leading: true,\n});\n\nexport function updateServiceAccount(serviceAccount: ServiceAccountDTO): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`${BASE_URL}/${serviceAccount.uid}?accesscontrol=true`, {\n      ...serviceAccount,\n    });\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function deleteServiceAccount(serviceAccountUid: string): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`${BASE_URL}/${serviceAccountUid}`);\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function createServiceAccountToken(\n  saUid: string,\n  token: ServiceAccountToken,\n  onTokenCreated: (key: string) => void\n): ThunkResult<void> {\n  return async (dispatch) => {\n    const result = await getBackendSrv().post(`${BASE_URL}/${saUid}/tokens`, token);\n    onTokenCreated(result.key);\n    dispatch(fetchServiceAccounts());\n  };\n}\n\n// search / filtering of serviceAccounts\nconst getStateFilter = (value: ServiceAccountStateFilter) => {\n  switch (value) {\n    case ServiceAccountStateFilter.WithExpiredTokens:\n      return '&expiredTokens=true';\n    case ServiceAccountStateFilter.Disabled:\n      return '&disabled=true';\n    case ServiceAccountStateFilter.External:\n      return '&external=true';\n    default:\n      return '';\n  }\n};\n\nexport function changeQuery(query: string): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(queryChanged(query));\n    fetchServiceAccountsWithDebounce(dispatch);\n  };\n}\n\nexport function changeStateFilter(filter: ServiceAccountStateFilter): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(stateFilterChanged(filter));\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function changePage(page: number): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(pageChanged(page));\n    dispatch(fetchServiceAccounts());\n  };\n}\n"],"names":["UserRolePicker","basicRole","roles","userId","orgId","onBasicRoleChange","roleOptions","disabled","basicRoleDisabled","basicRoleDisabledMessage","apply","onApplyRoles","pendingRoles","maxWidth","width","isLoading","loading","appliedRoles","getUserRoles","onRolesChange","canUpdateRoles","options","r","OrgRolePicker","value","onChange","ariaLabel","inputId","autoFocus","restProps","val","ServiceAccountPermissions","props","canSetPermissions","ServiceAccountProfileRow","label","inputType","inputElem","inputValue","setInputValue","isEditing","setIsEditing","styles","getStyles","focusInput","onEditClick","onCancelClick","onInputChange","event","status","onInputBlur","onSave","Label","ConfirmButton","theme","ServiceAccountRoleRow","serviceAccount","onRoleChange","canUpdateRole","ServiceAccountProfile","timeZone","ableToWrite","setRoleOptions","role","onNameChange","newValue","fetchOptions","TextLink","ServiceAccountTokensTable","tokens","tokenActionsDisabled","onDelete","key","TokenExpiration","formatDate","formatLastUsedAtDate","TokenRevoked","DeleteButton","lastUsedAt","expiration","formatSecondsLeftUntilExpiration","secondsUntilExpiration","days","Tooltip","Icon","token","hasExpired","BASE_URL","loadServiceAccount","saUid","dispatch","response","accessControl","error","updateServiceAccount","deleteServiceAccount","serviceAccountUid","createServiceAccountToken","onTokenCreated","result","loadServiceAccountTokens","deleteServiceAccountToken","id","mapStateToProps","state","mapDispatchToProps","connector","ServiceAccountPageUnconnected","timezone","newToken","setNewToken","isTokenModalOpen","setIsTokenModalOpen","isDeleteModalOpen","setIsDeleteModalOpen","isDisableModalOpen","setIsDisableModalOpen","canReadPermissions","pageNav","onProfileChange","showDeleteServiceAccountModal","show","showDisableServiceAccountModal","handleServiceAccountDelete","handleServiceAccountDisable","handleServiceAccountEnable","onDeleteServiceAccountToken","onCreateToken","onTokenModalClose","Page","Stack","Button","IconButton","ConfirmModal","CreateTokenModal","EXPIRATION_OPTIONS","isOpen","serviceAccountLogin","onClose","tomorrow","maxExpirationDate","defaultExpirationDate","defaultTokenName","setDefaultTokenName","newTokenName","setNewTokenName","isWithExpirationDate","setIsWithExpirationDate","newTokenExpirationDate","setNewTokenExpirationDate","isExpirationDateValid","setIsExpirationDateValid","onExpirationDateChange","onGenerateToken","getSecondsToLive","onCloseInternal","modalTitle","e","date","dateAsDate","now","fetchACOptions","fetchServiceAccounts","withLoadingIndicator","getState","perPage","page","query","serviceAccountStateFilter","getStateFilter","userIds","u","fetchServiceAccountsWithDebounce","changeQuery","changeStateFilter","filter","changePage"],"sourceRoot":""}