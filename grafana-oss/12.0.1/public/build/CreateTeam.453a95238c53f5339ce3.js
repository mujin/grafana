"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5436],{99929:(p,P,e)=>{e.d(P,{Y:()=>m});var s=e(74848),R=e(96540),A=e(41053),l=e(73427),_=e(96673),M=e(59812),i=e(12037);const m=({teamId:E,roleOptions:r,disabled:o,roles:n,onApplyRoles:c,pendingRoles:a,apply:t=!1,maxWidth:O,width:v,isLoading:T})=>{const[{loading:u,value:f=n||[]},d]=(0,A.A)(async()=>{try{if(n)return n;if(t&&a?.length)return a;if(l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesList)&&E>0)return await(0,i.xN)(E)}catch(D){console.error("Error loading options",D)}return[]},[E,a,n]);(0,R.useEffect)(()=>{d()},[d]);const I=async D=>{t?c&&c(D):(await(0,i.G3)(D,E),await d())},h=l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesAdd)&&l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesRemove);return(0,s.jsx)(M.n,{apply:t,onRolesChange:I,roleOptions:r,appliedRoles:f,isLoading:u||T,disabled:o,basicRoleDisabled:!0,canUpdateRoles:h,maxWidth:O,width:v})}},99686:(p,P,e)=>{e.d(P,{o:()=>m});var s=e(2543),R=e.n(s),A=e(96540),l=e(24705),_=e(73427),M=e(96673),i=e(12037);const m=r=>{const[o,n]=(0,A.useState)(r),{value:c=[]}=(0,l.A)(async()=>_.TP.licensedAccessControlEnabled()&&_.TP.hasPermission(M.AccessControlAction.ActionRolesList)?(0,i.RL)(o):Promise.resolve([]),[o]);return[{roleOptions:c},n]},E=r=>{const[o,n]=useState({});return useDeepCompareEffect(()=>{if(!contextSrv.licensedAccessControlEnabled()||!contextSrv.hasPermission(AccessControlAction.ActionRolesList))return;const c=Object.keys(o).map(t=>typeof t=="number"?t:parseInt(t,10)),a=difference(r,c);Promise.all(a.map(t=>fetchRoleOptions(t).then(O=>[t,O]))).then(t=>{n({...o,...Object.fromEntries(t)})})},[r]),o}},84974:(p,P,e)=>{e.r(P),e.d(P,{CreateTeam:()=>T,default:()=>u});var s=e(74848),R=e(96540),A=e(49785),l=e(68143),_=e(36490),M=e(16780),i=e(37386),m=e(63527),E=e(45861),r=e(13791),o=e(99929),n=e(12037),c=e(99686),a=e(73427),t=e(56840),O=e(96673);const v={icon:"users-alt",id:"team-new",text:"New team",subTitle:"Create a new team. Teams let you grant permissions to a group of users."},T=()=>{const f=a.TP.user.orgId,[d,I]=(0,R.useState)([]),[{roleOptions:h}]=(0,c.o)(f),{handleSubmit:D,register:L,formState:{errors:U}}=(0,A.mN)(),W=a.TP.hasPermission(O.AccessControlAction.ActionUserRolesAdd)&&a.TP.hasPermission(O.AccessControlAction.ActionUserRolesRemove),B=async K=>{const C=await(0,l.AI)().post("/api/teams",K);if(C.teamId){try{await a.TP.fetchUserPermissions(),a.TP.licensedAccessControlEnabled()&&W&&await(0,n.G3)(d,C.teamId,C.orgId)}catch(g){console.error(g)}_.Ny.push(`/org/teams/edit/${C.uid}`)}};return(0,s.jsx)(r.Y,{navId:"teams",pageNav:v,children:(0,s.jsx)(r.Y.Contents,{children:(0,s.jsxs)("form",{onSubmit:D(B),style:{maxWidth:"600px"},children:[(0,s.jsxs)(M.n,{children:[(0,s.jsx)(i.D,{label:(0,t.t)("teams.create-team.label-name","Name"),required:!0,invalid:!!U.name,error:"Team name is required",children:(0,s.jsx)(m.p,{...L("name",{required:!0}),id:"team-name"})}),a.TP.licensedAccessControlEnabled()&&(0,s.jsx)(i.D,{label:(0,t.t)("teams.create-team.label-role","Role"),children:(0,s.jsx)(o.Y,{teamId:0,roleOptions:h,disabled:!1,apply:!0,onApplyRoles:I,pendingRoles:d,maxWidth:"100%"})}),(0,s.jsx)(i.D,{label:(0,t.t)("teams.create-team.label-email","Email"),description:(0,t.t)("teams.create-team.description-email","This is optional and is primarily used for allowing custom team avatars"),children:(0,s.jsx)(m.p,{...L("email"),type:"email",id:"team-email",placeholder:"email@test.com"})})]}),(0,s.jsx)(E.$n,{type:"submit",variant:"primary",children:(0,s.jsx)(t.x6,{i18nKey:"teams.create-team.create",children:"Create"})})]})})})},u=T}}]);

//# sourceMappingURL=CreateTeam.453a95238c53f5339ce3.js.map