{"version":3,"file":"7011.ecaf905b10e6ea2d2583.js","mappings":"0JAWO,MAAMA,EAAoB,CAAC,CAAE,SAAAC,EAAU,UAAAC,CAAU,IAAa,CACnE,MAAMC,KAAS,MAAWC,CAAS,EAEnC,SAAO,OAAC,OAAI,aAAW,MAAGD,EAAO,QAASD,CAAS,EAAI,SAAAD,CAAA,CAAS,CAClE,EAEMG,EAAaC,IAA0B,CAC3C,WAAS,OAAI,CACX,QAAS,OACT,cAAe,SACf,SAAUA,EAAM,WAAW,UAAU,QACvC,CAAC,CACH,E,oFCMO,SAASC,EAA4B,CAC1C,cAAAC,EACA,SAAAC,EACA,gBAAAC,EAAkB,GAClB,sBAAAC,EACA,SAAAT,EACA,WAAAU,GAAa,WACb,SAAAC,EAAW,IACX,GAAGC,CACL,EAAiB,CACf,KAAM,CAAE,aAAAC,EAAc,QAAAC,EAAS,UAAAC,EAAW,GAAGC,CAAK,KAAI,MAAW,CAC/D,KAAMN,GACN,cAAAJ,CACF,CAAC,EAED,sBAAU,IAAM,CACVE,GACFM,EAAQL,CAAqB,CAEjC,EAAG,CAACK,EAASL,EAAuBD,CAAe,CAAC,KAGlD,OAAC,QACC,aAAW,OAAI,CACb,SAAUG,IAAa,OAASA,EAAW,KAAOA,EAClD,MAAO,MACT,CAAC,EACD,SAAUE,EAAaN,CAAQ,EAC9B,GAAGK,EAEH,SAAAZ,EAAS,CAAE,OAAQe,EAAU,OAAQ,UAAAA,EAAW,QAAAD,EAAS,GAAGE,CAAK,CAAC,EACrE,CAEJ,C,4VCvCO,MAAMC,GAAoB,CAAC,CAAE,SAAAC,EAAU,QAAAC,EAAS,QAAAC,EAAS,SAAAC,EAAU,GAAGC,CAAW,IAAa,CACnG,MAAMpB,KAAS,MAAWC,EAAS,EAC7B,CAAE,mBAAAoB,EAAoB,mBAAAC,EAAmB,KAAI,MAAgB,EAE7DC,KAAe,UAAO,IAAI,KAEhCC,EAAA,GAAaD,EAAcL,CAAO,EAElC,KAAM,CAACO,EAAuBC,CAAgB,KAAIC,EAAA,GAAW,MAAOC,GAAkC,CACpG,MAAMC,EAAS,MAAMR,EAAoBO,CAAK,EAC9C,OAAAV,EAAQ,EACDW,CACT,CAAC,EAEK,CAACC,GAAuBC,CAAgB,KAAIJ,EAAA,GAAW,MAAOC,GAAkC,CACpG,MAAMC,EAAS,MAAMP,GAAoBM,CAAK,EAC9C,OAAAV,EAAQ,EACDW,CACT,CAAC,EAEKG,EAAiBC,MACrB,MAAeA,EAAO,CACpB,OAAQ,KAAkB,SAC1B,SAAAd,CACF,CAAC,EAEGe,EAAuBlB,EAAS,KAAKC,CAAO,GAAK,KACjDkB,GAAqBnB,EAAS,WAAWC,CAAO,EAChDmB,GAAYF,EAAuBH,EAAmBL,EACtDW,EAAiBH,EAAuBJ,GAAwBL,EAChEa,EAAOH,GACT,GAAGH,EAAchB,EAAS,KAAKC,CAAO,CAAC,CAAC,MAAMe,EAAchB,EAAS,QAAQC,CAAO,CAAC,CAAC,GACtFe,EAAchB,EAAS,KAAKC,CAAO,CAAC,EAElCZ,EAAW,CAAC,CAAE,KAAAkC,EAAM,YAAAC,CAAY,IAA6B,CACjEJ,GAAU,CACR,GAAIpB,EAAS,KAAKC,CAAO,GAAK,OAC9B,KAAAsB,EACA,YAAAC,EACA,KAAM,KAAK,MAAMxB,EAAS,KAAKC,CAAO,CAAE,EACxC,GAAI,KAAK,MAAMD,EAAS,UAAUC,CAAO,GAAKD,EAAS,KAAKC,CAAO,CAAE,CACvE,CAAC,CACH,EAGA,SACE,QAAC,OAAI,IAAKM,EAAc,UAAWvB,EAAO,OAAS,GAAGoB,EACpD,oBAAC,OAAI,UAAWpB,EAAO,OACrB,oBAACyC,EAAA,EAAK,CAAC,eAAgB,gBAAiB,WAAY,SAClD,oBAAC,OAAK,SAAAP,EAAuB,kBAAoB,iBAAiB,KAClE,OAAC,OAAK,SAAAI,CAAA,CAAK,GACb,EACF,KACA,OAACnC,GAAA,GACC,SAAAE,EACA,cAAe,CAAE,YAAaW,EAAS,OAAOC,CAAO,EAAG,KAAMD,EAAS,OAAOC,CAAO,GAAK,CAAC,CAAE,EAE5F,UAAC,CAAE,SAAAyB,EAAU,OAAAC,EAAQ,QAAAC,CAAQ,OAE1B,oBACE,qBAAC,OAAI,UAAW5C,EAAO,QACrB,oBAAC6C,EAAA,EAAK,CAAC,MAAO,cAAe,QAAS,CAAC,CAACF,EAAO,YAAa,MAAOA,GAAQ,aAAa,QACtF,mBAACG,EAAA,GACC,UAAW9C,EAAO,SACjB,GAAG0C,EAAS,cAAe,CAC1B,SAAU,oCACZ,CAAC,EACH,EACF,KACA,OAACG,EAAA,EAAK,CAAC,MAAO,OACZ,mBAAC,MACC,QAAAD,EACA,KAAK,OACL,OAAQ,CAAC,CAAE,MAAO,CAAE,IAAAG,EAAK,SAAAC,EAAU,GAAGC,CAAM,CAAE,OAE1C,OAACC,GAAA,GACC,iBAAgB,GAChB,YAAY,WACZ,SAAAF,EACA,WAAY,MACZ,KAAMC,EAAM,MACd,CAEJ,CACF,EACF,GACF,KACA,OAAC,OAAI,UAAWjD,EAAO,OACrB,oBAACyC,EAAA,EAAK,CAAC,eAAgB,WACrB,oBAACU,EAAA,GAAM,CAAC,KAAM,KAAM,QAAQ,YAAY,QAASjC,EAAS,KAAK,UAAU,kBAEzE,KACA,OAACiC,EAAA,GAAM,CAAC,KAAM,KAAM,KAAM,SAAU,SAAUd,GAAgB,QAC3D,SAAAA,GAAgB,QAAU,SAAW,OACxC,GACF,EACF,GACF,CAEJ,CACF,GACF,CAEJ,EAEMpC,GAAaC,IACV,CACL,UAAQ,OAAI,CACV,WAAYA,EAAM,OAAO,WAAW,SACpC,OAAQ,aAAaA,EAAM,OAAO,OAAO,IAAI,GAC7C,aAAcA,EAAM,MAAM,OAAO,QACjC,UAAWA,EAAM,QAAQ,GACzB,WAAY,OACZ,MAAO,OACT,CAAC,EACD,WAAS,OAAI,CACX,QAASA,EAAM,QAAQ,CAAC,CAC1B,CAAC,EACD,UAAQ,OAAI,CACV,aAAc,aAAaA,EAAM,OAAO,OAAO,IAAI,GACnD,QAASA,EAAM,QAAQ,GAAK,CAAC,EAC7B,WAAYA,EAAM,WAAW,eAC7B,SAAUA,EAAM,WAAW,SAC3B,MAAOA,EAAM,OAAO,KAAK,OAC3B,CAAC,EACD,UAAQ,OAAI,CACV,UAAW,aAAaA,EAAM,OAAO,OAAO,IAAI,GAChD,QAASA,EAAM,QAAQ,EAAG,CAAC,CAC7B,CAAC,EACD,YAAU,OAAI,CACZ,MAAOA,EAAM,OAAO,KAAK,UACzB,SAAUA,EAAM,WAAW,UAAU,QACvC,CAAC,CACH,G,6DC9IF,MAAMkD,GAAW,IAAM,GAEVC,GAAqB,CAAC,CAAE,SAAArC,EAAU,QAAAC,EAAS,SAAAE,EAAU,OAAAmC,CAAO,IAAa,CACpF,MAAMC,EAASvC,EAAS,KAAKC,CAAO,EAE9BjB,KAAS,MAAW,EAAS,EAE7B,CAAE,mBAAAwD,EAAqBJ,GAAU,qBAAAK,GAAuBL,GAAU,mBAAAM,CAAmB,KAAI,MAAgB,EAEzGC,EAAe3C,EAAS,eAAeC,CAAO,EAG9C2C,EAAUL,IAAW,GAAKC,EAAmBG,CAAY,EACzDE,GAAYN,IAAW,GAAKE,GAAqBE,CAAY,GAAKD,GAAsB,KAExF1B,EAAiBC,MACrB,MAAeA,EAAO,CACpB,OAAQ,KAAkB,SAC1B,SAAAd,CACF,CAAC,EAEH,IAAImB,EAAON,EAAchB,EAAS,KAAKC,CAAO,CAAC,EAC3C6C,EAAO9C,EAAS,OAAOC,CAAO,GAAK,GAEnCD,EAAS,WAAWC,CAAO,IAC7BqB,GAAQ,MAAQN,EAAchB,EAAS,QAAQC,CAAO,CAAC,GAGzD,IAAI8C,GACA/C,EAAS,QAAQC,CAAO,GAAKD,EAAS,YAAYC,CAAO,IAC3D8C,MAAS,OAAC,OAAI,UAAW/D,EAAO,OAAQ,IAAI,oBAAoB,IAAKgB,EAAS,UAAUC,CAAO,EAAG,GAGpG,IAAI+C,GAAgC,KAChCC,EAAY,GAEhB,GAAIjD,EAAS,UAAUC,CAAO,IAAM,QAAaD,EAAS,WAAWC,CAAO,EAAG,CAC7E,MAAMiD,EAAaC,GAAA,EAAS,qBAAqBnD,EAAS,SAASC,CAAO,CAAC,EAC3E+C,MACE,OAAC,OAAI,UAAWhE,EAAO,WACrB,mBAAC,KAAE,UAAWkE,EAAW,WAAa,SAAAA,EAAW,KAAK,EACxD,EAGFD,EAAYjD,EAAS,OAAOC,CAAO,EAAIkD,GAAA,EAAS,uBAAuBnD,EAAS,KAAKC,CAAO,CAAC,EAAI,EACnG,MAAWD,EAAS,QAAQC,CAAO,IACjC6C,EAAO9C,EAAS,MAAMC,CAAO,GAAK6C,EAAO,SAASA,CAAI,GAAK,KAG7D,SACE,QAAC,OAAI,UAAW9D,EAAO,QACrB,oBAAC,OAAI,UAAWA,EAAO,OACrB,oBAAC,MAAe,CAAC,QAAS,gBAAiB,MAAO,SAAU,QAAS,KACnE,qBAAC,OAAI,UAAWA,EAAO,KACrB,qBAAC,QACE,UAAA+D,GACAC,EAAA,EACH,EACC1B,CAAA,EACH,GACEsB,GAAWC,QACX,QAAC,OAAI,UAAW7D,EAAO,aACpB,UAAA4D,MAAW,OAACQ,GAAA,EAAU,CAAC,KAAM,MAAO,KAAM,KAAM,QAASd,EAAQ,QAAQ,MAAO,GAChFO,OACC,OAACO,GAAA,GACC,KAAM,YACN,KAAM,KACN,QAAS,IAAMV,EAAmBH,CAAM,EACxC,QAAQ,SACV,GAEJ,GAEJ,EACF,KAEA,QAAC,OAAI,UAAWvD,EAAO,KACpB,UAAA8D,MAAQ,OAAC,OAAI,UAAW9D,EAAO,KAAM,wBAAyB,CAAE,OAAQ,KAAS,SAAS8D,CAAI,CAAE,EAAG,EACnGG,KACD,OAAC,OACC,mBAAC,MAAe,CAAC,QAAQ,KAAK,KAAI,GAC/B,SAAAjD,EAAS,OAAOC,CAAO,GAAG,IAAI,CAACoD,EAAWC,OAAc,OAACC,EAAA,EAAG,CAAC,KAAMF,CAAA,EAAQ,GAAGA,CAAC,IAAIC,CAAC,EAAI,CAAE,EAC7F,EACF,GACF,GACF,CAEJ,EAEM,GAAapE,IAA0B,CAC3C,WAAS,OAAI,CACX,OAAQA,EAAM,OAAO,QACrB,WAAY,UACZ,aAAcA,EAAM,MAAM,OAAO,QACjC,WAAYA,EAAM,OAAO,WAAW,SACpC,OAAQ,aAAaA,EAAM,OAAO,OAAO,IAAI,GAC7C,UAAWA,EAAM,QAAQ,GACzB,WAAY,MACd,CAAC,EACD,UAAQ,OAAI,CACV,QAASA,EAAM,QAAQ,GAAK,CAAC,EAC7B,aAAc,aAAaA,EAAM,OAAO,OAAO,IAAI,GACnD,WAAYA,EAAM,WAAW,eAC7B,SAAUA,EAAM,WAAW,SAC3B,MAAOA,EAAM,OAAO,KAAK,QACzB,QAAS,MACX,CAAC,EACD,QAAM,OAAI,CACR,QAAS,OACT,eAAgB,gBAChB,MAAOA,EAAM,OAAO,KAAK,QACzB,WAAY,GACd,CAAC,EACD,gBAAc,OAAI,CAChB,QAAS,OACT,WAAY,SACZ,gBAAiB,CACf,WAAY,CACd,CACF,CAAC,EACD,QAAM,OAAI,CACR,QAASA,EAAM,QAAQ,CAAC,EACxB,SAAUA,EAAM,WAAW,UAAU,SACrC,MAAOA,EAAM,OAAO,KAAK,UACzB,WAAY,IACZ,EAAG,CACD,MAAOA,EAAM,OAAO,KAAK,KACzB,UAAW,CACT,eAAgB,WAClB,CACF,CACF,CAAC,EACD,QAAM,OAAI,CACR,cAAeA,EAAM,QAAQ,CAAC,CAChC,CAAC,EACD,UAAQ,OAAI,CACV,aAAcA,EAAM,MAAM,OAAO,OACjC,MAAO,GACP,OAAQ,GACR,YAAaA,EAAM,QAAQ,CAAC,CAC9B,CAAC,EACD,cAAY,OAAI,CACd,aAAcA,EAAM,QAAQ,CAAC,EAC7B,WAAYA,EAAM,WAAW,gBAC/B,CAAC,CACH,GCtIMsE,GAAgB,EAChBC,GAAgB,EAChBC,GAAgB,EAETC,GAAoB,CAAC,CAChC,SAAA3D,EACA,QAAAC,EACA,UAAAlB,EACA,MAAA6E,EACA,YAAAC,EACA,SAAA1D,EACA,WAAA2D,CACF,IAAoB,CAClB,MAAM9E,MAAS,MAAW,EAAS,EAE7B,CAACgE,EAAOe,CAAQ,KAAI,YAASF,GAAe,KAAOJ,GAAgBD,EAAa,EAChF,CAAE,KAAAQ,EAAM,eAAAC,EAAe,KAAI,MAAY,CAC3C,KAAM,GACN,UAAW,SACX,WAAY,IACV,MAAK,CACH,0BAA2B,MAE3B,UAAW,GACX,SAAU,SAAS,IACrB,CAAC,KACD,MAAM,CACR,EACA,qBAAsB,KACtB,SAAU,OACZ,CAAC,EAEKC,EACJlB,IAAUU,MACR,OAACrB,GAAA,CACC,QAAApC,EACA,SAAAD,EACA,SAAAG,EACA,OAAQ,IAAM4D,EAASN,EAAa,EACtC,EACET,IAAUS,MACZ,OAAC1D,GAAA,CACC,QAAAE,EACA,SAAAD,EACA,SAAAG,EACA,QAAS,IAAM,CACb0D,IAAc,EACdE,EAASP,EAAa,CACxB,EACF,EACE,KAEN,SACE,OAAC,OACC,IAAKQ,EAAK,aACV,UAAAjF,EACA,MAAA6E,EACA,aAAc,IAAMZ,IAAUS,IAAiBM,EAASL,EAAa,EACrE,aAAc,IAAMV,IAAUS,IAAiBM,EAASP,EAAa,EACrE,cAAaW,EAAA,GAAU,MAAM,UAAU,YAAY,OAElD,SAAAD,MACC,mBACE,OAAC,OAAI,IAAKF,EAAK,YAAa,UAAWhF,GAAO,QAAS,MAAOiF,GAAgB,cAAY,oBACvF,SAAAC,CAAA,CACH,EACAJ,CACF,EACJ,CAEJ,EAEM,GAAa5E,IAA0B,CAE3C,WAAS,OAAI,CACX,IAAK,EACL,KAAM,EACN,OAAQA,EAAM,OAAO,QACrB,aAAcA,EAAM,MAAM,OAAO,QACjC,SAAU,WACV,WAAYA,EAAM,OAAO,WAAW,QACpC,OAAQ,aAAaA,EAAM,OAAO,OAAO,IAAI,GAC7C,UAAWA,EAAM,QAAQ,GACzB,WAAY,OACZ,SAAU,OACZ,CAAC,CACH,GClFMkF,GAAa,CAACC,EAA+BC,EAAYC,EAAYC,EAAWC,IAAkB,CACtGJ,EAAI,UAAU,EACdA,EAAI,OAAOG,EAAGF,CAAE,EAChBD,EAAI,OAAOG,EAAGD,CAAE,EAChBF,EAAI,YAAcI,EAClBJ,EAAI,OAAO,CACb,EAYMK,MAAgCC,EAAA,GAAU,IAAwB,EAAE,aAAa,EAEvF,SAASC,GAAQC,EAAkB,CACjC,IAAIC,EAA8B,CAAC,EACnC,OAAAD,EAAM,OAAO,QAASE,GAAM,CAC1BD,EAAKC,EAAE,IAAI,EAAIA,EAAE,MACnB,CAAC,EAEMD,CACT,CAEO,MAAME,GAAqB,CAAC,CACjC,YAAAC,EACA,SAAA9E,EACA,OAAA+E,EACA,SAAAC,EACA,YAAAC,EACA,sBAAAC,EAAwB,EAC1B,IAA8B,CAC5B,KAAM,CAACC,EAAMC,EAAO,KAAI,YAAgB,EAElC,CAACzB,CAAU,KAAI,YAAS,OAAM,OAAmB,CAAC,EAElD9E,KAAS,MAAW,EAAS,EAC7BwG,KAAiB,MAAU,EAAE,cAAc,eAE3C,CAACC,GAAGC,CAAW,KAAI,cAAYlB,GAAMA,EAAI,EAAG,CAAC,EAE7CmB,KAAQ,WAAQ,IAAM,CAC1B,IAAIA,EAAQV,EAAY,OACrBJ,GAAUA,EAAM,OAAS,YAAcA,EAAM,OAAS,GAAKA,EAAM,OAAO,KAAME,GAAMA,EAAE,OAAS,MAAM,CACxG,EAEA,GAAII,EAAU,CACZ,IAAIS,EAAWT,EAAS,GAAKA,EAAS,KAEtC,MAAMU,KAAe,KAAiB,CACpC,CACE,KAAMV,EAAS,KACf,QAASS,EAAWT,EAAS,GAAK,KAClC,SAAAS,EACA,MAAOlB,EACT,CACF,CAAC,EAEDmB,EAAa,KAAO,CAClB,UAAW,KAAU,YACrB,OAAQ,CACN,MAAO,EACT,CACF,EAEAF,EAAM,KAAKE,CAAY,CACzB,CAEA,OAAOF,CACT,EAAG,CAACV,EAAaE,CAAQ,CAAC,EAEpBtB,KAAc,eAAY,IAAM,CACpCuB,EAAY,IAAI,CAClB,EAAG,CAACA,CAAW,CAAC,EAEVU,MAAU,UAAOH,CAAK,EAC5BG,GAAQ,QAAUH,EAClB,MAAMI,MAAc,UAAOZ,CAAQ,EACnCY,GAAY,QAAUZ,EAEtB,MAAMa,KAAW,UAAuB,EAiGxC,MA/FA,mBAAgB,IAAM,CACpBd,EAAO,QAAQ,QAAUe,GAAM,CAC7B,IAAIC,EAAUD,EAAE,KAAK,cAA8B,SAAS,EAC5DD,EAAS,QAAUE,EACnBX,GAAQU,CAAC,CACX,CAAC,EAEDf,EAAO,QAAQ,OAASe,GAAM,CAC5B,IAAIN,EAAQG,GAAQ,QAEpB,MAAMzB,EAAM4B,EAAE,IAEd5B,EAAI,KAAK,EAETA,EAAI,UAAU,EACdA,EAAI,KAAK4B,EAAE,KAAK,KAAMA,EAAE,KAAK,IAAKA,EAAE,KAAK,MAAOA,EAAE,KAAK,MAAM,EAC7D5B,EAAI,KAAK,EAETsB,EAAM,QAASd,GAAU,CACvB,IAAIC,EAAOF,GAAQC,CAAK,EAExB,GAAIA,EAAM,OAAS,SAAU,CAG3B,IAAIsB,EAAOjB,EAAO,OAAO,CAAC,EAAE,MAAM,SAC9BkB,EAAOlB,EAAO,OAAO,CAAC,EAAE,MAAM,SAElC,QAAS,EAAI,EAAG,EAAIL,EAAM,OAAQ,IAAK,CACrC,IAAIJ,EAAQe,EAAeV,EAAK,QAAQ,CAAC,GAAKJ,EAA6B,EAEvE2B,EAAKJ,EAAE,SAASnB,EAAK,KAAK,CAAC,EAAGqB,EAAM,EAAI,EACxCG,EAAKL,EAAE,SAASnB,EAAK,KAAK,CAAC,EAAGqB,EAAM,EAAI,EACxC7B,EAAK2B,EAAE,SAASnB,EAAK,KAAK,CAAC,EAAGsB,EAAM,EAAI,EACxC7B,GAAK0B,EAAE,SAASnB,EAAK,KAAK,CAAC,EAAGsB,EAAM,EAAI,EAE5C/B,EAAI,UAAYkC,EAAA,GAAiB,MAAM9B,EAAOK,EAAK,YAAY,CAAC,CAAC,EACjET,EAAI,SAASgC,EAAI/B,EAAIgC,EAAKD,EAAI9B,GAAKD,CAAE,EAErCD,EAAI,UAAY,KAAK,MAAMS,EAAK,UAAU,CAAC,EAAI,IAAM,OAAO,EAExDA,EAAK,UAAU,CAAC,IAAM,OAExBT,EAAI,YAAY,CAAC,EAAG,CAAC,CAAC,EAGtBA,EAAI,YAAY,CAAC,CAAC,EAGpBA,EAAI,YAAcI,EAClBJ,EAAI,WAAWgC,EAAI/B,EAAIgC,EAAKD,EAAI9B,GAAKD,CAAE,CACzC,CACF,KAAO,CACL,IAAIA,EAAK2B,EAAE,KAAK,IACZ1B,EAAKD,EAAK2B,EAAE,KAAK,OAErB5B,EAAI,UAAY,EAChBA,EAAI,YAAY,CAAC,EAAG,CAAC,CAAC,EAEtB,QAAS,EAAI,EAAG,EAAIS,EAAK,KAAK,OAAQ,IAAK,CACzC,IAAIL,EAAQe,EAAeV,EAAK,QAAQ,CAAC,GAAKJ,EAA6B,EAEvE2B,EAAKJ,EAAE,SAASnB,EAAK,KAAK,CAAC,EAAG,IAAK,EAAI,EAG3C,GAFAV,GAAWC,EAAKC,EAAIC,EAAI8B,EAAI5B,CAAK,EAE7BK,EAAK,WAAW,CAAC,EAAG,CACtB,IAAIwB,EAAKL,EAAE,SAASnB,EAAK,QAAQ,CAAC,EAAG,IAAK,EAAI,EAC9CV,GAAWC,EAAKC,EAAIC,EAAI+B,EAAI7B,CAAK,EAE7BY,IACFhB,EAAI,UAAYkC,EAAA,GAAiB,MAAM9B,EAAO,EAAG,EACjDJ,EAAI,SAASgC,EAAI/B,EAAIgC,EAAKD,EAAIJ,EAAE,KAAK,MAAM,EAE/C,CACF,CACF,CACF,CAAC,EAED5B,EAAI,QAAQ,CACd,CAAC,CACH,EAAG,CAACa,EAAQG,EAAuBG,CAAc,CAAC,KAGlD,aAAU,IAAM,CACVF,IACFA,EAAK,OAAO,EAKZ,WAAW,IAAM,CACfI,EAAY,CACd,EAAG,CAAC,EAER,EAAG,CAACC,EAAOL,CAAI,CAAC,EAEZA,EAAM,CACR,IAAIkB,EAAUb,EAAM,QAAQ,CAACd,EAAO4B,IAAa,CAC/C,IAAI3B,EAAOF,GAAQC,CAAK,EAEpB2B,EAA6B,CAAC,EAElC,QAASlD,EAAI,EAAGA,EAAIwB,EAAK,KAAK,OAAQxB,IAAK,CACzC,IAAImB,EAAQe,EAAeV,EAAK,QAAQxB,CAAC,GAAK,IAAwB,EAClEoD,EAAO,KAAK,MAAMpB,EAAK,SAASR,EAAK,KAAKxB,CAAC,EAAG,GAAG,CAAC,GAAK,EACvDM,EAAoC,KACpC7E,EAAY,GACZ4H,EAAY,GAEhB,GAAI7B,EAAK,WAAWxB,CAAC,EAAG,CACtB,IAAIsD,EAAQ,KAAK,MAAMtB,EAAK,SAASR,EAAK,UAAUxB,CAAC,EAAG,GAAG,CAAC,GAAK,EAIjE,GAFAqD,EAAYD,EAAOpB,EAAK,KAAK,OAASsB,EAAQ,EAE1CD,EAAW,CACb,IAAIE,GAAc,KAAK,IAAI,EAAGH,CAAI,EAC9BI,GAAe,KAAK,IAAIxB,EAAK,KAAK,MAAOsB,CAAK,EAElDhD,EAAQ,CAAE,KAAMiD,GAAa,WAAYpC,EAAO,MAAOqC,GAAeD,EAAY,EAClF9H,EAAYC,EAAO,UACrB,CACF,MACE2H,EAAYD,GAAQ,GAAKA,GAAQpB,EAAK,KAAK,MAEvCqB,IACF/C,EAAQ,CAAE,KAAA8C,EAAM,kBAAmBjC,CAAM,EACzC1F,EAAYC,EAAO,YAKvB,GAAI2H,EAAW,CACb,IAAII,EAAQlC,EAAM,MAAM,QAAQ,MAEhC2B,EAAQ,QACN,OAAC7C,GAAA,CACC,QAASL,EACT,SAAUwB,EACV,UAAA/F,EACA,MAAA6E,EACA,SAAAzD,EAEA,YAAa4G,EAAQlD,EAAc,KACnC,WAAAC,CAAA,EAFK,GAAG2C,CAAQ,IAAInD,CAAC,EAGvB,CACF,CACF,CACF,CAEA,OAAOkD,CACT,CAAC,EAED,SAAO,gBAAaA,EAASR,EAAS,OAAQ,CAChD,CAEA,OAAO,IACT,EAEM,GAAY,KAAO,CACvB,cAAY,OAAI,CACd,SAAU,WACV,MAAO,EACP,OAAQ,EACR,WAAY,wBACZ,YAAa,wBACb,kBAAmB,MACnB,kBAAmB,QACnB,UAAW,mBACX,OAAQ,UACR,OAAQ,CACV,CAAC,EACD,cAAY,OAAI,CACd,SAAU,WACV,OAAQ,MACR,OAAQ,UACR,OAAQ,CACV,CAAC,CACH,E,yECzRO,MAAMgB,EAAqB,CAAC,CAAE,OAAA9B,EAAQ,kBAAA+B,CAAkB,IAAoC,CACjG,MAAMC,KAAe,UAAc,EAC7B,CAACC,EAAYC,CAAa,KAAI,YAAgC,CAAC,CAAC,EAChE,CAACC,EAAWC,EAAY,KAAI,YAA4B,EAiB9D,MAfA,mBAAgB,IAAM,CACpBpC,EAAO,QAAQ,OAASe,GAAM,CAC5BiB,EAAa,QAAUjB,CACzB,CAAC,EAEDf,EAAO,QAAQ,WAAae,GAAM,CAChCmB,EAAcnB,EAAE,OAAO,CAAC,GAAK,CAAC,CAAC,EAC/BqB,GAAarB,EAAE,OAAO,GAAQ,MAAS,CACzC,CAAC,CACH,EAAG,CAACf,CAAM,CAAC,EAEPiC,EAAW,OAAS,GAAK,CAACF,GAI1B,CAACI,GAAa,CAACA,EAAU,MAAQ,CAACA,EAAU,KAAO,CAACA,EAAU,IAChE,OAAO,KAIT,IAAI/D,EAAI,EACNiE,EAAIJ,EAAW,OAAS,EAE1B,KAAO7D,GAAKiE,GAAKJ,EAAW7D,CAAC,GAAK,MAChCA,IAGF,KAAOiE,GAAK,GAAKJ,EAAWI,CAAC,GAAK,MAChCA,IAGF,MAAMC,EAAQL,EAAW7D,CAAC,EACpBmE,EAAON,EAAWI,CAAC,EACnBG,EAAQL,EAAU,IAClBM,EAAMN,EAAU,IAOtB,OALIG,GAAS,MAAQC,GAAQ,MAKzBD,GAASG,GAAOF,GAAQC,EACnB,QAIP,OAAC,OACC,MAAO,CACL,SAAU,WACV,IAAK,MACL,UAAW,mBACX,MAAO,OACP,UAAW,QACb,EAEA,oBAAC,OACC,oBAAC,OAAI,mCAAuB,KAC5B,OAAC,MACC,QAAUE,GAAMX,EAAkB,CAAE,KAAMO,EAAO,GAAIC,CAAK,CAAC,EAC3D,QAAQ,YACR,cAAY,2BACb,wBAED,GACF,EACF,CAEJ,EAEAT,EAAmB,YAAc,oB,oKC/DjC,SAASa,EAAaC,EAAkC,CACtD,IAAIC,EAAyC,IAAI,IA2CjD,OAzC2BD,EAAO,IAAKjD,IAC9B,CACL,GAAGA,EACH,OAAQA,EAAM,OAAO,IAAK5C,GAAU,CAClC,GAAIA,EAAM,OAAS,KAAU,KAAM,CACjC,IAAI+F,KAAW,KAAc/F,EAAM,OAAQA,EAAM,IAAI,EACjDgG,EAAWF,EAAc,IAAIC,CAAQ,EAEpCC,IACHA,EAAW,CAAC,EACZF,EAAc,IAAIC,EAAUC,CAAQ,GAGtC,IAAIC,EAAiBjG,EAAM,OAAO,QAAQ,EAAE,MAAM,EAC9CkG,EAAOlG,EAAM,OAAO,KAAM,KAAM,KAGpC,GAAIgG,EAAS,OAAS,EACpB,QAAS3E,EAAI,EAAGA,EAAI4E,EAAK,OAAQ5E,IAC/B4E,EAAK5E,CAAC,GAAK2E,EAAS,OAIxB,OAAAA,EAAS,KAAK,GAAGE,CAAI,EAGrBlG,EAAM,OAAO,KAAM,KAAM,KAAQgG,EAE1B,CACL,GAAGhG,EACH,OAAQiG,CACV,CAGF,CAEA,OAAOjG,CACT,CAAC,CACH,EACD,CAGH,CAKO,SAASmG,GACdC,EACAnJ,EACAmI,EAEAiB,EACoB,CACpB,GAAI,CAACD,GAAQ,OACX,OAAO,QAGT,MAAuBA,CAAM,EAE7B,IAAIE,EAAcD,GAAgB,KAG9BA,GAAgB,MAAQA,EAAe,IACzCD,EAAS,CACP,CACE,GAAGA,EAAO,CAAC,EACX,OAAQ,CAACA,EAAO,CAAC,EAAE,OAAOC,CAAY,EAAG,GAAGD,EAAO,CAAC,EAAE,OAAO,OAAO,CAACtD,EAAGzB,IAAMA,IAAMgF,CAAY,CAAC,CACnG,CACF,GAMF,QAASzD,KAASwD,EAChB,QAASpG,KAAS4C,EAAM,OAClB5C,EAAM,OAAS,KAAU,MAAQ,OAAOA,EAAM,OAAO,CAAC,GAAM,WAC9DA,EAAM,UAAS,MAAiBA,EAAO,CAAE,gBAAiB,KAAU,IAAK,CAAC,EAAE,QAKlF,IAAIuG,EAAkB,EAEtBC,EAAO,QAAS5D,KAASwD,EACvB,QAASpG,KAAS4C,EAAM,OACtB,GAAI5C,EAAM,OAAS,KAAU,MAAQ,EAAEuG,EAAkB,EAAG,CAC1DH,EAASR,EAAaQ,CAAM,EAC5B,MAAMI,CACR,CAIJ,IAAIC,EAEJ,MAAMZ,EAAsB,CAAC,EAE7B,QAASjD,KAASwD,EAAQ,CACxB,MAAMM,EAAkB,CAAC,EAEzB,IAAIC,GAAe,GACfC,GAAgB,GAEhBC,GAAcP,EACd1D,KACA,KAAyB,CACvB,MAAAA,EACA,kBAAmBwC,GAAW,KAAK,QAAQ,EAC3C,kBAAmBA,GAAW,GAAG,QAAQ,CAC3C,CAAC,EAEL,MAAM0B,MAAc,KAAYD,EAAW,EAAE,OAE7C,QAASE,GAAW,EAAGA,IAAYD,IAAa,QAAU,GAAIC,KAAY,CACxE,MAAM/G,EAAQ8G,GAAYC,EAAQ,EAElC,OAAQ/G,EAAM,KAAM,CAClB,KAAK,KAAU,KACb2G,GAAe,GACfD,EAAO,KAAK1G,CAAK,EACjB,MACF,KAAK,KAAU,OACb4G,GAAgBN,EAAcS,GAAW,EAAI,GAC7CN,EAAO,CACL,GAAGzG,EACH,OAAQA,EAAM,OAAO,IAAK2F,GAClB,OAAO,SAASA,CAAC,GAAKA,GAAK,KAG1BA,EAFE,IAGV,CACH,EAEAe,EAAO,KAAKD,CAAI,EAChB,MACF,KAAK,KAAU,KACbG,GAAgB,GAClB,KAAK,KAAU,OACbH,EAAO,CACL,GAAGzG,EACH,OAAQA,EAAM,MAChB,EAEA0G,EAAO,KAAKD,CAAI,EAChB,MACF,KAAK,KAAU,QACbG,GAAgB,GAChB,MAAMI,GAA2BhH,EAAM,QAAQ,QAAU,CAAC,EACpDiD,GAAS,CACb,GAAGjD,EAAM,OACT,IAAK,EACL,IAAK,EACL,OAAAgH,EACF,EAGIA,GAAO,oBAAsB,KAAkB,aACjDA,GAAO,kBAAoB,KAAkB,WAG/CP,EAAO,CACL,GAAGzG,EACH,OAAAiD,GACA,KAAM,KAAU,OAChB,OAAQjD,EAAM,OAAO,IAAK2F,GACpBA,GAAK,KACAA,EAEMA,EAAK,EAAI,CACzB,CACH,KAEK,MAAc1C,GAAO,IAAI,IAC5BA,GAAO,KAAO,OACdwD,EAAK,WAAU,KAAoB,CAAE,MAAOA,EAAM,MAAAxJ,CAAM,CAAC,GAG3DyJ,EAAO,KAAKD,CAAI,EAChB,KACJ,CACF,EAEKH,GAAeK,KAAiBC,IACnCf,EAAO,KAAK,CACV,GAAGjD,EACH,OAAQiE,GAAY,OACpB,OAAAH,CACF,CAAC,CAEL,CAEA,OAAIb,EAAO,QACToB,EAAsBpB,EAAQ5I,EAAO,CAAC,EACtCiK,EAA4BrB,EAAQ5I,CAAK,EAClC4I,GAGF,IACT,CAEA,MAAMqB,EAA8B,CAACrB,EAAqB5I,IAAyB,CACjF,KAAM,CAAE,QAAAkK,CAAQ,EAAIlK,EAAM,cAC1B,UAAW2F,KAASiD,EAClB,UAAW7F,KAAS4C,EAAM,OACxB,GAAI5C,EAAM,OAAS,KAAU,KAAM,CACjC,MAAMoH,EAAaD,EAAQnH,EAAM,OAAO,YAAemH,EAAQ,MAAM,EAC/DE,EAAWpK,EAAM,cAAc,eAAemK,CAAU,EACxDE,EAAatH,EAAM,OAAO,KAAM,KAEtCsH,EAAW,MAAQ,MAAMA,EAAW,KAAM,MAAM,EAAE,KAAKD,CAAQ,EAC/DrH,EAAM,WAAU,KAAoB,CAAE,MAAAA,EAAO,MAAA/C,CAAM,CAAC,CACtD,CAGN,EAEagK,EAAwB,CAACpB,EAAqB5I,EAAsBsK,IAA0B,CACzG,IAAIC,EAAc,EAClB3B,EAAO,QAASjD,GAAU,CACxBA,EAAM,OAAO,QAAQ,CAAC5C,EAAO+G,IAAa,CAEtCA,IAAaQ,IACZvH,EAAM,OAAS,KAAU,QAAUA,EAAM,OAAS,KAAU,SAAWA,EAAM,OAAS,KAAU,QAEjGA,EAAM,MAAQ,CACZ,GAAGA,EAAM,MACT,YAAawH,GACf,EACAxH,EAAM,WAAU,KAAoB,CAAE,MAAAA,EAAO,MAAA/C,CAAM,CAAC,EAExD,CAAC,CACH,CAAC,CACH,EAEO,SAASwK,EAAaC,EAAiCC,EAAmC,CAC/F,MAAI,CAACD,GAAa,CAACA,EAAU,OACpB,CAACC,CAAe,EAElBD,EAAU,IAAK/B,GAAOA,GAAG,OAASA,EAAIgC,CAAgB,CAC/D,CAEO,MAAMC,EAAuBC,GAC3BA,EAAe,OAAS,KAAmB,OAASA,EAAe,WAAa,I","sources":["webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipWrapper.tsx","webpack://grafana/./public/app/core/components/Form/Form.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/annotations2/AnnotationEditor2.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/annotations2/AnnotationTooltip2.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/annotations2/AnnotationMarker2.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/AnnotationsPlugin2.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/OutsideRangePlugin.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/utils.ts"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport React, { HTMLAttributes } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes';\n\nexport interface Props extends HTMLAttributes<HTMLDivElement> {\n  children?: React.ReactNode;\n}\n\nexport const VizTooltipWrapper = ({ children, className }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  return <div className={cx(styles.wrapper, className)}>{children}</div>;\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontSize: theme.typography.bodySmall.fontSize,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { HTMLProps, useEffect } from 'react';\nimport * as React from 'react';\nimport {\n  useForm,\n  Mode,\n  DefaultValues,\n  SubmitHandler,\n  FieldValues,\n  UseFormReturn,\n  FieldErrors,\n  FieldPath,\n} from 'react-hook-form';\n\nexport type FormAPI<T extends FieldValues> = Omit<UseFormReturn<T>, 'handleSubmit'> & {\n  errors: FieldErrors<T>;\n};\n\ninterface FormProps<T extends FieldValues> extends Omit<HTMLProps<HTMLFormElement>, 'onSubmit' | 'children'> {\n  validateOn?: Mode;\n  validateOnMount?: boolean;\n  validateFieldsOnMount?: FieldPath<T> | Array<FieldPath<T>>;\n  defaultValues?: DefaultValues<T>;\n  onSubmit: SubmitHandler<T>;\n  children: (api: FormAPI<T>) => React.ReactNode;\n  /** Sets max-width for container. Use it instead of setting individual widths on inputs.*/\n  maxWidth?: number | 'none';\n}\n\nexport function Form<T extends FieldValues>({\n  defaultValues,\n  onSubmit,\n  validateOnMount = false,\n  validateFieldsOnMount,\n  children,\n  validateOn = 'onSubmit',\n  maxWidth = 600,\n  ...htmlProps\n}: FormProps<T>) {\n  const { handleSubmit, trigger, formState, ...rest } = useForm<T>({\n    mode: validateOn,\n    defaultValues,\n  });\n\n  useEffect(() => {\n    if (validateOnMount) {\n      trigger(validateFieldsOnMount);\n    }\n  }, [trigger, validateFieldsOnMount, validateOnMount]);\n\n  return (\n    <form\n      className={css({\n        maxWidth: maxWidth !== 'none' ? maxWidth + 'px' : maxWidth,\n        width: '100%',\n      })}\n      onSubmit={handleSubmit(onSubmit)}\n      {...htmlProps}\n    >\n      {children({ errors: formState.errors, formState, trigger, ...rest })}\n    </form>\n  );\n}\n","import { css } from '@emotion/css';\nimport { useRef } from 'react';\nimport { Controller } from 'react-hook-form';\nimport { useAsyncFn, useClickAway } from 'react-use';\n\nimport { AnnotationEventUIModel, GrafanaTheme2, dateTimeFormat, systemDateFormats } from '@grafana/data';\nimport { Button, Field, Stack, TextArea, usePanelContext, useStyles2 } from '@grafana/ui';\nimport { Form } from 'app/core/components/Form/Form';\nimport { TagFilter } from 'app/core/components/TagFilter/TagFilter';\nimport { getAnnotationTags } from 'app/features/annotations/api';\n\ninterface Props {\n  annoVals: Record<string, any[]>;\n  annoIdx: number;\n  timeZone: string;\n  dismiss: () => void;\n}\n\ninterface AnnotationEditFormDTO {\n  description: string;\n  tags: string[];\n}\n\nexport const AnnotationEditor2 = ({ annoVals, annoIdx, dismiss, timeZone, ...otherProps }: Props) => {\n  const styles = useStyles2(getStyles);\n  const { onAnnotationCreate, onAnnotationUpdate } = usePanelContext();\n\n  const clickAwayRef = useRef(null);\n\n  useClickAway(clickAwayRef, dismiss);\n\n  const [createAnnotationState, createAnnotation] = useAsyncFn(async (event: AnnotationEventUIModel) => {\n    const result = await onAnnotationCreate!(event);\n    dismiss();\n    return result;\n  });\n\n  const [updateAnnotationState, updateAnnotation] = useAsyncFn(async (event: AnnotationEventUIModel) => {\n    const result = await onAnnotationUpdate!(event);\n    dismiss();\n    return result;\n  });\n\n  const timeFormatter = (value: number) =>\n    dateTimeFormat(value, {\n      format: systemDateFormats.fullDate,\n      timeZone,\n    });\n\n  const isUpdatingAnnotation = annoVals.id?.[annoIdx] != null;\n  const isRegionAnnotation = annoVals.isRegion?.[annoIdx];\n  const operation = isUpdatingAnnotation ? updateAnnotation : createAnnotation;\n  const stateIndicator = isUpdatingAnnotation ? updateAnnotationState : createAnnotationState;\n  const time = isRegionAnnotation\n    ? `${timeFormatter(annoVals.time[annoIdx])} - ${timeFormatter(annoVals.timeEnd[annoIdx])}`\n    : timeFormatter(annoVals.time[annoIdx]);\n\n  const onSubmit = ({ tags, description }: AnnotationEditFormDTO) => {\n    operation({\n      id: annoVals.id?.[annoIdx] ?? undefined,\n      tags,\n      description,\n      from: Math.round(annoVals.time[annoIdx]!),\n      to: Math.round(annoVals.timeEnd?.[annoIdx] ?? annoVals.time[annoIdx]!),\n    });\n  };\n\n  // Annotation editor\n  return (\n    <div ref={clickAwayRef} className={styles.editor} {...otherProps}>\n      <div className={styles.header}>\n        <Stack justifyContent={'space-between'} alignItems={'center'}>\n          <div>{isUpdatingAnnotation ? 'Edit annotation' : 'Add annotation'}</div>\n          <div>{time}</div>\n        </Stack>\n      </div>\n      <Form<AnnotationEditFormDTO>\n        onSubmit={onSubmit}\n        defaultValues={{ description: annoVals.text?.[annoIdx], tags: annoVals.tags?.[annoIdx] || [] }}\n      >\n        {({ register, errors, control }) => {\n          return (\n            <>\n              <div className={styles.content}>\n                <Field label={'Description'} invalid={!!errors.description} error={errors?.description?.message}>\n                  <TextArea\n                    className={styles.textarea}\n                    {...register('description', {\n                      required: 'Annotation description is required',\n                    })}\n                  />\n                </Field>\n                <Field label={'Tags'}>\n                  <Controller\n                    control={control}\n                    name=\"tags\"\n                    render={({ field: { ref, onChange, ...field } }) => {\n                      return (\n                        <TagFilter\n                          allowCustomValue\n                          placeholder=\"Add tags\"\n                          onChange={onChange}\n                          tagOptions={getAnnotationTags}\n                          tags={field.value}\n                        />\n                      );\n                    }}\n                  />\n                </Field>\n              </div>\n              <div className={styles.footer}>\n                <Stack justifyContent={'flex-end'}>\n                  <Button size={'sm'} variant=\"secondary\" onClick={dismiss} fill=\"outline\">\n                    Cancel\n                  </Button>\n                  <Button size={'sm'} type={'submit'} disabled={stateIndicator?.loading}>\n                    {stateIndicator?.loading ? 'Saving' : 'Save'}\n                  </Button>\n                </Stack>\n              </div>\n            </>\n          );\n        }}\n      </Form>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    editor: css({\n      background: theme.colors.background.elevated,\n      border: `1px solid ${theme.colors.border.weak}`,\n      borderRadius: theme.shape.radius.default,\n      boxShadow: theme.shadows.z3,\n      userSelect: 'text',\n      width: '460px',\n    }),\n    content: css({\n      padding: theme.spacing(1),\n    }),\n    header: css({\n      borderBottom: `1px solid ${theme.colors.border.weak}`,\n      padding: theme.spacing(0.5, 1),\n      fontWeight: theme.typography.fontWeightBold,\n      fontSize: theme.typography.fontSize,\n      color: theme.colors.text.primary,\n    }),\n    footer: css({\n      borderTop: `1px solid ${theme.colors.border.weak}`,\n      padding: theme.spacing(1, 1),\n    }),\n    textarea: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport * as React from 'react';\n\nimport { GrafanaTheme2, dateTimeFormat, systemDateFormats, textUtil } from '@grafana/data';\nimport { HorizontalGroup, IconButton, Tag, usePanelContext, useStyles2 } from '@grafana/ui';\nimport alertDef from 'app/features/alerting/state/alertDef';\n\ninterface Props {\n  annoVals: Record<string, any[]>;\n  annoIdx: number;\n  timeZone: string;\n  onEdit: () => void;\n}\n\nconst retFalse = () => false;\n\nexport const AnnotationTooltip2 = ({ annoVals, annoIdx, timeZone, onEdit }: Props) => {\n  const annoId = annoVals.id?.[annoIdx];\n\n  const styles = useStyles2(getStyles);\n\n  const { canEditAnnotations = retFalse, canDeleteAnnotations = retFalse, onAnnotationDelete } = usePanelContext();\n\n  const dashboardUID = annoVals.dashboardUID?.[annoIdx];\n\n  // grafana can be configured to load alert rules from loki. Those annotations cannot be edited or deleted. The id being 0 is the best indicator the annotation came from loki\n  const canEdit = annoId !== 0 && canEditAnnotations(dashboardUID);\n  const canDelete = annoId !== 0 && canDeleteAnnotations(dashboardUID) && onAnnotationDelete != null;\n\n  const timeFormatter = (value: number) =>\n    dateTimeFormat(value, {\n      format: systemDateFormats.fullDate,\n      timeZone,\n    });\n\n  let time = timeFormatter(annoVals.time[annoIdx]);\n  let text = annoVals.text?.[annoIdx] ?? '';\n\n  if (annoVals.isRegion?.[annoIdx]) {\n    time += ' - ' + timeFormatter(annoVals.timeEnd[annoIdx]);\n  }\n\n  let avatar;\n  if (annoVals.login?.[annoIdx] && annoVals.avatarUrl?.[annoIdx]) {\n    avatar = <img className={styles.avatar} alt=\"Annotation avatar\" src={annoVals.avatarUrl[annoIdx]} />;\n  }\n\n  let state: React.ReactNode | null = null;\n  let alertText = '';\n\n  if (annoVals.alertId?.[annoIdx] !== undefined && annoVals.newState?.[annoIdx]) {\n    const stateModel = alertDef.getStateDisplayModel(annoVals.newState[annoIdx]);\n    state = (\n      <div className={styles.alertState}>\n        <i className={stateModel.stateClass}>{stateModel.text}</i>\n      </div>\n    );\n\n    alertText = annoVals.data?.[annoIdx] ? alertDef.getAlertAnnotationText(annoVals.data[annoIdx]) : '';\n  } else if (annoVals.title?.[annoIdx]) {\n    text = annoVals.title[annoIdx] + (text ? `<br />${text}` : '');\n  }\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.header}>\n        <HorizontalGroup justify={'space-between'} align={'center'} spacing={'md'}>\n          <div className={styles.meta}>\n            <span>\n              {avatar}\n              {state}\n            </span>\n            {time}\n          </div>\n          {(canEdit || canDelete) && (\n            <div className={styles.editControls}>\n              {canEdit && <IconButton name={'pen'} size={'sm'} onClick={onEdit} tooltip=\"Edit\" />}\n              {canDelete && (\n                <IconButton\n                  name={'trash-alt'}\n                  size={'sm'}\n                  onClick={() => onAnnotationDelete(annoId)}\n                  tooltip=\"Delete\"\n                />\n              )}\n            </div>\n          )}\n        </HorizontalGroup>\n      </div>\n\n      <div className={styles.body}>\n        {text && <div className={styles.text} dangerouslySetInnerHTML={{ __html: textUtil.sanitize(text) }} />}\n        {alertText}\n        <div>\n          <HorizontalGroup spacing=\"xs\" wrap>\n            {annoVals.tags?.[annoIdx]?.map((t: string, i: number) => <Tag name={t} key={`${t}-${i}`} />)}\n          </HorizontalGroup>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    zIndex: theme.zIndex.tooltip,\n    whiteSpace: 'initial',\n    borderRadius: theme.shape.radius.default,\n    background: theme.colors.background.elevated,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z3,\n    userSelect: 'text',\n  }),\n  header: css({\n    padding: theme.spacing(0.5, 1),\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n    fontWeight: theme.typography.fontWeightBold,\n    fontSize: theme.typography.fontSize,\n    color: theme.colors.text.primary,\n    display: 'flex',\n  }),\n  meta: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    color: theme.colors.text.primary,\n    fontWeight: 400,\n  }),\n  editControls: css({\n    display: 'flex',\n    alignItems: 'center',\n    '> :last-child': {\n      marginLeft: 0,\n    },\n  }),\n  body: css({\n    padding: theme.spacing(1),\n    fontSize: theme.typography.bodySmall.fontSize,\n    color: theme.colors.text.secondary,\n    fontWeight: 400,\n    a: {\n      color: theme.colors.text.link,\n      '&:hover': {\n        textDecoration: 'underline',\n      },\n    },\n  }),\n  text: css({\n    paddingBottom: theme.spacing(1),\n  }),\n  avatar: css({\n    borderRadius: theme.shape.radius.circle,\n    width: 16,\n    height: 16,\n    marginRight: theme.spacing(1),\n  }),\n  alertState: css({\n    paddingRight: theme.spacing(1),\n    fontWeight: theme.typography.fontWeightMedium,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { flip, shift, autoUpdate } from '@floating-ui/dom';\nimport { useFloating } from '@floating-ui/react';\nimport { useState } from 'react';\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { TimeZone } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { AnnotationEditor2 } from './AnnotationEditor2';\nimport { AnnotationTooltip2 } from './AnnotationTooltip2';\n\ninterface AnnoBoxProps {\n  annoVals: Record<string, any[]>;\n  annoIdx: number;\n  style: React.CSSProperties | null;\n  className: string;\n  timeZone: TimeZone;\n  exitWipEdit?: null | (() => void);\n  portalRoot: HTMLElement;\n}\n\nconst STATE_DEFAULT = 0;\nconst STATE_EDITING = 1;\nconst STATE_HOVERED = 2;\n\nexport const AnnotationMarker2 = ({\n  annoVals,\n  annoIdx,\n  className,\n  style,\n  exitWipEdit,\n  timeZone,\n  portalRoot,\n}: AnnoBoxProps) => {\n  const styles = useStyles2(getStyles);\n\n  const [state, setState] = useState(exitWipEdit != null ? STATE_EDITING : STATE_DEFAULT);\n  const { refs, floatingStyles } = useFloating({\n    open: true,\n    placement: 'bottom',\n    middleware: [\n      flip({\n        fallbackAxisSideDirection: 'end',\n        // see https://floating-ui.com/docs/flip#combining-with-shift\n        crossAxis: false,\n        boundary: document.body,\n      }),\n      shift(),\n    ],\n    whileElementsMounted: autoUpdate,\n    strategy: 'fixed',\n  });\n\n  const contents =\n    state === STATE_HOVERED ? (\n      <AnnotationTooltip2\n        annoIdx={annoIdx}\n        annoVals={annoVals}\n        timeZone={timeZone}\n        onEdit={() => setState(STATE_EDITING)}\n      />\n    ) : state === STATE_EDITING ? (\n      <AnnotationEditor2\n        annoIdx={annoIdx}\n        annoVals={annoVals}\n        timeZone={timeZone}\n        dismiss={() => {\n          exitWipEdit?.();\n          setState(STATE_DEFAULT);\n        }}\n      />\n    ) : null;\n\n  return (\n    <div\n      ref={refs.setReference}\n      className={className}\n      style={style!}\n      onMouseEnter={() => state !== STATE_EDITING && setState(STATE_HOVERED)}\n      onMouseLeave={() => state !== STATE_EDITING && setState(STATE_DEFAULT)}\n      data-testid={selectors.pages.Dashboard.Annotations.marker}\n    >\n      {contents &&\n        createPortal(\n          <div ref={refs.setFloating} className={styles.annoBox} style={floatingStyles} data-testid=\"annotation-marker\">\n            {contents}\n          </div>,\n          portalRoot\n        )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  // NOTE: shares much with TooltipPlugin2\n  annoBox: css({\n    top: 0,\n    left: 0,\n    zIndex: theme.zIndex.tooltip,\n    borderRadius: theme.shape.radius.default,\n    position: 'absolute',\n    background: theme.colors.background.primary,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z2,\n    userSelect: 'text',\n    minWidth: '300px',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState, useReducer } from 'react';\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport tinycolor from 'tinycolor2';\nimport uPlot from 'uplot';\n\nimport { arrayToDataFrame, colorManipulator, DataFrame, DataTopic } from '@grafana/data';\nimport { TimeZone } from '@grafana/schema';\nimport { DEFAULT_ANNOTATION_COLOR, getPortalContainer, UPlotConfigBuilder, useStyles2, useTheme2 } from '@grafana/ui';\n\nimport { AnnotationMarker2 } from './annotations2/AnnotationMarker2';\n\n// (copied from TooltipPlugin2)\ninterface TimeRange2 {\n  from: number;\n  to: number;\n}\n\ninterface AnnotationsPluginProps {\n  config: UPlotConfigBuilder;\n  annotations: DataFrame[];\n  timeZone: TimeZone;\n  newRange: TimeRange2 | null;\n  setNewRange: (newRage: TimeRange2 | null) => void;\n  canvasRegionRendering?: boolean;\n}\n\n// TODO: batch by color, use Path2D objects\nconst renderLine = (ctx: CanvasRenderingContext2D, y0: number, y1: number, x: number, color: string) => {\n  ctx.beginPath();\n  ctx.moveTo(x, y0);\n  ctx.lineTo(x, y1);\n  ctx.strokeStyle = color;\n  ctx.stroke();\n};\n\n// const renderUpTriangle = (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number, color: string) => {\n//   ctx.beginPath();\n//   ctx.moveTo(x - w/2, y + h/2);\n//   ctx.lineTo(x + w/2, y + h/2);\n//   ctx.lineTo(x, y);\n//   ctx.closePath();\n//   ctx.fillStyle = color;\n//   ctx.fill();\n// }\n\nconst DEFAULT_ANNOTATION_COLOR_HEX8 = tinycolor(DEFAULT_ANNOTATION_COLOR).toHex8String();\n\nfunction getVals(frame: DataFrame) {\n  let vals: Record<string, any[]> = {};\n  frame.fields.forEach((f) => {\n    vals[f.name] = f.values;\n  });\n\n  return vals;\n}\n\nexport const AnnotationsPlugin2 = ({\n  annotations,\n  timeZone,\n  config,\n  newRange,\n  setNewRange,\n  canvasRegionRendering = true,\n}: AnnotationsPluginProps) => {\n  const [plot, setPlot] = useState<uPlot>();\n\n  const [portalRoot] = useState(() => getPortalContainer());\n\n  const styles = useStyles2(getStyles);\n  const getColorByName = useTheme2().visualization.getColorByName;\n\n  const [_, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  const annos = useMemo(() => {\n    let annos = annotations.filter(\n      (frame) => frame.name !== 'exemplar' && frame.length > 0 && frame.fields.some((f) => f.name === 'time')\n    );\n\n    if (newRange) {\n      let isRegion = newRange.to > newRange.from;\n\n      const wipAnnoFrame = arrayToDataFrame([\n        {\n          time: newRange.from,\n          timeEnd: isRegion ? newRange.to : null,\n          isRegion: isRegion,\n          color: DEFAULT_ANNOTATION_COLOR_HEX8,\n        },\n      ]);\n\n      wipAnnoFrame.meta = {\n        dataTopic: DataTopic.Annotations,\n        custom: {\n          isWip: true,\n        },\n      };\n\n      annos.push(wipAnnoFrame);\n    }\n\n    return annos;\n  }, [annotations, newRange]);\n\n  const exitWipEdit = useCallback(() => {\n    setNewRange(null);\n  }, [setNewRange]);\n\n  const annoRef = useRef(annos);\n  annoRef.current = annos;\n  const newRangeRef = useRef(newRange);\n  newRangeRef.current = newRange;\n\n  const xAxisRef = useRef<HTMLDivElement>();\n\n  useLayoutEffect(() => {\n    config.addHook('ready', (u) => {\n      let xAxisEl = u.root.querySelector<HTMLDivElement>('.u-axis')!;\n      xAxisRef.current = xAxisEl;\n      setPlot(u);\n    });\n\n    config.addHook('draw', (u) => {\n      let annos = annoRef.current;\n\n      const ctx = u.ctx;\n\n      ctx.save();\n\n      ctx.beginPath();\n      ctx.rect(u.bbox.left, u.bbox.top, u.bbox.width, u.bbox.height);\n      ctx.clip();\n\n      annos.forEach((frame) => {\n        let vals = getVals(frame);\n\n        if (frame.name === 'xymark') {\n          // xMin, xMax, yMin, yMax, color, lineWidth, lineStyle, fillOpacity, text\n\n          let xKey = config.scales[0].props.scaleKey;\n          let yKey = config.scales[1].props.scaleKey;\n\n          for (let i = 0; i < frame.length; i++) {\n            let color = getColorByName(vals.color?.[i] || DEFAULT_ANNOTATION_COLOR_HEX8);\n\n            let x0 = u.valToPos(vals.xMin[i], xKey, true);\n            let x1 = u.valToPos(vals.xMax[i], xKey, true);\n            let y0 = u.valToPos(vals.yMax[i], yKey, true);\n            let y1 = u.valToPos(vals.yMin[i], yKey, true);\n\n            ctx.fillStyle = colorManipulator.alpha(color, vals.fillOpacity[i]);\n            ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n\n            ctx.lineWidth = Math.round(vals.lineWidth[i] * uPlot.pxRatio);\n\n            if (vals.lineStyle[i] === 'dash') {\n              // maybe extract this to vals.lineDash[i] in future?\n              ctx.setLineDash([5, 5]);\n            } else {\n              // solid\n              ctx.setLineDash([]);\n            }\n\n            ctx.strokeStyle = color;\n            ctx.strokeRect(x0, y0, x1 - x0, y1 - y0);\n          }\n        } else {\n          let y0 = u.bbox.top;\n          let y1 = y0 + u.bbox.height;\n\n          ctx.lineWidth = 2;\n          ctx.setLineDash([5, 5]);\n\n          for (let i = 0; i < vals.time.length; i++) {\n            let color = getColorByName(vals.color?.[i] || DEFAULT_ANNOTATION_COLOR_HEX8);\n\n            let x0 = u.valToPos(vals.time[i], 'x', true);\n            renderLine(ctx, y0, y1, x0, color);\n\n            if (vals.isRegion?.[i]) {\n              let x1 = u.valToPos(vals.timeEnd[i], 'x', true);\n              renderLine(ctx, y0, y1, x1, color);\n\n              if (canvasRegionRendering) {\n                ctx.fillStyle = colorManipulator.alpha(color, 0.1);\n                ctx.fillRect(x0, y0, x1 - x0, u.bbox.height);\n              }\n            }\n          }\n        }\n      });\n\n      ctx.restore();\n    });\n  }, [config, canvasRegionRendering, getColorByName]);\n\n  // ensure annos are re-drawn whenever they change\n  useEffect(() => {\n    if (plot) {\n      plot.redraw();\n\n      // this forces a second redraw after uPlot is updated (in the Plot.tsx didUpdate) with new data/scales\n      // and ensures the anno marker positions in the dom are re-rendered in correct places\n      // (this is temp fix until uPlot integrtion is refactored)\n      setTimeout(() => {\n        forceUpdate();\n      }, 0);\n    }\n  }, [annos, plot]);\n\n  if (plot) {\n    let markers = annos.flatMap((frame, frameIdx) => {\n      let vals = getVals(frame);\n\n      let markers: React.ReactNode[] = [];\n\n      for (let i = 0; i < vals.time.length; i++) {\n        let color = getColorByName(vals.color?.[i] || DEFAULT_ANNOTATION_COLOR);\n        let left = Math.round(plot.valToPos(vals.time[i], 'x')) || 0; // handles -0\n        let style: React.CSSProperties | null = null;\n        let className = '';\n        let isVisible = true;\n\n        if (vals.isRegion?.[i]) {\n          let right = Math.round(plot.valToPos(vals.timeEnd?.[i], 'x')) || 0; // handles -0\n\n          isVisible = left < plot.rect.width && right > 0;\n\n          if (isVisible) {\n            let clampedLeft = Math.max(0, left);\n            let clampedRight = Math.min(plot.rect.width, right);\n\n            style = { left: clampedLeft, background: color, width: clampedRight - clampedLeft };\n            className = styles.annoRegion;\n          }\n        } else {\n          isVisible = left >= 0 && left <= plot.rect.width;\n\n          if (isVisible) {\n            style = { left, borderBottomColor: color };\n            className = styles.annoMarker;\n          }\n        }\n\n        // @TODO: Reset newRange after annotation is saved\n        if (isVisible) {\n          let isWip = frame.meta?.custom?.isWip;\n\n          markers.push(\n            <AnnotationMarker2\n              annoIdx={i}\n              annoVals={vals}\n              className={className}\n              style={style}\n              timeZone={timeZone}\n              key={`${frameIdx}:${i}`}\n              exitWipEdit={isWip ? exitWipEdit : null}\n              portalRoot={portalRoot}\n            />\n          );\n        }\n      }\n\n      return markers;\n    });\n\n    return createPortal(markers, xAxisRef.current!);\n  }\n\n  return null;\n};\n\nconst getStyles = () => ({\n  annoMarker: css({\n    position: 'absolute',\n    width: 0,\n    height: 0,\n    borderLeft: '5px solid transparent',\n    borderRight: '5px solid transparent',\n    borderBottomWidth: '5px',\n    borderBottomStyle: 'solid',\n    transform: 'translateX(-50%)',\n    cursor: 'pointer',\n    zIndex: 1,\n  }),\n  annoRegion: css({\n    position: 'absolute',\n    height: '5px',\n    cursor: 'pointer',\n    zIndex: 1,\n  }),\n});\n","import { useLayoutEffect, useRef, useState } from 'react';\nimport uPlot, { TypedArray, Scale } from 'uplot';\n\nimport { AbsoluteTimeRange } from '@grafana/data';\nimport { UPlotConfigBuilder, Button } from '@grafana/ui';\n\ninterface ThresholdControlsPluginProps {\n  config: UPlotConfigBuilder;\n  onChangeTimeRange: (timeRange: AbsoluteTimeRange) => void;\n}\n\nexport const OutsideRangePlugin = ({ config, onChangeTimeRange }: ThresholdControlsPluginProps) => {\n  const plotInstance = useRef<uPlot>();\n  const [timevalues, setTimeValues] = useState<number[] | TypedArray>([]);\n  const [timeRange, setTimeRange] = useState<Scale | undefined>();\n\n  useLayoutEffect(() => {\n    config.addHook('init', (u) => {\n      plotInstance.current = u;\n    });\n\n    config.addHook('setScale', (u) => {\n      setTimeValues(u.data?.[0] ?? []);\n      setTimeRange(u.scales['x'] ?? undefined);\n    });\n  }, [config]);\n\n  if (timevalues.length < 2 || !onChangeTimeRange) {\n    return null;\n  }\n\n  if (!timeRange || !timeRange.time || !timeRange.min || !timeRange.max!) {\n    return null;\n  }\n\n  // Time values are always sorted for uPlot to work\n  let i = 0,\n    j = timevalues.length - 1;\n\n  while (i <= j && timevalues[i] == null) {\n    i++;\n  }\n\n  while (j >= 0 && timevalues[j] == null) {\n    j--;\n  }\n\n  const first = timevalues[i];\n  const last = timevalues[j];\n  const fromX = timeRange.min;\n  const toX = timeRange.max;\n\n  if (first == null || last == null) {\n    return null;\n  }\n\n  // (StartA <= EndB) and (EndA >= StartB)\n  if (first <= toX && last >= fromX) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: '50%',\n        transform: 'translateY(-50%)',\n        width: '100%',\n        textAlign: 'center',\n      }}\n    >\n      <div>\n        <div>Data outside time range</div>\n        <Button\n          onClick={(v) => onChangeTimeRange({ from: first, to: last })}\n          variant=\"secondary\"\n          data-testid=\"time-series-zoom-to-data\"\n        >\n          Zoom to data\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nOutsideRangePlugin.displayName = 'OutsideRangePlugin';\n","import {\n  DataFrame,\n  Field,\n  FieldType,\n  getDisplayProcessor,\n  GrafanaTheme2,\n  isBooleanUnit,\n  TimeRange,\n  cacheFieldDisplayNames,\n  applyNullInsertThreshold,\n  nullToValue,\n} from '@grafana/data';\nimport { convertFieldType } from '@grafana/data/internal';\nimport { GraphFieldConfig, LineInterpolation, TooltipDisplayMode, VizTooltipOptions } from '@grafana/schema';\nimport { buildScaleKey } from '@grafana/ui/internal';\n\nimport { HeatmapTooltip } from '../heatmap/panelcfg.gen';\n\ntype ScaleKey = string;\n\n// this will re-enumerate all enum fields on the same scale to create one ordinal progression\n// e.g. ['a','b'][0,1,0] + ['c','d'][1,0,1] -> ['a','b'][0,1,0] + ['c','d'][3,2,3]\nfunction reEnumFields(frames: DataFrame[]): DataFrame[] {\n  let allTextsByKey: Map<ScaleKey, string[]> = new Map();\n\n  let frames2: DataFrame[] = frames.map((frame) => {\n    return {\n      ...frame,\n      fields: frame.fields.map((field) => {\n        if (field.type === FieldType.enum) {\n          let scaleKey = buildScaleKey(field.config, field.type);\n          let allTexts = allTextsByKey.get(scaleKey);\n\n          if (!allTexts) {\n            allTexts = [];\n            allTextsByKey.set(scaleKey, allTexts);\n          }\n\n          let idxs: number[] = field.values.toArray().slice();\n          let txts = field.config.type!.enum!.text!;\n\n          // by-reference incrementing\n          if (allTexts.length > 0) {\n            for (let i = 0; i < idxs.length; i++) {\n              idxs[i] += allTexts.length;\n            }\n          }\n\n          allTexts.push(...txts);\n\n          // shared among all enum fields on same scale\n          field.config.type!.enum!.text! = allTexts;\n\n          return {\n            ...field,\n            values: idxs,\n          };\n\n          // TODO: update displayProcessor?\n        }\n\n        return field;\n      }),\n    };\n  });\n\n  return frames2;\n}\n\n/**\n * Returns null if there are no graphable fields\n */\nexport function prepareGraphableFields(\n  series: DataFrame[],\n  theme: GrafanaTheme2,\n  timeRange?: TimeRange,\n  // numeric X requires a single frame where the first field is numeric\n  xNumFieldIdx?: number\n): DataFrame[] | null {\n  if (!series?.length) {\n    return null;\n  }\n\n  cacheFieldDisplayNames(series);\n\n  let useNumericX = xNumFieldIdx != null;\n\n  // Make sure the numeric x field is first in the frame\n  if (xNumFieldIdx != null && xNumFieldIdx > 0) {\n    series = [\n      {\n        ...series[0],\n        fields: [series[0].fields[xNumFieldIdx], ...series[0].fields.filter((f, i) => i !== xNumFieldIdx)],\n      },\n    ];\n  }\n\n  // some datasources simply tag the field as time, but don't convert to milli epochs\n  // so we're stuck with doing the parsing here to avoid Moment slowness everywhere later\n  // this mutates (once)\n  for (let frame of series) {\n    for (let field of frame.fields) {\n      if (field.type === FieldType.time && typeof field.values[0] !== 'number') {\n        field.values = convertFieldType(field, { destinationType: FieldType.time }).values;\n      }\n    }\n  }\n\n  let enumFieldsCount = 0;\n\n  loopy: for (let frame of series) {\n    for (let field of frame.fields) {\n      if (field.type === FieldType.enum && ++enumFieldsCount > 1) {\n        series = reEnumFields(series);\n        break loopy;\n      }\n    }\n  }\n\n  let copy: Field;\n\n  const frames: DataFrame[] = [];\n\n  for (let frame of series) {\n    const fields: Field[] = [];\n\n    let hasTimeField = false;\n    let hasValueField = false;\n\n    let nulledFrame = useNumericX\n      ? frame\n      : applyNullInsertThreshold({\n          frame,\n          refFieldPseudoMin: timeRange?.from.valueOf(),\n          refFieldPseudoMax: timeRange?.to.valueOf(),\n        });\n\n    const frameFields = nullToValue(nulledFrame).fields;\n\n    for (let fieldIdx = 0; fieldIdx < (frameFields?.length || 0); fieldIdx++) {\n      const field = frameFields[fieldIdx];\n\n      switch (field.type) {\n        case FieldType.time:\n          hasTimeField = true;\n          fields.push(field);\n          break;\n        case FieldType.number:\n          hasValueField = useNumericX ? fieldIdx > 0 : true;\n          copy = {\n            ...field,\n            values: field.values.map((v) => {\n              if (!(Number.isFinite(v) || v == null)) {\n                return null;\n              }\n              return v;\n            }),\n          };\n\n          fields.push(copy);\n          break; // ok\n        case FieldType.enum:\n          hasValueField = true;\n        case FieldType.string:\n          copy = {\n            ...field,\n            values: field.values,\n          };\n\n          fields.push(copy);\n          break; // ok\n        case FieldType.boolean:\n          hasValueField = true;\n          const custom: GraphFieldConfig = field.config?.custom ?? {};\n          const config = {\n            ...field.config,\n            max: 1,\n            min: 0,\n            custom,\n          };\n\n          // smooth and linear do not make sense\n          if (custom.lineInterpolation !== LineInterpolation.StepBefore) {\n            custom.lineInterpolation = LineInterpolation.StepAfter;\n          }\n\n          copy = {\n            ...field,\n            config,\n            type: FieldType.number,\n            values: field.values.map((v) => {\n              if (v == null) {\n                return v;\n              }\n              return Boolean(v) ? 1 : 0;\n            }),\n          };\n\n          if (!isBooleanUnit(config.unit)) {\n            config.unit = 'bool';\n            copy.display = getDisplayProcessor({ field: copy, theme });\n          }\n\n          fields.push(copy);\n          break;\n      }\n    }\n\n    if ((useNumericX || hasTimeField) && hasValueField) {\n      frames.push({\n        ...frame,\n        length: nulledFrame.length,\n        fields,\n      });\n    }\n  }\n\n  if (frames.length) {\n    setClassicPaletteIdxs(frames, theme, 0);\n    matchEnumColorToSeriesColor(frames, theme);\n    return frames;\n  }\n\n  return null;\n}\n\nconst matchEnumColorToSeriesColor = (frames: DataFrame[], theme: GrafanaTheme2) => {\n  const { palette } = theme.visualization;\n  for (const frame of frames) {\n    for (const field of frame.fields) {\n      if (field.type === FieldType.enum) {\n        const namedColor = palette[field.state?.seriesIndex! % palette.length];\n        const hexColor = theme.visualization.getColorByName(namedColor);\n        const enumConfig = field.config.type!.enum!;\n\n        enumConfig.color = Array(enumConfig.text!.length).fill(hexColor);\n        field.display = getDisplayProcessor({ field, theme });\n      }\n    }\n  }\n};\n\nexport const setClassicPaletteIdxs = (frames: DataFrame[], theme: GrafanaTheme2, skipFieldIdx?: number) => {\n  let seriesIndex = 0;\n  frames.forEach((frame) => {\n    frame.fields.forEach((field, fieldIdx) => {\n      if (\n        fieldIdx !== skipFieldIdx &&\n        (field.type === FieldType.number || field.type === FieldType.boolean || field.type === FieldType.enum)\n      ) {\n        field.state = {\n          ...field.state,\n          seriesIndex: seriesIndex++, // TODO: skip this for fields with custom renderers (e.g. Candlestick)?\n        };\n        field.display = getDisplayProcessor({ field, theme });\n      }\n    });\n  });\n};\n\nexport function getTimezones(timezones: string[] | undefined, defaultTimezone: string): string[] {\n  if (!timezones || !timezones.length) {\n    return [defaultTimezone];\n  }\n  return timezones.map((v) => (v?.length ? v : defaultTimezone));\n}\n\nexport const isTooltipScrollable = (tooltipOptions: VizTooltipOptions | HeatmapTooltip) => {\n  return tooltipOptions.mode === TooltipDisplayMode.Multi && tooltipOptions.maxHeight != null;\n};\n"],"names":["VizTooltipWrapper","children","className","styles","getStyles","theme","Form","defaultValues","onSubmit","validateOnMount","validateFieldsOnMount","validateOn","maxWidth","htmlProps","handleSubmit","trigger","formState","rest","AnnotationEditor2","annoVals","annoIdx","dismiss","timeZone","otherProps","onAnnotationCreate","onAnnotationUpdate","clickAwayRef","useClickAway","createAnnotationState","createAnnotation","useAsyncFn","event","result","updateAnnotationState","updateAnnotation","timeFormatter","value","isUpdatingAnnotation","isRegionAnnotation","operation","stateIndicator","time","tags","description","Stack","register","errors","control","Field","TextArea","ref","onChange","field","TagFilter","Button","retFalse","AnnotationTooltip2","onEdit","annoId","canEditAnnotations","canDeleteAnnotations","onAnnotationDelete","dashboardUID","canEdit","canDelete","text","avatar","state","alertText","stateModel","alertDef","IconButton","t","i","Tag","STATE_DEFAULT","STATE_EDITING","STATE_HOVERED","AnnotationMarker2","style","exitWipEdit","portalRoot","setState","refs","floatingStyles","contents","selectors","renderLine","ctx","y0","y1","x","color","DEFAULT_ANNOTATION_COLOR_HEX8","tinycolor","getVals","frame","vals","f","AnnotationsPlugin2","annotations","config","newRange","setNewRange","canvasRegionRendering","plot","setPlot","getColorByName","_","forceUpdate","annos","isRegion","wipAnnoFrame","annoRef","newRangeRef","xAxisRef","u","xAxisEl","xKey","yKey","x0","x1","colorManipulator","markers","frameIdx","left","isVisible","right","clampedLeft","clampedRight","isWip","OutsideRangePlugin","onChangeTimeRange","plotInstance","timevalues","setTimeValues","timeRange","setTimeRange","j","first","last","fromX","toX","v","reEnumFields","frames","allTextsByKey","scaleKey","allTexts","idxs","txts","prepareGraphableFields","series","xNumFieldIdx","useNumericX","enumFieldsCount","loopy","copy","fields","hasTimeField","hasValueField","nulledFrame","frameFields","fieldIdx","custom","setClassicPaletteIdxs","matchEnumColorToSeriesColor","palette","namedColor","hexColor","enumConfig","skipFieldIdx","seriesIndex","getTimezones","timezones","defaultTimezone","isTooltipScrollable","tooltipOptions"],"sourceRoot":""}