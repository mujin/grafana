(()=>{var x={45928:function(E){(function(D,g){E.exports=g()})(this,()=>(()=>{"use strict";var w={"./public/lib/events.ts":(y,v,d)=>{d.r(v),d.d(v,{createCloseEvent:()=>n,createCrashDetectedEvent:()=>u,createCrashReportedEvent:()=>l,createPingEvent:()=>S,createStaleTabDetectedEvent:()=>a,createStaleTabReportedEvent:()=>o,createStartEvent:()=>b,createUpdateEvent:()=>s,isCloseEvent:()=>f,isCrashDetectedEvent:()=>e,isCrashReportedEvent:()=>i,isPingEvent:()=>_,isStaleTabDetectedEvent:()=>t,isStaleTabReportedEvent:()=>r,isStartEvent:()=>P,isUpdateEvent:()=>C});function P(c){return c?.event==="start"}function b(c){return{event:"start",report:c}}function S(){return{event:"ping"}}function _(c){return c?.event==="ping"}function C(c){return c?.event==="update"}function s(c){return{event:"update",report:c}}function f(c){return c?.event==="close"}function n(c){return{event:"close",id:c}}function e(c){return c?.event==="crash-detected"}function u(c,O){return{event:"crash-detected",report:c,senderId:O}}function t(c){return c?.event==="stale-tab-detected"}function a(c,O){return{event:"stale-tab-detected",report:c,senderId:O}}function i(c){return c?.event==="crash-reported"}function l(c){return{event:"crash-reported",id:c}}function r(c){return c?.event==="stale-tab-reported"}function o(c){return{event:"stale-tab-reported",report:c}}},"./public/lib/init.client.worker.ts":(y,v,d)=>{d.r(v),d.d(v,{initClientWorker:()=>s});var P=d("./public/lib/utils.ts"),b=d("./public/lib/events.ts"),S=function(){return S=Object.assign||function(f){for(var n,e=1,u=arguments.length;e<u;e++){n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(f[t]=n[t])}return f},S.apply(this,arguments)},_=function(f,n,e,u){function t(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function l(c){try{o(u.next(c))}catch(O){i(O)}}function r(c){try{o(u.throw(c))}catch(O){i(O)}}function o(c){c.done?a(c.value):t(c.value).then(l,r)}o((u=u.apply(f,n||[])).next())})},C=function(f,n){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},u,t,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(o){return function(c){return r([o,c])}}function r(o){if(u)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(e=0)),e;)try{if(u=1,t&&(a=o[0]&2?t.return:o[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,t=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(f,e)}catch(c){o=[6,c],t=0}finally{u=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};function s(f){var n=this,e,u=Date.now(),t;setInterval(function(){if(t){if(e?.id){var a=t.transaction(["tabs"],"readwrite"),i=a.objectStore("tabs"),l=Date.now();i.put(S(S({},structuredClone(e)),{tabLastActive:u,workerLastActive:l}))}var r=(0,b.createPingEvent)();postMessage(r)}},f.pingInterval),addEventListener("message",function(a){return _(n,void 0,void 0,function(){var i,l;return C(this,function(r){switch(r.label){case 0:return(0,b.isUpdateEvent)(a.data)&&(u=Date.now(),e=structuredClone(a.data.report)),(0,b.isStartEvent)(a.data)?[4,(0,P.getDb)(f.dbName)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return(0,b.isCloseEvent)(a.data)&&t&&(i=t.transaction(["tabs"],"readwrite"),l=i.objectStore("tabs"),l.delete(a.data.id),t=void 0),[2]}})})})}},"./public/lib/init.detector.worker.ts":(y,v,d)=>{d.r(v),d.d(v,{initDetectorWorker:()=>C});var P=d("./public/lib/utils.ts"),b=d("./public/lib/events.ts"),S=function(s,f,n,e){function u(t){return t instanceof n?t:new n(function(a){a(t)})}return new(n||(n=Promise))(function(t,a){function i(o){try{r(e.next(o))}catch(c){a(c)}}function l(o){try{r(e.throw(o))}catch(c){a(c)}}function r(o){o.done?t(o.value):u(o.value).then(i,l)}r((e=e.apply(s,f||[])).next())})},_=function(s,f){var n={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},e,u,t,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(r){return function(o){return l([r,o])}}function l(r){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,r[0]&&(n=0)),n;)try{if(e=1,u&&(t=r[0]&2?u.return:r[0]?u.throw||((t=u.return)&&t.call(u),0):u.next)&&!(t=t.call(u,r[1])).done)return t;switch(u=0,t&&(r=[r[0]&2,t.value]),r[0]){case 0:case 1:t=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,u=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if(t=n.trys,!(t=t.length>0&&t[t.length-1])&&(r[0]===6||r[0]===2)){n=0;continue}if(r[0]===3&&(!t||r[1]>t[0]&&r[1]<t[3])){n.label=r[1];break}if(r[0]===6&&n.label<t[1]){n.label=t[1],t=r;break}if(t&&n.label<t[2]){n.label=t[2],n.ops.push(r);break}t[2]&&n.ops.pop(),n.trys.pop();continue}r=f.call(s,n)}catch(o){r=[6,o],u=0}finally{e=t=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function C(s){var f,n=!1,e=[],u=[];function t(i){if((0,b.isCrashReportedEvent)(i.data)){var l=f.transaction(["tabs"],"readwrite"),r=l.objectStore("tabs");r.delete(i.data.id)}(0,b.isStaleTabReportedEvent)(i.data)&&u.push(i.data.report.id)}function a(){var i=f.transaction(["tabs"],"readwrite"),l=i.objectStore("tabs"),r=l.getAll();r.onsuccess=function(){var o=r.result,c=[],O=[],h=[];if(o.forEach(function(p){var k=Date.now()-p.workerLastActive,T=Date.now()-p.tabLastActive;k>s.crashThreshold?O.push(p):s.staleThreshold&&T>s.staleThreshold&&!u.includes(p.id)?h.push(p):c.push(p)}),c.length!==0){var M=c.pop();O.forEach(function(p){e.forEach(function(k){var T=(0,b.createCrashDetectedEvent)(p,M.id);k.postMessage(T)})}),h.forEach(function(p){e.forEach(function(k){var T=(0,b.createStaleTabDetectedEvent)(p,M.id);k.postMessage(T)})})}}}self.addEventListener("connect",function(i){return S(this,void 0,void 0,function(){var l;return _(this,function(r){switch(r.label){case 0:return n?[3,2]:[4,(0,P.getDb)(s.dbName)];case 1:f=r.sent(),l=i.ports[0],e.push(l),l.addEventListener("message",t),l.addEventListener("close",function(){e=e.filter(function(o){return o!==l})}),l.start(),setInterval(a,s.interval),n=!0,r.label=2;case 2:return[2]}})})})}},"./public/lib/init.ts":(y,v,d)=>{d.r(v),d.d(v,{initCrashDetection:()=>C});var P=d("./public/lib/utils.ts"),b=d("./public/lib/events.ts"),S=function(s,f,n,e){function u(t){return t instanceof n?t:new n(function(a){a(t)})}return new(n||(n=Promise))(function(t,a){function i(o){try{r(e.next(o))}catch(c){a(c)}}function l(o){try{r(e.throw(o))}catch(c){a(c)}}function r(o){o.done?t(o.value):u(o.value).then(i,l)}r((e=e.apply(s,f||[])).next())})},_=function(s,f){var n={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},e,u,t,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(r){return function(o){return l([r,o])}}function l(r){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,r[0]&&(n=0)),n;)try{if(e=1,u&&(t=r[0]&2?u.return:r[0]?u.throw||((t=u.return)&&t.call(u),0):u.next)&&!(t=t.call(u,r[1])).done)return t;switch(u=0,t&&(r=[r[0]&2,t.value]),r[0]){case 0:case 1:t=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,u=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if(t=n.trys,!(t=t.length>0&&t[t.length-1])&&(r[0]===6||r[0]===2)){n=0;continue}if(r[0]===3&&(!t||r[1]>t[0]&&r[1]<t[3])){n.label=r[1];break}if(r[0]===6&&n.label<t[1]){n.label=t[1],t=r;break}if(t&&n.label<t[2]){n.label=t[2],n.ops.push(r);break}t[2]&&n.ops.pop(),n.trys.pop();continue}r=f.call(s,n)}catch(o){r=[6,o],u=0}finally{e=t=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};function C(s){var f,n,e={},u,t=function(h){var M;h.id=String(e.id),(M=s.log)===null||M===void 0||M.call(s,h)};function a(h){return S(this,void 0,void 0,function(){var M,T,p,k,T,I;return _(this,function(R){switch(R.label){case 0:return(0,b.isCrashDetectedEvent)(h.data)&&h.data.senderId===e.id?(M=h.data.report,[4,s.reportCrash(M)]):[3,2];case 1:T=R.sent(),T&&(p=(0,b.createCrashReportedEvent)(h.data.report.id),n.port.postMessage(p)),R.label=2;case 2:return s.reportStaleTab&&(0,b.isStaleTabDetectedEvent)(h.data)&&h.data.senderId===e.id?(k=h.data.report,[4,s.reportStaleTab(k)]):[3,4];case 3:T=R.sent(),T&&(I=(0,b.createStaleTabReportedEvent)(h.data.report),n.port.postMessage(I)),R.label=4;case 4:return[2]}})})}function i(){e.id=s.id,e.tabFirstActive=Date.now()}function l(h){if((0,b.isPingEvent)(h.data)){s.updateInfo(e);var M=(0,b.createUpdateEvent)(e);f.postMessage(M)}}function r(){f=s.createClientWorker(),f.addEventListener("message",l),n=s.createDetectorWorker(),n.port.addEventListener("message",a),n.port.start()}function o(){f.removeEventListener("message",l),n.port.removeEventListener("message",a)}function c(){window.addEventListener("click",O)}function O(){return S(this,void 0,void 0,function(){var h;return _(this,function(M){return window.removeEventListener("click",O),i(),r(),window.addEventListener("beforeunload",function(){var p=u.transaction(["tabs"],"readwrite"),k=p.objectStore("tabs");k.delete(e.id);var T=(0,b.createCloseEvent)(e.id);f.postMessage(T),o()}),h=(0,b.createStartEvent)(e),f.postMessage(h),[2]})})}(0,P.getDb)(s.dbName).then(function(h){return u=h}),document.readyState==="complete"?c():window.addEventListener("load",function(){c()})}},"./public/lib/utils.ts":(y,v,d)=>{d.r(v),d.d(v,{getDb:()=>S});var P=function(_,C,s,f){function n(e){return e instanceof s?e:new s(function(u){u(e)})}return new(s||(s=Promise))(function(e,u){function t(l){try{i(f.next(l))}catch(r){u(r)}}function a(l){try{i(f.throw(l))}catch(r){u(r)}}function i(l){l.done?e(l.value):n(l.value).then(t,a)}i((f=f.apply(_,C||[])).next())})},b=function(_,C){var s={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},f,n,e,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=t(0),u.throw=t(1),u.return=t(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function t(i){return function(l){return a([i,l])}}function a(i){if(f)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(s=0)),s;)try{if(f=1,n&&(e=i[0]&2?n.return:i[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,i[1])).done)return e;switch(n=0,e&&(i=[i[0]&2,e.value]),i[0]){case 0:case 1:e=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(e=s.trys,!(e=e.length>0&&e[e.length-1])&&(i[0]===6||i[0]===2)){s=0;continue}if(i[0]===3&&(!e||i[1]>e[0]&&i[1]<e[3])){s.label=i[1];break}if(i[0]===6&&s.label<e[1]){s.label=e[1],e=i;break}if(e&&s.label<e[2]){s.label=e[2],s.ops.push(i);break}e[2]&&s.ops.pop(),s.trys.pop();continue}i=C.call(_,s)}catch(l){i=[6,l],n=0}finally{f=e=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};function S(_){return P(this,void 0,void 0,function(){return b(this,function(C){return[2,new Promise(function(s,f){var n=indexedDB.open(_);n.onerror=function(){f(n.error)},n.onsuccess=function(){s(n.result)},n.onupgradeneeded=function(e){if(e.target){var u=n.result;u.objectStoreNames.contains("tabs")||u.createObjectStore("tabs",{keyPath:"id"})}}})]})})}}},D={};function g(y){var v=D[y];if(v!==void 0)return v.exports;var d=D[y]={exports:{}};return w[y](d,d.exports,g),d.exports}g.d=(y,v)=>{for(var d in v)g.o(v,d)&&!g.o(y,d)&&Object.defineProperty(y,d,{enumerable:!0,get:v[d]})},g.o=(y,v)=>Object.prototype.hasOwnProperty.call(y,v),g.r=y=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})};var L={};return(()=>{/*!*****************************!*\
  !*** ./public/lib/index.ts ***!
  \*****************************/g.r(L),g.d(L,{initClientWorker:()=>v.initClientWorker,initCrashDetection:()=>y.initCrashDetection,initDetectorWorker:()=>d.initDetectorWorker});var y=g("./public/lib/init.ts"),v=g("./public/lib/init.client.worker.ts"),d=g("./public/lib/init.detector.worker.ts")})(),L})())}},W={};function m(E){var w=W[E];if(w!==void 0)return w.exports;var D=W[E]={exports:{}};return x[E].call(D.exports,D,D.exports,m),D.exports}m.n=E=>{var w=E&&E.__esModule?()=>E.default:()=>E;return m.d(w,{a:w}),w},m.d=(E,w)=>{for(var D in w)m.o(w,D)&&!m.o(E,D)&&Object.defineProperty(E,D,{enumerable:!0,get:w[D]})},m.o=(E,w)=>Object.prototype.hasOwnProperty.call(E,w),(()=>{"use strict";var E=m(45928),w=m.n(E);(0,E.initDetectorWorker)({dbName:"grafana.crashes",interval:5e3,crashThreshold:5e3,staleThreshold:5e3})})()})();

//# sourceMappingURL=8220.aeea4a8f0893b3447b56.js.map