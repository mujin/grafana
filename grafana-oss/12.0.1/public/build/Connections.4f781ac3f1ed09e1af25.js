"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2154],{65064:(ne,I,s)=>{s.d(I,{A:()=>C});var e=s(74848),d=s(96540),g=s(18027),p=s(12737),v=s(45861),m=s(18552);class C extends d.PureComponent{render(){const{searchQuery:E,linkButton:S,setSearchQuery:i,target:P,placeholder:q="Search by name or type",sortPicker:j}=this.props,H={href:S?.href,disabled:S?.disabled};return P&&(H.target=P),(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(g.I,{grow:!0,children:(0,e.jsx)(p.Z,{value:E,onChange:i,placeholder:q})}),j&&(0,e.jsx)(m.r,{onChange:j.onChange,value:j.value,getSortOptions:j.getSortOptions}),S&&(0,e.jsx)(v.z9,{...H,children:S.title})]})}}},2248:(ne,I,s)=>{s.r(I),s.d(I,{default:()=>hs});var e=s(74848),d=s(54148),g=s(96673),p=s(26437),v=s(96540),m=s(11594),C=s(13791),O=s(6650),E=s(65223),S=s(23691),i=s(22803),P=s(36490),q=s(27489),j=s(63142),H=s(37386),_=s(77824),ie=s(45967),B=s(43243),K=s(6975),ee=s(50201),G=s(73427),Ee=s(70958),u=s(56840),y=s(40203),W=s(42135),V=s(84969),T=s(4476),ae=s(81687),R=s(62061),b=s(99887),oe=s(13943),A=s(8073),z=s(41654),N=s(4825),se=s(93984);const re=a=>({heading:(0,i.css)({fontSize:a.typography.h5.fontSize,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:a.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:a.typography.bodySmall.fontSize}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:a.spacing(3),marginLeft:a.spacing(1),width:a.spacing(7),maxHeight:a.spacing(7)})});function xe(){const a=(0,j.of)(se.X);return(0,R.a)("enterprise.plugins")?(0,e.jsx)(b.E,{text:(0,u.t)("get-enterprise.title","Enterprise"),color:"blue"}):(0,e.jsx)(b.E,{icon:"lock",role:"img","aria-label":(0,u.t)("lock-icon","lock icon"),text:(0,u.t)("get-enterprise.title","Enterprise"),color:"darkgrey",className:a,title:(0,u.t)("get-enterprise.requires-license","Requires a Grafana Enterprise license")})}const me=({items:a,onClickItem:n})=>{const o=(0,j.of)(re);return(0,e.jsx)(oe.x,{gap:1.5,minColumnWidth:44,children:a.map(r=>(0,e.jsxs)(A.Z,{className:o.card,href:r.url,onClick:l=>{n&&n(l,r)},children:[(0,e.jsx)(A.Z.Heading,{className:o.heading,children:r.name}),(0,e.jsx)(A.Z.Figure,{align:"center",className:o.figure,children:(0,e.jsx)("img",{className:o.logo,src:r.logo,alt:""})}),(0,e.jsx)(A.Z.Meta,{className:o.meta,children:(0,e.jsxs)(z.B,{height:"auto",wrap:"wrap",children:[r.isEnterprise&&(0,e.jsx)(xe,{}),r.isDeprecated&&(0,e.jsx)(N.yf,{}),r.isInstalled&&(0,e.jsx)(N.Jn,{}),r.isDisabled&&(0,e.jsx)(N.Df,{error:r.error}),(0,T.wD)(r)&&(0,e.jsx)(N.z$,{plugin:r})]})})]},r.id))})};var fe=s(30703);const ye=a=>({categoryHeader:(0,i.css)({alignItems:"center",display:"flex",marginBottom:a.spacing(3)}),categoryLabel:(0,i.css)({marginBottom:0,marginLeft:a.spacing(1)})}),Ce=({iconName:a,label:n})=>{const o=(0,j.of)(ye);return(0,e.jsxs)("div",{className:o.categoryHeader,children:[(0,e.jsx)(fe.I,{name:a,size:"xl"}),(0,e.jsx)("h3",{className:o.categoryLabel,children:n})]})};var Se=s(22787),f=s(45861);const U=a=>({modal:(0,i.css)({width:"500px"}),modalContent:(0,i.css)({overflow:"visible",color:a.colors.text.secondary,a:{color:a.colors.text.link}}),description:(0,i.css)({marginBottom:a.spacing(2)}),bottomSection:(0,i.css)({display:"flex",borderTop:`1px solid ${a.colors.border.weak}`,paddingTop:a.spacing(3),marginTop:a.spacing(3)}),actionsSection:(0,i.css)({display:"flex",justifyContent:"end",marginTop:a.spacing(3)}),warningIcon:(0,i.css)({color:a.colors.warning.main,paddingRight:a.spacing(),marginTop:a.spacing(.25)}),header:(0,i.css)({display:"flex",alignItems:"center"}),headerTitle:(0,i.css)({margin:0}),headerLogo:(0,i.css)({marginRight:a.spacing(2),width:"32px",height:"32px"})});function Z({item:a,isOpen:n,onDismiss:o}){const r=(0,j.of)(U);return(0,e.jsx)(Se.a,{className:r.modal,contentClassName:r.modalContent,title:(0,e.jsx)(Xe,{item:a}),isOpen:n,onDismiss:o,children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[a.description&&(0,e.jsx)("div",{className:r.description,children:a.description}),(0,e.jsxs)("div",{children:["Links",(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:`https://grafana.com/grafana/plugins/${a.id}`,title:`${a.name} on Grafana.com`,target:"_blank",rel:"noopener noreferrer",children:a.name})]})]}),(0,e.jsxs)("div",{className:r.bottomSection,children:[(0,e.jsx)("div",{className:r.warningIcon,children:(0,e.jsx)(fe.I,{name:"exclamation-triangle"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:(0,e.jsxs)(u.x6,{i18nKey:"connections.no-access-modal.editor-warning",children:["Editors cannot add new connections. You may check to see if it is already configured in"," ",(0,e.jsx)("a",{href:"/connections/datasources",children:"Data sources"}),"."]})}),(0,e.jsx)("p",{children:(0,e.jsx)(u.x6,{i18nKey:"connections.no-access-modal.connection-contact-grafana-admin",children:"To add a new connection, contact your Grafana admin."})})]})]}),(0,e.jsx)("div",{className:r.actionsSection,children:(0,e.jsx)(f.$n,{onClick:o,children:(0,e.jsx)(u.x6,{i18nKey:"connections.no-access-modal.okay",children:"Okay"})})})]})})}function Xe({item:a}){const n=(0,j.of)(U);return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:n.header,children:[a.logo&&(0,e.jsx)("img",{className:n.headerLogo,src:a.logo,alt:`logo of ${a.name}`}),(0,e.jsx)("h4",{className:n.headerTitle,children:a.name})]})})}const ke=a=>({spacer:(0,i.css)({height:a.spacing(2)}),modal:(0,i.css)({width:"500px"}),modalContent:(0,i.css)({overflow:"visible"}),actionBar:(0,i.css)({[a.breakpoints.up("xl")]:{marginLeft:"auto"}})});function Je(){const[a,n]=(0,Ee.s)(),o=a.search?String(a.search):"",[r,l]=(0,v.useState)(!1),[h,x]=(0,v.useState)(null),c=(0,d.zy)(),M=(0,ae.W)(),L=(0,P.SE)(c.search),k=L.sortBy||T.by.nameAsc,J=L.filterBy?.toString()||"all",te=G.TP.hasPermission(g.AccessControlAction.DataSourcesCreate),le=(0,j.of)(ke),Q=w=>{n({search:w})},ge=(0,S.pw)(),{error:Y,plugins:$,isLoading:he}=(0,S.PW)({keyword:o,type:m.QE.datasource,isInstalled:J==="installed"?!0:void 0,hasUpdate:J==="has-update"?!0:void 0},k),X=[{value:"all",label:"All"},{value:"installed",label:"Installed"},{value:"has-update",label:"New Updates"}],Me=(w,Qe)=>{te||(w.preventDefault(),w.stopPropagation(),Ie(Qe),(0,q.rR)("connections_plugin_card_clicked",{plugin_id:Qe.id,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}))},Ie=w=>{l(!0),x(w)},je=()=>{l(!1),x(null)},De=(0,v.useMemo)(()=>$.map(w=>({...w,logo:w.info.logos.small,url:p.b.DataSourcesDetails.replace(":id",w.id)})),[$]),pe=w=>{M.push({query:{sortBy:w.value}})},de=w=>{M.push({query:{filterBy:w}})},ps=(0,v.useMemo)(()=>!he&&!Y&&$.length<1,[he,Y,$]),xs=(0,u.t)("connections.connect-data.category-header-label","Data sources");return(0,e.jsxs)(e.Fragment,{children:[h&&(0,e.jsx)(Z,{item:h,isOpen:r,onDismiss:je}),(0,e.jsxs)(y.G,{wrap:!0,children:[(0,e.jsx)(H.D,{label:(0,u.t)("common.search","Search"),children:(0,e.jsx)(V.L,{value:o,onSearch:Q})}),(0,e.jsxs)(y.G,{className:le.actionBar,children:[ge?(0,e.jsx)(H.D,{label:(0,u.t)("plugins.filter.state","State"),children:(0,e.jsx)(_.z,{value:J,onChange:de,options:X})}):(0,e.jsx)(ie.m,{content:(0,u.t)("plugins.filter.disabled","This filter has been disabled because the Grafana server cannot access grafana.com"),placement:"top",children:(0,e.jsx)("div",{children:(0,e.jsx)(H.D,{label:(0,u.t)("plugins.filter.state","State"),children:(0,e.jsx)(_.z,{disabled:!0,value:J,onChange:de,options:X})})})}),(0,e.jsx)(H.D,{label:(0,u.t)("plugins.filter.sort","Sort"),children:(0,e.jsx)(B.G,{"aria-label":(0,u.t)("plugins.filter.sort-list","Sort Plugins List"),width:24,value:k?.toString(),onChange:pe,options:[{value:"nameAsc",label:"By name (A-Z)"},{value:"nameDesc",label:"By name (Z-A)"},{value:"updated",label:"By updated date"},{value:"published",label:"By published date"},{value:"downloads",label:"By downloads"}]})})]})]}),(0,e.jsx)(Ce,{iconName:"database",label:xs}),he?(0,e.jsx)(K._,{text:(0,u.t)("common.loading","Loading...")}):Y?(0,e.jsxs)(u.x6,{i18nKey:"alerting.policies.update-errors.error-code",values:{error:Y.message},children:['Error message: "',{error:Y.message},'"']}):(0,e.jsx)(me,{items:De,onClickItem:Me}),ps&&(0,e.jsx)(ee.p,{variant:"not-found",message:(0,u.t)("connections.connect-data.empty-message","No results matching your query were found")}),(0,e.jsx)(W.E,{})]})}function qe(){const{isLoading:a,updatablePlugins:n}=(0,S.sM)(),o=n.filter(M=>M.type===m.QE.datasource),[r,l]=(0,v.useState)(!1),h=o.length<=0||a,x=()=>{l(!0)},c=(0,e.jsx)(O.A,{disabled:h,onUpdateAll:x,updatablePluginsLength:o.length});return(0,e.jsx)(C.Y,{navId:"connections-add-new-connection",actions:c,children:(0,e.jsxs)(C.Y.Contents,{children:[(0,e.jsx)(Je,{}),(0,e.jsx)(E.A,{isOpen:r,isLoading:a,onDismiss:()=>l(!1),plugins:o})]})})}var ue=s(34999),Be=s(89640),_e=s(99553);function ea(){const a="standalone-plugin-page-/connections/add-new-connection",{id:n=""}=(0,d.g)(),l=!!(0,g.useSelector)(h=>h.navIndex)[a]?a:"connections-add-new-connection";return(0,e.jsx)(_e.V,{pluginId:n,navId:l,notFoundComponent:(0,e.jsx)(aa,{}),notFoundNavModel:{text:"Unknown datasource",subTitle:"No datasource with this ID could be found.",active:!0}})}function aa(){const{id:a}=(0,d.g)();return(0,e.jsx)(ue.F,{severity:g.AppNotificationSeverity.Warning,title:"",children:(0,e.jsxs)(u.x6,{i18nKey:"connections.not-found-datasource.body",children:["Maybe you mistyped the URL or the plugin with the id ",(0,e.jsx)(b.E,{text:a,color:"orange"})," is unavailable.",(0,e.jsx)("br",{}),"To see a list of available datasources please ",(0,e.jsx)(Be.Y,{href:p.b.AddNewConnection,children:"click here"}),"."]})})}var sa=s(51026),ve=s(43173),F=s(30918);function ta(){const a=G.TP.hasPermission(g.AccessControlAction.DataSourcesCreate),n=(0,v.useCallback)(()=>{(0,F.DO)({path:location.pathname})},[]);return a?(0,e.jsx)(f.z9,{icon:"plus",href:ve.$.appSubUrl+p.b.DataSourcesNew,onClick:n,children:(0,e.jsx)(u.x6,{i18nKey:"data-sources.datasource-add-button.label",children:"Add new data source"})}):null}var D=s(89573),Le=s(64048),Oe=s(2543),na=s(65064);const Pe="alpha-asc",Re="alpha-desc",oa=[{label:"Sort by A\u2013Z",value:Pe},{label:"Sort by Z\u2013A",value:Re}];function ra(){const a=(0,g.useDispatch)(),n=(0,v.useMemo)(()=>(0,Oe.debounce)(c=>{(0,F.ov)({query:c})},300),[]),o=(0,v.useCallback)(c=>{a((0,D.Bs)(c)),c&&n(c)},[a,n]),r=(0,g.useSelector)(({dataSources:c})=>(0,D.xs)(c)),l=(0,v.useCallback)(c=>a((0,D.Tk)(c.value===Pe)),[a]),h=(0,g.useSelector)(({dataSources:c})=>(0,D.lv)(c)),x={onChange:l,value:h?Pe:Re,getSortOptions:()=>Promise.resolve(oa)};return(0,e.jsx)(na.A,{searchQuery:r,setSearchQuery:o,sortPicker:x},"action-bar")}function ia(){const{isLoading:a}=(0,D.US)(),n=(0,g.useSelector)(x=>(0,D.zC)(x.dataSources)),o=(0,g.useSelector)(({dataSources:x})=>(0,D.wC)(x)),r=G.TP.hasPermission(g.AccessControlAction.DataSourcesCreate),l=G.TP.hasPermission(g.AccessControlAction.DataSourcesWrite),h=G.TP.hasAccessToExplore();return(0,e.jsx)(ca,{dataSources:n,dataSourcesCount:o,isLoading:a,hasCreateRights:r,hasWriteRights:l,hasExploreRights:h})}function ca({dataSources:a,dataSourcesCount:n,isLoading:o,hasCreateRights:r,hasWriteRights:l,hasExploreRights:h}){const x=(0,j.of)(la),c=(0,d.zy)();if((0,v.useEffect)(()=>{(0,F.kg)({grafana_version:ve.$.buildInfo.version,path:c.pathname})},[c]),!o&&n===0)return(0,e.jsx)(ee.p,{variant:"call-to-action",button:(0,e.jsx)(f.z9,{disabled:!r,href:p.b.DataSourcesNew,icon:"database",size:"lg",children:(0,e.jsx)(u.x6,{i18nKey:"data-source-list.empty-state.button-title",children:"Add data source"})}),message:(0,u.t)("data-source-list.empty-state.title","No data sources defined"),children:(0,e.jsxs)(u.x6,{i18nKey:"data-source-list.empty-state.pro-tip",children:["You can also define data sources through configuration files."," ",(0,e.jsx)(Be.Y,{external:!0,href:"http://docs.grafana.org/administration/provisioning/?utm_source=grafana_ds_list#data-sources",children:"Learn more"})]})});const M=()=>o?new Array(20).fill(null).map((L,k)=>(0,e.jsx)(Le.N.Skeleton,{hasExploreRights:h},k)):a.map(L=>(0,e.jsx)("li",{children:(0,e.jsx)(Le.N,{dataSource:L,hasWriteRights:l,hasExploreRights:h})},L.uid));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ra,{}),a.length===0&&!o?(0,e.jsx)(ee.p,{variant:"not-found",message:(0,u.t)("data-sources.empty-state.message","No data sources found")}):(0,e.jsx)("ul",{className:x.list,children:M()})]})}const la=a=>({list:(0,i.css)({listStyle:"none",display:"grid"})});function da(){const n=(0,g.useSelector)(({dataSources:o})=>(0,D.wC)(o))>0?(0,e.jsx)(ta,{}):void 0;return(0,e.jsx)(C.Y,{navId:"connections-datasources",actions:n,children:(0,e.jsxs)(C.Y.Contents,{children:[(0,e.jsx)(sa.l,{}),(0,e.jsx)(ia,{})]})})}var Ae=s(11098),Ue=s(85680),ua=s(37256),ga=s(32837);function ha({uid:a}){(0,D.oU)(a);const n=(0,g.useDispatch)(),o=(0,g.useSelector)(c=>c.dataSources.dataSource),r=(0,g.useSelector)(c=>c.plugins.dashboards),l=(0,g.useSelector)(c=>c.plugins.isLoadingPluginDashboards);(0,v.useEffect)(()=>{o.id>0&&n((0,ua.h9)())},[n,o.id]);const h=(c,M)=>{n((0,Ue.Q9)({pluginId:c.pluginId,path:c.path,overwrite:M,inputs:[{name:"*",type:"datasource",pluginId:o.type,value:o.name}]},c.title))},x=({uid:c})=>{n((0,Ue.TA)(c))};return(0,e.jsx)(pa,{dashboards:r,isLoading:l,onImportDashboard:h,onRemoveDashboard:x})}const pa=({isLoading:a,dashboards:n,onImportDashboard:o,onRemoveDashboard:r})=>a?(0,e.jsx)(Ae.A,{}):(0,e.jsx)(ga.A,{dashboards:n,onImport:o,onRemove:r});var Ke=s(78282),We=s(84057),be=s(52045),Te=s(99723);function ze(a){const{uid:n=""}=(0,d.g)(),o=(0,d.zy)(),r=(0,be.xw)(n),l=(0,be.S4)(r.type),h=(0,S.ob)(r.type),x=new URLSearchParams(o.search),c=a||x.get("page"),{plugin:M,loadError:L,loading:k}=(0,be._e)(),J=(0,Ke.l)()?.getInstanceSettings(n),te=!!(J?.meta?.alerting??!1),le=J?.type==="alertmanager",Q=te||le,ge=(0,g.useSelector)(X=>X.navIndex),Y=c?`datasource-${c}-${n}`:`datasource-settings-${n}`;let $={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(L){const X={text:L,subTitle:"Data Source Error",icon:"exclamation-triangle"};$={node:X,main:X}}return(k||!M)&&($=(0,We.tc)(ge,Y,(0,Te.$m)("settings"))),M&&($=(0,We.tc)(ge,Y,(0,Te.Vh)((0,Te.R4)(r,M),c||"settings"))),{navId:"connections-datasources",pageNav:{...$.main,dataSourcePluginName:h?.name||M?.meta.name||"",active:!0,text:r.name,subTitle:`Type: ${l.name}`,children:($.main.children||[]).map(X=>({...X,url:X.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:Q}}}function xa(){const{uid:a=""}=(0,d.g)(),{navId:n,pageNav:o}=ze("dashboards");return(0,e.jsx)(C.Y,{navId:n,pageNav:o,children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(ha,{uid:a})})})}var ma=s(57852),Fe=s(62392),fa=s(54092),va=s(33604),ja=s(45229),ce=s(85629),$e=s(18027),ya=s(63527),Sa=s(21285);function Da({dataSourceName:a,isDefault:n,onDefaultChange:o,onNameChange:r,disabled:l}){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"gf-form-group","aria-label":(0,u.t)("datasources.basic-settings.aria-label-datasource-settings-page-basic","Datasource settings page basic settings"),children:(0,e.jsxs)("div",{className:"gf-form-inline",children:[(0,e.jsx)("div",{className:"gf-form max-width-30",children:(0,e.jsx)($e.I,{label:(0,u.t)("datasources.basic-settings.label-name","Name"),tooltip:`The name is used when you select the data source in panels. The default data source is
              'preselected in new panels.`,grow:!0,disabled:l,labelWidth:14,children:(0,e.jsx)(ya.p,{id:"basic-settings-name",type:"text",value:a,placeholder:(0,u.t)("datasources.basic-settings.basic-settings-name-placeholder-name","Name"),onChange:h=>r(h.currentTarget.value),required:!0,"data-testid":ce.Tp.pages.DataSource.name})})}),(0,e.jsx)($e.I,{label:(0,u.t)("datasources.basic-settings.label-default","Default"),labelWidth:8,disabled:l,children:(0,e.jsx)(Sa.K,{id:"basic-settings-default",value:n,onChange:h=>{o(h.currentTarget.checked)}})})]})})})}function ms({enabled:a}){const n=useStyles2(Ea);return jsx("div",{className:n.badge,children:a?jsx(Badge,{color:"green",icon:"check-circle",text:t("datasources.alerting-enabled.text-alerting-supported","Alerting supported")}):jsx(Badge,{color:"orange",icon:"exclamation-triangle",text:t("datasources.alerting-enabled.text-alerting-not-supported","Alerting not supported")})})}const Ea=a=>({badge:css({marginBottom:a.spacing(2)})});function Ca({canSave:a,canDelete:n,onDelete:o,onSubmit:r,onTest:l}){return(0,e.jsxs)("div",{className:"gf-form-button-row",children:[(0,e.jsx)(f.$n,{type:"button",variant:"destructive",disabled:!n,onClick:o,"data-testid":ce.Tp.pages.DataSource.delete,children:(0,e.jsx)(u.x6,{i18nKey:"datasources.button-row.delete",children:"Delete"})}),a&&(0,e.jsx)(f.$n,{type:"submit",variant:"primary",disabled:!a,onClick:r,"data-testid":ce.Tp.pages.DataSource.saveAndTest,children:"Save & test"}),!a&&(0,e.jsx)(f.$n,{variant:"primary",onClick:l,children:(0,e.jsx)(u.x6,{i18nKey:"datasources.button-row.test",children:"Test"})})]})}var Pa=s(41607),Aa=s(36321),ba=s(65642);const Ta="datasources.settings.cloudInfoBox.isDismissed";function Na({dataSource:a}){let n="",o="";if(a.readOnly||(a.version??0)>2||ba.$W.buildInfo.edition!==Pa.r.OpenSource)return null;switch(a.type){case"prometheus":n="Prometheus",o="Loki";break;case"loki":n="Loki",o="Prometheus";break;default:return null}return(0,e.jsx)(Aa.b,{storageKey:Ta,defaultValue:!1,children:(r,l)=>r?null:(0,e.jsxs)(ue.F,{title:`Configure your ${n} data source below`,severity:"info",bottomSpacing:4,onRemove:()=>{l(!0)},children:["Or skip the effort and get ",n," (and ",o,") as fully-managed, scalable, and hosted data sources from Grafana Labs with the"," ",(0,e.jsx)("a",{className:"external-link",href:`https://grafana.com/signup/cloud/connect-account?src=grafana-oss&cnt=${a.type}-settings`,target:"_blank",rel:"noreferrer",title:(0,u.t)("datasources.cloud-info-box.title-includes-active-metrics-storage","The free plan includes 10k active metrics and 50gb storage."),children:"free-forever Grafana Cloud plan"}),"."]})})}const Ma="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function we(){return(0,e.jsx)(ue.F,{"data-testid":ce.Tp.pages.DataSource.readOnly,severity:"info",title:(0,u.t)("datasources.data-source-read-only-message.title-provisioned-data-source","Provisioned data source"),children:Ma})}function Ia({dataSourceRights:a,onDelete:n}){const{readOnly:o,hasDeleteRights:r}=a,l=!o&&r,h=()=>history.back();return(0,e.jsxs)(e.Fragment,{children:[o&&(0,e.jsx)(we,{}),(0,e.jsxs)("div",{className:"gf-form-button-row",children:[l&&(0,e.jsx)(f.$n,{type:"submit",variant:"destructive",onClick:n,children:(0,e.jsx)(u.x6,{i18nKey:"datasources.data-source-load-error.delete",children:"Delete"})}),(0,e.jsx)(f.$n,{variant:"secondary",fill:"outline",type:"button",onClick:h,children:(0,e.jsx)(u.x6,{i18nKey:"datasources.data-source-load-error.back",children:"Back"})})]})]})}const Ba="You are not allowed to modify this data source. Please contact your server admin to update this data source.";function La(){return(0,e.jsx)(ue.F,{severity:"info",title:(0,u.t)("datasources.data-source-missing-rights-message.title-missing-rights","Missing rights"),children:Ba})}function Oa({plugin:a,pageId:n}){if(!a||!a.configPages)return null;const o=a.configPages.find(({id:r})=>r===n);return o?(0,e.jsx)(o.body,{plugin:a,query:{}}):(0,e.jsxs)("div",{children:["Page not found: ",o]})}class Ra extends v.PureComponent{constructor(n){super(n),this.onModelChanged=o=>{this.props.onModelChange(o)},this.onModelChanged=this.onModelChanged.bind(this)}render(){const{plugin:n,dataSource:o}=this.props;return n?(0,e.jsx)("div",{children:n.components.ConfigEditor&&(0,v.createElement)(n.components.ConfigEditor,{options:o,onOptionsChange:this.onModelChanged})}):null}}var Ua=s(85622);function Ka({state:a}){return(0,e.jsxs)("div",{className:"gf-form",children:[(0,e.jsx)("div",{className:"gf-form-label width-10",children:(0,e.jsx)(u.x6,{i18nKey:"datasources.data-source-plugin-state.plugin-state",children:"Plugin state"})}),(0,e.jsx)("div",{className:"gf-form-label gf-form-label--transparent",children:(0,e.jsx)(Ua.p,{state:a})})]})}var Ne=s(20941);const Wa=(a,n)=>({content:(0,i.css)({color:a.colors.text.secondary,paddingTop:n?a.spacing(1):0,maxHeight:"50vh",overflowY:"auto"}),disabled:(0,i.css)({pointerEvents:"none",color:a.colors.text.secondary})}),Ge=({title:a,exploreUrl:n,dataSourceId:o,onDashboardLinkClicked:r})=>{const l=(0,j.$j)(),x=Wa(l,!!a),c=G.TP.hasAccessToExplore();return(0,e.jsx)("div",{className:x.content,children:(0,e.jsxs)(u.x6,{i18nKey:"data-source-testing-status-page.success-more-details-links",children:["Next, you can start to visualize data by"," ",(0,e.jsx)(Ne.N,{"aria-label":"Create a dashboard",href:`/dashboard/new-with-ds/${o}`,className:"external-link",onClick:r,children:"building a dashboard"}),", or by querying data in the"," ",(0,e.jsx)(Ne.N,{"aria-label":"Explore data",className:(0,i.cx)("external-link",{[`${x.disabled}`]:!c,"test-disabled":!c}),href:n,children:"Explore view"}),"."]})})};Ge.displayName="AlertSuccessMessage";const Ve=({link:a})=>{const n=(0,j.$j)(),o={content:(0,i.css)({color:n.colors.text.secondary,paddingBlock:n.spacing(1),maxHeight:"50vh",overflowY:"auto"})};return a?/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(a)?(0,e.jsx)("div",{className:o.content,children:(0,e.jsxs)(u.x6,{i18nKey:"data-source-testing-status-page.error-more-details-link",children:["Click"," ",(0,e.jsx)(Ne.N,{"aria-label":"More details about the error",className:"external-link",href:a,target:"_blank",rel:"noreferrer",children:"here"})," ","to learn more about this error."]})}):(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(e.Fragment,{})};Ve.displayName="ErrorDetailsLink";const za=new Set(["success","info","warning","error"]),Fa=a=>za.has(a),$a=a=>a.toLowerCase()==="ok"?"success":Fa(a)?a:"info";function wa({testingStatus:a,exploreUrl:n,dataSource:o}){const r=$a(a?.status??"error"),l=a?.message,h=a?.details?.message,x=a?.details?.verboseMessage,c=a?.details?.errorDetailsLink,M=()=>{(0,F.TR)({grafana_version:ve.$.buildInfo.version,datasource_uid:o.uid,plugin_name:o.typeName,path:location.pathname})},L=(0,j.of)(Ga);return l?(0,e.jsx)("div",{className:(0,i.cx)("gf-form-group",L.container),children:(0,e.jsx)(ue.F,{severity:r,title:l,"data-testid":ce.Tp.pages.DataSource.alert,children:a?.details&&(0,e.jsxs)(e.Fragment,{children:[h?(0,e.jsx)(e.Fragment,{children:String(h)}):null,r==="success"?(0,e.jsx)(Ge,{title:l,exploreUrl:n,dataSourceId:o.uid,onDashboardLinkClicked:M}):null,r==="error"&&c?(0,e.jsx)(Ve,{link:String(c)}):null,x?(0,e.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:String(x)}):null]})})}):null}const Ga=a=>({container:(0,i.css)({paddingTop:a.spacing(3)}),moreLink:(0,i.css)({marginBlock:a.spacing(1)})});function Va({uid:a,pageId:n}){(0,D.oU)(a);const o=(0,g.useDispatch)(),r=(0,D.xw)(a),l=(0,D.S4)(r.type),h=(0,D._e)(),x=(0,D.u1)(a),c=(0,D.Tn)(a),M=(0,D.$k)(),L=(0,D.BY)(a),k=(0,D.k9)(),J=Q=>o((0,D.C_)(Q)),te=Q=>o((0,D.rb)(Q)),le=Q=>o((0,D.jz)(Q));return(0,e.jsx)(Ya,{pageId:n,dataSource:r,dataSourceMeta:l,dataSourceSettings:h,dataSourceRights:x,exploreUrl:c,onDelete:M,onDefaultChange:J,onNameChange:te,onOptionsChange:le,onTest:L,onUpdate:k})}function Ya({pageId:a,dataSource:n,dataSourceMeta:o,dataSourceSettings:r,dataSourceRights:l,exploreUrl:h,onDelete:x,onDefaultChange:c,onNameChange:M,onOptionsChange:L,onTest:k,onUpdate:J}){const{plugin:te,loadError:le,testingStatus:Q,loading:ge}=r,{readOnly:Y,hasWriteRights:$,hasDeleteRights:he}=l,X=n.id>0,{components:Me,isLoading:Ie}=Ha(),je=(0,Ke.l)()?.getInstanceSettings(n.uid),De=async pe=>{pe.preventDefault(),(0,F._i)("save_and_test");try{await J({...n}),(0,F.m3)({item:"success"}),ja.A.publish(new ma.wE)}catch{(0,F.m3)({item:"fail"});return}k()};return le?(0,e.jsx)(Ia,{dataSourceRights:l,onDelete:()=>{(0,F._i)("delete"),x()}}):ge||Ie?(0,e.jsx)(Ae.A,{}):!X||!je?null:a?(0,e.jsx)(Fe.p,{instanceSettings:je,children:(0,e.jsx)(Oa,{pageId:a,plugin:te})}):(0,e.jsxs)("form",{onSubmit:De,children:[!$&&(0,e.jsx)(La,{}),Y&&(0,e.jsx)(we,{}),o.state&&(0,e.jsx)(Ka,{state:o.state}),(0,e.jsx)(Na,{dataSource:n}),(0,e.jsx)(Da,{dataSourceName:n.name,isDefault:n.isDefault,onDefaultChange:c,onNameChange:M,disabled:Y||!$}),te&&(0,e.jsx)(Fe.p,{instanceSettings:je,children:(0,e.jsx)(Ra,{plugin:te,dataSource:n,dataSourceMeta:o,onModelChange:L})}),Me.map(pe=>(0,e.jsx)("div",{children:(0,e.jsx)(pe,{context:{dataSource:(0,Oe.cloneDeep)(n),dataSourceMeta:o,testingStatus:Q,setJsonData:de=>L({...n,jsonData:{...n.jsonData,...de}}),setSecureJsonData:de=>L({...n,secureJsonData:{...n.secureJsonData,...de}})}})},pe.meta.id)),(0,e.jsx)(wa,{testingStatus:Q,exploreUrl:h,dataSource:n}),(0,e.jsx)(Ca,{onSubmit:De,onDelete:()=>{(0,F._i)("delete"),x()},onTest:()=>{(0,F._i)("test"),k()},canDelete:!Y&&he,canSave:!Y&&$})]})}function Ha(){const{components:a,isLoading:n}=(0,va.f)({extensionPointId:fa.S.DataSourceConfig});return(0,v.useMemo)(()=>({components:a.filter(r=>{switch(r.meta.pluginId){case"grafana-pdc-app":case"grafana-auth-app":return!0;default:return!1}}),isLoading:n}),[a,n])}var Za=s(62054);function Qa({uid:a}){const n=(0,D.xw)(a),o=G.TP.hasAccessToExplore();return(0,e.jsxs)(e.Fragment,{children:[o&&(0,e.jsx)(f.z9,{variant:"secondary",size:"sm",href:(0,Za.h)(n),onClick:()=>{(0,F._i)("explore"),(0,F.M1)({grafana_version:ve.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},children:(0,e.jsx)(u.x6,{i18nKey:"datasources.edit-data-source-actions.explore-data",children:"Explore data"})}),(0,e.jsx)(f.z9,{size:"sm",variant:"secondary",href:`dashboard/new-with-ds/${n.uid}`,onClick:()=>{(0,F._i)("build_a_dashboard"),(0,F.TR)({grafana_version:ve.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},children:(0,e.jsx)(u.x6,{i18nKey:"datasources.edit-data-source-actions.build-a-dashboard",children:"Build a dashboard"})})]})}const Xa=a=>{const n=[],o=a.alertingSupported;return n.push({label:"Type",value:a.dataSourcePluginName}),n.push({label:"Alerting",value:(0,e.jsx)(b.E,{color:o?"green":"red",text:o?"Supported":"Not supported"})}),n};function ka({title:a}){const n=(0,j.of)(Ja);return(0,e.jsx)("div",{className:n.container,children:(0,e.jsx)("h1",{className:n.title,children:a})})}const Ja=a=>({container:(0,i.css)({marginBottom:a.spacing(2),h1:{display:"inline-block"}}),title:(0,i.css)({display:"inline-block",margin:"0 0 0 0",maxWidth:"40vw",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});function qa({uid:a,pageId:n}){const{navId:o,pageNav:r,dataSourceHeader:l}=ze(),h=Xa({dataSourcePluginName:r.dataSourcePluginName,alertingSupported:l.alertingSupported});return(0,e.jsx)(C.Y,{navId:o,pageNav:r,renderTitle:x=>(0,e.jsx)(ka,{title:x}),info:h,actions:(0,e.jsx)(Qa,{uid:a}),children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(Va,{uid:a,pageId:n})})})}const _a=qa;function es(){const{uid:a=""}=(0,d.g)(),n=(0,d.zy)(),r=new URLSearchParams(n.search).get("page");return(0,e.jsx)(_a,{uid:a,pageId:r})}var as=s(12737),Ye=s(5585),He=s(63509);function ss({filterByPluginType:a}){let n=(0,S.F9)(a);const{isLoading:o}=(0,S.m5)(),r=(0,j.of)(ns);return o||n.length===0?null:(0,e.jsxs)(ue.F,{title:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins.","data-testid":ce.Tp.pages.PluginsList.signatureErrorNotice,severity:"warning",children:[(0,e.jsx)("p",{children:"The following plugins are disabled and not shown in the list below:"}),(0,e.jsx)(Ye.B,{items:n,className:r.list,renderItem:l=>(0,e.jsx)("div",{className:r.wrapper,children:(0,e.jsxs)(z.B,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)("strong",{children:l.pluginId}),(0,e.jsx)(He.B,{status:ts(l.errorCode),className:r.badge})]})})}),(0,e.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",className:r.docsLink,target:"_blank",rel:"noreferrer",children:[(0,e.jsx)(fe.I,{name:"book"})," Read more about plugin signing"]})]})}function ts(a){switch(a){case m.ZK.invalidSignature:return m.Ac.invalid;case m.ZK.missingSignature:return m.Ac.missing;case m.ZK.modifiedSignature:return m.Ac.modified;default:return m.Ac.missing}}function ns(a){return{list:(0,i.css)({listStyleType:"circle"}),wrapper:(0,i.css)({marginTop:a.spacing(1)}),badge:(0,i.css)({marginTop:0}),docsLink:(0,i.css)({display:"inline-block",color:a.colors.text.link,marginTop:a.spacing(2)})}}function os({onClick:a,dataSourcePlugin:n}){const o=n.module==="phantom",r=!o&&!n.unlicensed,l=n.info?.links?.length>0?n.info.links[0]:null,h=l?.target??"_blank",x=(0,j.of)(rs);return(0,e.jsxs)(A.Z,{className:(0,i.cx)(x.card,"card-parent"),onClick:r?a:()=>{},children:[(0,e.jsx)(A.Z.Heading,{className:x.heading,"aria-label":ce.Tp.pages.AddDataSource.dataSourcePluginsV2(n.name),children:n.name}),(0,e.jsx)(A.Z.Figure,{align:"center",className:x.figure,children:(0,e.jsx)("img",{className:x.logo,src:n.info.logos.small,alt:""})}),(0,e.jsx)(A.Z.Description,{className:x.description,children:n.info.description}),!o&&(0,e.jsx)(A.Z.Meta,{className:x.meta,children:(0,e.jsx)(He.B,{status:n.signature})}),(0,e.jsx)(A.Z.Actions,{className:x.actions,children:l&&(0,e.jsx)(f.z9,{"aria-label":`${n.name}, learn more.`,href:`${l.url}?utm_source=grafana_add_ds`,onClick:c=>c.stopPropagation(),rel:"noopener",target:h,variant:"secondary",children:l.name})})]})}function rs(a){return{heading:(0,i.css)({fontSize:a.v1.typography.heading.h5,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:a.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:a.typography.size.sm}),actions:(0,i.css)({position:"relative",alignSelf:"center",marginTop:"0px",opacity:0,".card-parent:hover &, .card-parent:focus-within &":{opacity:1}}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:a.v1.spacing.lg,marginLeft:a.v1.spacing.sm,width:a.spacing(7),maxHeight:a.spacing(7)})}}function Ze({dataSourcePlugins:a,onClickDataSourceType:n}){return!a||!a.length?null:(0,e.jsx)(Ye.B,{items:a,getItemKey:o=>o.id.toString(),renderItem:o=>(0,e.jsx)(os,{dataSourcePlugin:o,onClick:()=>n(o)}),className:(0,i.css)({"> li":{marginBottom:"2px"}})})}function is({categories:a,onClickDataSourceType:n}){const o=`${p.b.AddNewConnection}?cat=data-source`,r=(0,j.of)(cs),l=(0,v.useCallback)(()=>{(0,q.rR)("connections_add_datasource_find_more_ds_plugins_clicked",{targetPath:o,path:location.pathname,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},[o]);return(0,e.jsxs)(e.Fragment,{children:[a.map(({id:h,title:x,plugins:c})=>(0,e.jsxs)("div",{className:r.category,children:[(0,e.jsx)("div",{className:r.header,id:h,children:x}),(0,e.jsx)(Ze,{dataSourcePlugins:c,onClickDataSourceType:n})]},h)),(0,e.jsx)("div",{className:r.more,children:(0,e.jsx)(f.z9,{variant:"secondary",href:o,onClick:l,target:"_self",rel:"noopener",children:(0,e.jsx)(u.x6,{i18nKey:"datasources.data-source-categories.find-more-data-source-plugins",children:"Find more data source plugins"})})})]})}const cs=a=>({category:(0,i.css)({marginBottom:a.spacing(2)}),header:(0,i.css)({fontSize:a.typography.h5.fontSize,marginBottom:a.spacing(1)}),more:(0,i.css)({margin:a.spacing(4),textAlign:"center"})});function ls(){(0,D.hx)();const a=(0,g.useDispatch)(),n=(0,g.useSelector)(c=>(0,D.hp)(c.dataSources)),o=(0,g.useSelector)(c=>c.dataSources.dataSourceTypeSearchQuery),r=(0,g.useSelector)(c=>c.dataSources.isLoadingDataSourcePlugins),l=(0,g.useSelector)(c=>c.dataSources.categories),h=(0,D.Um)(),x=c=>a((0,D.eB)(c));return(0,e.jsx)(ds,{dataSources:n,dataSourceCategories:l,searchQuery:o,isLoading:r,onAddDataSource:h,onSetSearchQuery:x})}function ds({dataSources:a,dataSourceCategories:n,searchQuery:o,isLoading:r,onAddDataSource:l,onSetSearchQuery:h}){return r?(0,e.jsx)(Ae.A,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(as.Z,{value:o,onChange:h,placeholder:(0,u.t)("datasources.new-data-source-view.placeholder-filter-by-name-or-type","Filter by name or type")}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),(0,e.jsx)(f.z9,{href:p.b.DataSources,fill:"outline",variant:"secondary",icon:"arrow-left",children:(0,e.jsx)(u.x6,{i18nKey:"datasources.new-data-source-view.cancel",children:"Cancel"})})]}),!o&&(0,e.jsx)(ss,{filterByPluginType:m.QE.datasource}),(0,e.jsxs)("div",{children:[o&&(0,e.jsx)(Ze,{dataSourcePlugins:a,onClickDataSourceType:l}),!o&&(0,e.jsx)(is,{categories:n,onClickDataSourceType:l})]})]})}function us(){return(0,e.jsx)(C.Y,{navId:"connections-datasources",pageNav:{text:"Add data source",subTitle:"Choose a data source type",active:!0},children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(ls,{})})})}function gs(){const{search:a}=(0,d.zy)();return(0,e.jsx)(d.C5,{replace:!0,to:{pathname:p.b.AddNewConnection,search:a}})}function hs(){const n=!!(0,g.useSelector)(o=>o.navIndex)["standalone-plugin-page-/connections/add-new-connection"];return(0,e.jsxs)(d.BV,{children:[(0,e.jsx)(d.qh,{caseSensitive:!0,path:"/",element:(0,e.jsx)(d.C5,{replace:!0,to:p.b.AddNewConnection})}),(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.DataSources.replace(p.b.Base,""),element:(0,e.jsx)(da,{})}),(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.DataSourcesNew.replace(p.b.Base,""),element:(0,e.jsx)(us,{})}),(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.DataSourcesDetails.replace(p.b.Base,""),element:(0,e.jsx)(ea,{})}),(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.DataSourcesEdit.replace(p.b.Base,""),element:(0,e.jsx)(es,{})}),(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.DataSourcesDashboards.replace(p.b.Base,""),element:(0,e.jsx)(xa,{})}),!n&&(0,e.jsx)(d.qh,{caseSensitive:!0,path:p.b.AddNewConnection.replace(p.b.Base,""),element:(0,e.jsx)(qe,{})}),(0,e.jsx)(d.qh,{path:p.b.ConnectDataOutdated.replace(p.b.Base,""),element:(0,e.jsx)(gs,{})}),(0,e.jsx)(d.qh,{path:"/your-connections/:page",element:(0,e.jsx)(d.C5,{replace:!0,to:`${p.b.Base}/:page`})}),(0,e.jsx)(d.qh,{path:p.b.YourConnectionsOutdated.replace(p.b.Base,""),element:(0,e.jsx)(d.C5,{replace:!0,to:p.b.DataSources})}),(0,e.jsx)(d.qh,{element:(0,e.jsx)(d.C5,{replace:!0,to:"/notfound"})})]})}},51026:(ne,I,s)=>{s.d(I,{l:()=>q});var e=s(74848),d=s(22803),g=s(96540),p=s(43173),v=s(55315),m=s(63142),C=s(34999),O=s(45861),E=s(73427),S=s(56840);const i=j=>({alertContent:(0,d.css)({display:"flex",flexDirection:"row",padding:0,justifyContent:"space-between",alignItems:"center"}),alertParagraph:(0,d.css)({margin:j.spacing(0,1,0,0),lineHeight:j.spacing(j.components.height.sm)})}),P=new v.X("advisor-redirect-notice");function q(){const j=(0,m.of)(i),_=(E.TP.hasRole("Admin")||E.TP.isGrafanaAdmin)&&p.$.featureToggles.grafanaAdvisor,[ie,B]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{_&&P.getItem("showNotice").then(K=>{K!=="false"&&B(!0)})},[_]),ie?(0,e.jsx)(C.F,{severity:"info",title:"",onRemove:()=>{P.setItem("showNotice","false"),B(!1)},children:(0,e.jsxs)("div",{className:j.alertContent,children:[(0,e.jsx)("p",{className:j.alertParagraph,children:(0,e.jsx)(S.x6,{i18nKey:"connections.advisor-redirect-notice.body",children:"Try the new Advisor to uncover potential issues with your data sources and plugins."})}),(0,e.jsx)(O.z9,{"aria-label":(0,S.t)("connections.advisor-redirect-notice.aria-label-link-to-advisor","Link to Advisor"),icon:"arrow-right",href:"/a/grafana-advisor-app",fill:"text",children:(0,e.jsx)(S.x6,{i18nKey:"connections.advisor-redirect-notice.go-to-advisor",children:"Go to Advisor"})})]})}):(0,e.jsx)(e.Fragment,{})}},85680:(ne,I,s)=>{s.d(I,{Bz:()=>H,Q9:()=>q,Ss:()=>ie,TA:()=>j,lC:()=>_});var e=s(68143),d=s(6890),g=s(64762),p=s(18646),v=s(79718),m=s(89224),C=s(69289),O=s(37256),E=s(39167),S=s(22429),i=s(75421),P=s(37918);function q(B,K){return async ee=>{await(0,e.AI)().post("/api/dashboards/import",B),ee((0,d.dx)((0,g.tZ)("Dashboard Imported",K))),ee((0,O.h9)())}}function j(B){return async K=>{await(0,p.n)().deleteDashboard(B,!1),K((0,O.h9)())}}const H=()=>(B,K)=>{const G=K().dashboard.getModel();G&&(G.destroy(),B((0,E.Y7)(G.uid))),(0,i.jG)().stopAutoRefresh(),B((0,P.p0)()),B((0,m.rG)()),v.t.leave(),(0,S.UA)().setCurrent(void 0)},_=B=>K=>{K((0,C.Cj)(B)),(0,i.jG)().refreshTimeModel()},ie=B=>K=>{K((0,C.xu)(B)),(0,i.jG)().refreshTimeModel()}},42135:(ne,I,s)=>{s.d(I,{E:()=>m});var e=s(74848),d=s(27489),g=s(35137),p=s(89640),v=s(56840);const m=()=>(0,e.jsxs)("div",{children:[(0,e.jsx)(g.$,{v:2}),(0,e.jsx)(p.Y,{href:"https://github.com/grafana/grafana/issues/new?assignees=&labels=area%2Fdatasource%2Ctype%2Fnew-plugin-request&projects=&template=3-data_source_request.yaml&title=%5BNew+Data+Source%5D%3A+%3Cname-of-service%3E",onClick:()=>(0,d.rR)("connections_data_source_request_clicked"),external:!0,children:(0,e.jsx)(v.x6,{i18nKey:"connections.connect-data.request-data-source",children:"Request a new data source"})}),(0,e.jsx)("br",{}),(0,e.jsx)(p.Y,{href:"https://github.com/orgs/grafana/projects/619/views/1?pane=info",onClick:()=>(0,d.rR)("connections_data_source_roadmap_clicked"),external:!0,children:(0,e.jsx)(v.x6,{i18nKey:"connections.connect-data.roadmap",children:"View roadmap"})})]})},84969:(ne,I,s)=>{s.d(I,{L:()=>C});var e=s(74848),d=s(96540),g=s(40996),p=s(12737),v=s(56840);const m=(O,E=0,S=[])=>{const i=(0,d.useRef)(!0),P=[...S,i];return(0,g.A)(()=>{if(i.current){i.current=!1;return}return O()},E,P)},C=({value:O,onSearch:E})=>{const[S,i]=(0,d.useState)(O);return m(()=>E(S??""),500,[S]),(0,e.jsx)(p.Z,{value:S,onKeyDown:P=>{(P.key==="Enter"||P.keyCode===13)&&E(P.currentTarget.value)},placeholder:(0,v.t)("plugins.search-field.placeholder-search-grafana-plugins","Search Grafana plugins"),onChange:P=>{i(P)},width:46})}},6650:(ne,I,s)=>{s.d(I,{A:()=>v});var e=s(74848),d=s(45861),g=s(56840);const v=({disabled:m,onUpdateAll:C,updatablePluginsLength:O})=>(0,e.jsx)(d.$n,{disabled:m,onClick:C,children:m?(0,e.jsx)(g.x6,{i18nKey:"plugins.catalog.no-updates-available",children:"No updates available"}):(0,e.jsxs)(g.x6,{i18nKey:"plugins.catalog.update-all.button",values:{length:O},children:["Update all (",{length},")"]})})},65223:(ne,I,s)=>{s.d(I,{U:()=>ee,A:()=>u});var e=s(74848),d=s(96540),g=s(27489),p=s(43173),v=s(71599),m=s(56840),C=s(23691),O=s(13660),E=s(22803),S=s(63142),i=s(45967),P=s(30703),q=s(68079),j=s(50201),H=s(32635);const _=y=>({table:(0,E.css)({marginTop:y.spacing(2),width:"100%",borderCollapse:"collapse"}),tableRow:(0,E.css)({borderBottom:`1px solid ${y.colors.border.weak}`,td:{paddingRight:y.spacing(1)}}),icon:(0,E.css)({display:"flex",justifyContent:"center",alignItems:"center"}),header:(0,E.css)({textAlign:"left",padding:y.spacing(1),borderBottom:`2px solid ${y.colors.border.strong}`,th:{paddingRight:y.spacing(1)}}),data:(0,E.css)({padding:"10px"}),footer:(0,E.css)({fontSize:y.typography.bodySmall.fontSize,marginTop:y.spacing(3)}),noPluginsMessage:(0,E.css)({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}),tableContainer:(0,E.css)({overflowY:"auto",overflowX:"hidden",maxHeight:y.spacing(41),marginBottom:y.spacing(2)}),errorIcon:(0,E.css)({color:y.colors.error.main}),successIcon:(0,E.css)({color:y.colors.success.main}),pluginsInstalled:(0,E.css)({svg:{marginRight:y.spacing(1)}})}),ie=({id:y,inProgress:W,isSelected:V,isInstalled:T,errorMap:ae})=>{const R=(0,S.of)(_);return ae&&ae.has(y)?(0,e.jsx)(i.m,{content:`${(0,m.t)("plugins.catalog.update-all.error","Error updating plugin:")} ${ae.get(y)?.message}`,children:(0,e.jsx)(P.I,{className:R.errorIcon,size:"xl",name:"exclamation-triangle"})}):T?(0,e.jsx)(P.I,{className:R.successIcon,size:"xl",name:"check"}):W&&V?(0,e.jsx)(q.y,{}):""},B=({plugins:y,pluginsNotInstalled:W,inProgress:V,selectedPlugins:T,onCheckboxChange:ae,errorMap:R})=>{const b=(0,S.of)(_),oe=y.length-W.size,A=y.length!==W.size&&!V;return(0,e.jsx)("div",{children:y.length===0?(0,e.jsx)(j.p,{variant:"completed",message:(0,m.t)("plugins.catalog.update-all.all-plugins-updated","All plugins updated!")}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.header",children:"The following plugins have update available"})}),(0,e.jsx)("div",{className:b.tableContainer,children:(0,e.jsxs)("table",{className:b.table,children:[(0,e.jsx)("thead",{className:b.header,children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.update-header",children:"Update"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.name-header",children:"Name"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.installed-header",children:"Installed"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.available-header",children:"Available"})}),(0,e.jsx)("th",{})]})}),(0,e.jsx)("tbody",{children:y.map(({id:z,name:N,installedVersion:se,latestVersion:re})=>(0,e.jsxs)("tr",{className:b.tableRow,children:[(0,e.jsx)("td",{children:(0,e.jsx)(H.S,{onChange:()=>ae(z),value:T?.has(z),disabled:!W.has(z)})}),(0,e.jsx)("td",{children:N}),(0,e.jsx)("td",{children:se}),(0,e.jsx)("td",{children:re}),(0,e.jsx)("td",{className:b.icon,children:(0,e.jsx)(ie,{id:z,inProgress:V,isSelected:T?.has(z)??!1,isInstalled:!W.has(z),errorMap:R})})]},z))})]})}),oe>0&&A&&(0,e.jsxs)("div",{className:b.pluginsInstalled,children:[(0,e.jsx)(P.I,{className:b.successIcon,size:"lg",name:"check"}),`${oe} ${(0,m.t)("plugins.catalog.update-all.update-status-text","plugins updated")}`]}),R.size>0&&A&&(0,e.jsxs)("div",{className:b.pluginsInstalled,children:[(0,e.jsx)(P.I,{className:b.errorIcon,size:"lg",name:"exclamation-triangle"}),`${R.size} ${(0,m.t)("plugins.catalog.update-all.error-status-text","failed - see error messages")}`]}),p.$.pluginAdminExternalManageEnabled&&(0,e.jsx)("footer",{className:b.footer,children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.cloud-update-message",children:"* It may take a few minutes for the plugins to be available for usage."})})]})})},K="plugins_update_all_clicked",ee=({isOpen:y,onDismiss:W,isLoading:V,plugins:T})=>{const ae=(0,C.xX)(),{error:R}=(0,C.XN)(),[b,oe]=(0,d.useState)(new Map),[A,z]=(0,d.useState)(!1),[N,se]=(0,d.useState)(),re=(0,d.useRef)(T),xe=(0,d.useMemo)(()=>new Set(T.map(f=>f.id)),[T]),me=T.length;(0,d.useEffect)(()=>{re.current.length===0&&(re.current=[...T])},[T]),(0,d.useEffect)(()=>{A&&(N?.forEach(f=>{xe.has(f)||se(U=>{const Z=new Set(U);return Z.delete(f),Z})}),N?.size===0&&z(!1))},[A,xe,N]),(0,d.useEffect)(()=>{if(N===void 0&&T.length>0&&!V){const f=new Set(T.map(U=>U.id));se(f)}},[V,T,N]),(0,d.useEffect)(()=>{A&&R&&!b.has(R.id)&&N?.has(R.id)&&(oe(f=>{const U=new Map(f);return U.set(R.id,R),U}),se(f=>{const U=new Set(f);return U.delete(R.id),U}))},[R,b,A,N]);const fe=async()=>{if(!A)if((0,g.rR)(K,{path:location.pathname,count:N?.size,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),z(!0),p.$.pluginAdminExternalManageEnabled)for(let f of T)N?.has(f.id)&&await ae(f.id,f.latestVersion,O.u8.UPDATE);else T.forEach(f=>{N?.has(f.id)&&ae(f.id,f.latestVersion,O.u8.UPDATE)})},ye=()=>{re.current=[],oe(new Map),z(!1),se(void 0),W()},Ce=f=>{se(U=>{const Z=new Set(U);return Z.has(f)?Z.delete(f):Z.add(f),Z}),b.has(f)&&oe(U=>{const Z=new Map(U);return Z.delete(f),Z})},Se=N?.size||0;return(0,e.jsx)(v.u,{isOpen:y,title:(0,m.t)("plugins.catalog.update-all.modal-title","Update Plugins"),body:(0,e.jsx)(B,{plugins:re.current,pluginsNotInstalled:xe,inProgress:A,errorMap:b,onCheckboxChange:Ce,selectedPlugins:N}),onConfirm:me>0?fe:ye,onDismiss:ye,disabled:Ee(A,me,Se),confirmText:G(me,A,Se),confirmButtonVariant:"primary"})};function G(y,W,V){return W?(0,m.t)("plugins.catalog.update-all.modal-in-progress","Updating..."):y>0?(0,m.t)("plugins.catalog.update-all.modal-confirmation","Update")+` (${V})`:(0,m.t)("plugins.catalog.update-all.modal-dismiss","Close")}function Ee(y,W,V){return!!(y||W>0&&V===0)}const u=ee},81687:(ne,I,s)=>{s.d(I,{W:()=>d});var e=s(36490);const d=()=>({push:({query:g})=>{e.Ny.partial(g)}})}}]);

//# sourceMappingURL=Connections.4f781ac3f1ed09e1af25.js.map