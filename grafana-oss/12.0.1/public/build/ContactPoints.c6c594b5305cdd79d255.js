"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4312],{43730:(w,O,t)=>{t.d(O,{E3:()=>L,vj:()=>j});const e=`{{ define "__subject" }}[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ if gt (.Alerts.Resolved | len) 0 }}, RESOLVED:{{ .Alerts.Resolved | len }}{{ end }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join " " }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join " " }}{{ end }}){{ end }}{{ end }}

{{ define "__text_values_list" }}{{ if len .Values }}{{ $first := true }}{{ range $refID, $value := .Values -}}
{{ if $first }}{{ $first = false }}{{ else }}, {{ end }}{{ $refID }}={{ $value }}{{ end -}}
{{ else }}[no value]{{ end }}{{ end }}

{{ define "__text_alert_list" }}{{ range . }}
Value: {{ template "__text_values_list" . }}
Labels:
{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}Annotations:
{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}{{ if gt (len .GeneratorURL) 0 }}Source: {{ .GeneratorURL }}
{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: {{ .SilenceURL }}
{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: {{ .DashboardURL }}
{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: {{ .PanelURL }}
{{ end }}{{ end }}{{ end }}

{{ define "default.title" }}{{ template "__subject" . }}{{ end }}

{{ define "default.message" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**
{{ template "__text_alert_list" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}

{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**
{{ template "__text_alert_list" .Alerts.Resolved }}{{ end }}{{ end }}

{{ define "__teams_text_alert_list" }}{{ range . }}
Value: {{ template "__text_values_list" . }}
Labels:
{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}
Annotations:
{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}
{{ if gt (len .GeneratorURL) 0 }}Source: [{{ .GeneratorURL }}]({{ .GeneratorURL }})

{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: [{{ .SilenceURL }}]({{ .SilenceURL }})

{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: [{{ .DashboardURL }}]({{ .DashboardURL }})

{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: [{{ .PanelURL }}]({{ .PanelURL }})

{{ end }}
{{ end }}{{ end }}

{{ define "teams.default.message" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**
{{ template "__teams_text_alert_list" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}

{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**
{{ template "__teams_text_alert_list" .Alerts.Resolved }}{{ end }}{{ end }}`;var f=t(87988),C=t(5709);const N=["TemplateGroup"],i=C.H.enhanceEndpoints({addTagTypes:N}).injectEndpoints({endpoints:c=>({listNamespacedTemplateGroup:c.query({query:n=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${n.namespace}/templategroups`,params:{pretty:n.pretty,allowWatchBookmarks:n.allowWatchBookmarks,continue:n.continue,fieldSelector:n.fieldSelector,labelSelector:n.labelSelector,limit:n.limit,resourceVersion:n.resourceVersion,resourceVersionMatch:n.resourceVersionMatch,sendInitialEvents:n.sendInitialEvents,timeoutSeconds:n.timeoutSeconds,watch:n.watch}}),providesTags:["TemplateGroup"]}),createNamespacedTemplateGroup:c.mutation({query:n=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${n.namespace}/templategroups`,method:"POST",body:n.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup,params:{pretty:n.pretty,dryRun:n.dryRun,fieldManager:n.fieldManager,fieldValidation:n.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),readNamespacedTemplateGroup:c.query({query:n=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${n.namespace}/templategroups/${n.name}`,params:{pretty:n.pretty}}),providesTags:["TemplateGroup"]}),replaceNamespacedTemplateGroup:c.mutation({query:n=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${n.namespace}/templategroups/${n.name}`,method:"PUT",body:n.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup,params:{pretty:n.pretty,dryRun:n.dryRun,fieldManager:n.fieldManager,fieldValidation:n.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deleteNamespacedTemplateGroup:c.mutation({query:n=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${n.namespace}/templategroups/${n.name}`,method:"DELETE",body:n.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:n.pretty,dryRun:n.dryRun,gracePeriodSeconds:n.gracePeriodSeconds,orphanDependents:n.orphanDependents,propagationPolicy:n.propagationPolicy}}),invalidatesTags:["TemplateGroup"]})}),overrideExisting:!1}),u="/api/alertmanager/grafana/config/api/v1/templates/test";i.enhanceEndpoints({endpoints:{readNamespacedTemplateGroup:c=>{const n={hideErrorMessage:!0};c.extraOptions=n}}});const L=i.injectEndpoints({endpoints:c=>({previewTemplate:c.mutation({query:({template:n,alerts:d,name:y})=>({url:u,data:{template:n,alerts:d,name:y},method:"POST"})}),getDefaultTemplates:c.query({queryFn:async()=>({data:(0,f.D)(e)})})})}),{usePreviewTemplateMutation:j}=L},24898:(w,O,t)=>{t.d(O,{_:()=>i});var e=t(74848),f=t(2543),C=t.n(f),N=t(16692);const i=({actions:d,children:y})=>{const r=(0,f.filter)(d,c),o=(0,f.filter)(d,n);return r.length?(0,e.jsx)(u,{actions:r,children:y}):o.length?(0,e.jsx)(L,{actions:o,children:y}):null},u=({actions:d,children:y})=>{const r=(0,N.iI)();return j(r,d)?(0,e.jsx)(e.Fragment,{children:y}):null},L=({actions:d,children:y})=>{const r=(0,N.e2)();return j(r,d)?(0,e.jsx)(e.Fragment,{children:y}):null};function j(d,y){return(0,f.chain)(d).pick(y).values().value().some(([r,o])=>o===!0)}function c(d){return Object.values(N.QI).includes(d)}function n(d){return Object.values(N.RY).includes(d)}},46787:(w,O,t)=>{t.r(O),t.d(O,{ActiveTab:()=>_,ContactPointsPageContents:()=>re,default:()=>De});var e=t(74848),f=t(96540),C=t(6975),N=t(50201),i=t(45861),u=t(41654),L=t(34999),j=t(66404),c=t(54314),n=t(60208),d=t(13941),y=t(34213),r=t(73427),o=t(56840),J=t(56476),b=t(77256),s=t(96673),a=t(16692),g=t(74048),h=t(20962),p=t(5358),E=t(52161),D=t(88547),z=t(36826),W=t(58750),Q=t(24961),k=t(25992),X=t(63142),m=t(71599),S=t(45967),K=t(99887),G=t(64762),P=t(16194),$=t(24898),I=t(27911),T=t(12266),H=t(40165),ae=t(1972),Z=t(40403),q=t(71774),ce=t(1332);const de=({alertManagerName:l,templates:x})=>{const R=(0,G._2)(),[F]=(0,Z._3)({alertmanager:l}),M=(0,X.of)(I.L),[v,V]=(0,f.useState)(),U=async()=>{if(v)try{await F.execute({uid:v.uid}),R.success("Template deleted",`Template ${v.title} has been deleted`)}catch(A){R.error("Error deleting template",`Error deleting template ${v.title}`);const B=A instanceof Error?A:new Error((0,b.JZ)(A));(0,k.vV)(B)}V(void 0)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("table",{className:M.table,"data-testid":"templates-table",children:[(0,e.jsxs)("colgroup",{children:[(0,e.jsx)("col",{className:M.colExpand}),(0,e.jsx)("col",{}),(0,e.jsx)("col",{})]}),(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{}),(0,e.jsx)("th",{children:(0,e.jsx)(o.x6,{i18nKey:"alerting.templates-table.template-group",children:"Template group"})}),(0,e.jsx)($._,{actions:[a.QI.CreateNotificationTemplate,a.QI.UpdateNotificationTemplate,a.QI.DeleteNotificationTemplate],children:(0,e.jsx)("th",{children:(0,e.jsx)(o.x6,{i18nKey:"alerting.templates-table.actions",children:"Actions"})})})]})}),(0,e.jsxs)("tbody",{children:[!x.length&&(0,e.jsx)("tr",{className:M.evenRow,children:(0,e.jsx)("td",{colSpan:3,children:(0,e.jsx)(o.x6,{i18nKey:"alerting.templates-table.no-templates-defined",children:"No templates defined."})})}),x.map((A,B)=>(0,e.jsx)(pe,{notificationTemplate:A,idx:B,alertManagerName:l,onDeleteClick:V},A.uid))]})]}),!!v&&(0,e.jsx)(m.u,{isOpen:!0,title:(0,o.t)("alerting.templates-table.title-delete-template-group","Delete template group"),body:`Are you sure you want to delete template group "${v.title}"?`,confirmText:"Yes, delete",onConfirm:U,onDismiss:()=>V(void 0)})]})};function pe({notificationTemplate:l,idx:x,alertManagerName:R,onDeleteClick:F}){const M=(0,X.of)(I.L),v=R===E.hY,[V,U]=(0,f.useState)(!1),{isProvisioned:A}=(0,Z.OA)(l),{uid:B,title:Y,content:ee,missing:te}=l,ne=(0,o.t)("alerting.templates.misconfigured-badge-text","Misconfigured");return(0,e.jsxs)(f.Fragment,{children:[(0,e.jsxs)("tr",{className:x%2===0?M.evenRow:void 0,children:[(0,e.jsx)("td",{children:(0,e.jsx)(T.e,{isCollapsed:!V,onToggle:()=>U(!V)})}),(0,e.jsxs)("td",{children:[Y," ",A&&(0,e.jsx)(ae.rS,{})," ",te&&!v&&(0,e.jsx)(S.m,{content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(o.x6,{i18nKey:"alerting.templates.misconfigured-warning",children:"This template is misconfigured."}),(0,e.jsx)("br",{}),(0,e.jsxs)(o.x6,{i18nKey:"alerting.templates.misconfigured-warning-details",children:["Templates must be defined in both the ",(0,e.jsx)(P.X,{content:"template_files"})," and"," ",(0,e.jsx)(P.X,{content:"templates"})," sections of your alertmanager configuration."]})]}),children:(0,e.jsx)("span",{children:(0,e.jsx)(K.E,{text:ne,color:"orange"})})})]}),(0,e.jsxs)("td",{className:M.actionsCell,children:[A&&(0,e.jsx)(q.M,{to:(0,b.nL)(`/alerting/notifications/templates/${encodeURIComponent(B)}/edit`,R),tooltip:(0,o.t)("alerting.template-row.tooltip-view-template","view template"),icon:"file-alt"}),!A&&(0,e.jsx)($._,{actions:[a.QI.UpdateNotificationTemplate],children:(0,e.jsx)(q.M,{to:(0,b.nL)(`/alerting/notifications/templates/${encodeURIComponent(B)}/edit`,R),tooltip:(0,o.t)("alerting.template-row.tooltip-edit-template-group","Edit template group"),icon:"pen"})}),(0,e.jsx)($._,{actions:[a.QI.CreateNotificationTemplate],children:(0,e.jsx)(q.M,{to:(0,b.nL)(`/alerting/notifications/templates/${encodeURIComponent(B)}/duplicate`,R),tooltip:(0,o.t)("alerting.template-row.tooltip-copy-template-group","Copy template group"),icon:"copy"})}),!A&&(0,e.jsx)($._,{actions:[a.QI.DeleteNotificationTemplate],children:(0,e.jsx)(q.M,{onClick:()=>F(l),tooltip:(0,o.t)("alerting.template-row.tooltip-delete-template-group","Delete template group"),icon:"trash-alt"})})]})]}),V&&(0,e.jsxs)("tr",{className:x%2===0?M.evenRow:void 0,children:[(0,e.jsx)("td",{}),(0,e.jsx)("td",{colSpan:2,children:(0,e.jsx)(H.X,{label:"",horizontal:!0,children:(0,e.jsx)(ce.K,{width:"auto",height:"auto",autoHeight:!0,value:ee,showLineNumbers:!1,monacoOptions:{readOnly:!0,scrollBeyondLastLine:!1}})})})]})]},B)}const me=()=>{const{selectedAlertmanager:l}=(0,p.VI)(),{data:x,isLoading:R,error:F}=(0,Z.cC)({alertmanager:l??""});return F?(0,e.jsx)(L.F,{title:(0,o.t)("alerting.notification-templates.title-failed-to-fetch-notification-templates","Failed to fetch notification templates"),children:(0,b.JZ)(F)}):R?(0,e.jsx)(C._,{text:(0,o.t)("alerting.notification-templates.text-loading-notification-templates","Loading notification templates")}):x?(0,e.jsx)(de,{alertManagerName:l,templates:x}):null};var ue=t(22803),ge=t(40996),fe=t(37386),he=t(63527),xe=t(30703);const ve=()=>{const l=(0,X.of)(be),[x,R]=(0,h.l)(),F=x.get("search")??"",[M,v]=(0,f.useState)(F),[V,U]=(0,ge.A)(()=>{R({search:M},!0)},300,[R,M]),A=(0,f.useCallback)(()=>{U(),v(""),R({search:""},!0)},[U,R]),B=!!F;return(0,e.jsxs)(u.B,{direction:"row",alignItems:"end",gap:.5,children:[(0,e.jsx)(fe.D,{className:l.noBottom,label:(0,o.t)("alerting.contact-points-filter.label-search-by-name-or-type","Search by name or type"),children:(0,e.jsx)(he.p,{"aria-label":(0,o.t)("alerting.contact-points-filter.aria-label-search-contact-points","search contact points"),placeholder:(0,o.t)("alerting.contact-points-filter.placeholder-search","Search"),width:46,prefix:(0,e.jsx)(xe.I,{name:"search"}),onChange:Y=>{v(Y.currentTarget.value)},value:M})}),(0,e.jsx)(i.$n,{variant:"secondary",icon:"times",onClick:()=>A(),disabled:!B,"aria-label":(0,o.t)("alerting.contact-points-filter.aria-label-clear","clear"),children:(0,e.jsx)(o.x6,{i18nKey:"alerting.contact-points-filter.clear",children:"Clear"})})]})},be=()=>({noBottom:(0,ue.css)({marginBottom:0})}),Te=({alertManagerName:l})=>{const x=(0,E.AL)(l);return(0,e.jsx)($._,{actions:[a.QI.UpdateExternalConfiguration],children:(0,e.jsxs)(L.F,{severity:"info",title:(0,o.t)("alerting.global-config-alert.title-global-config-for-contact-points","Global config for contact points"),children:[(0,e.jsx)("p",{children:"For each external Alertmanager you can define global settings, like server addresses, usernames and password, for all the supported contact points."}),(0,e.jsx)(i.z9,{href:(0,b.nL)("alerting/notifications/global-config",l),variant:"secondary",children:x?"View global config":"Edit global config"})]})})};var oe=t(97507),Ae=t(84139),Ce=t(2543),je=t(3887);const ie=new Ae.A({intraMode:1,intraIns:1,intraSub:1,intraDel:1,intraTrn:1}),Se=(l,x)=>{const R=(0,f.useMemo)(()=>l.map(U=>U.name),[l]),F=(0,f.useMemo)(()=>l.map(U=>U.grafana_managed_receiver_configs.map(A=>A[je.MX].name).join(" ")),[l]);if(!x)return l;const M=ie.filter(R,x)??[],v=ie.filter(F,x)??[],V=[...M,...v];return(0,Ce.uniq)(V).map(U=>l[U])??[]};var se=t(8307),_=(l=>(l.ContactPoints="contact_points",l.NotificationTemplates="templates",l))(_||{});const le=10,Pe=()=>{const{selectedAlertmanager:l}=(0,p.VI)(),[x]=(0,h.l)(),R=!(0,J.dM)(l),F=r.TP.hasPermission(s.AccessControlAction.AlertingNotificationsRead),{isLoading:M,error:v,contactPoints:V}=(0,oe.dK)({alertmanager:l,fetchPolicies:R,fetchStatuses:F}),[U,A]=(0,a.L7)(a.QI.CreateContactPoint),[B,Y]=(0,a.L7)(a.QI.ExportContactPoint),[ee,te]=(0,se.G)(),ne=x.get("search");if(M)return(0,e.jsx)(C._,{text:(0,o.t)("alerting.contact-points-tab.text-loading","Loading...")});const Ie=l===E.hY;return V.length===0?(0,e.jsx)(N.p,{variant:A?"call-to-action":"not-found",button:A&&(0,e.jsx)(i.z9,{href:(0,b.nL)("/alerting/notifications/receivers/new",l),icon:"plus",size:"lg",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.contact-points.create",children:"Create contact point"})}),message:(0,o.t)("alerting.contact-points.empty-state.title","You don't have any contact points yet")}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(u.B,{direction:"row",alignItems:"end",justifyContent:"space-between",children:[(0,e.jsx)(ve,{}),(0,e.jsxs)(u.B,{direction:"row",gap:1,children:[U&&(0,e.jsx)(i.z9,{icon:"plus","aria-label":(0,o.t)("alerting.contact-points-tab.aria-label-add-contact-point","add contact point"),variant:"primary",href:"/alerting/notifications/receivers/new",disabled:!A,children:(0,e.jsx)(o.x6,{i18nKey:"alerting.contact-points.create",children:"Create contact point"})}),B&&(0,e.jsx)(i.$n,{icon:"download-alt",variant:"secondary","aria-label":(0,o.t)("alerting.contact-points-tab.aria-label-export-all","export all"),disabled:!Y,onClick:()=>te(se.B),children:(0,e.jsx)(o.x6,{i18nKey:"alerting.contact-points-tab.export-all",children:"Export all"})})]})]}),v?(0,e.jsx)(L.F,{title:(0,o.t)("alerting.contact-points-tab.title-failed-to-fetch-contact-points","Failed to fetch contact points"),children:(0,b.JZ)(v)}):(0,e.jsx)(Re,{contactPoints:V,search:ne,pageSize:le}),!Ie&&(0,e.jsx)(Te,{alertManagerName:l}),ee]})},Le=()=>{const[l,x]=(0,a.L7)(a.QI.CreateNotificationTemplate);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(u.B,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,e.jsx)(j.E,{variant:"body",color:"secondary",children:(0,e.jsx)(o.x6,{i18nKey:"alerting.notification-templates-tab.create-notification-templates-customize-notifications",children:"Create notification templates to customize your notifications."})}),l&&(0,e.jsx)(i.z9,{icon:"plus",variant:"primary",href:"/alerting/notifications/templates/new",disabled:!x,children:(0,e.jsx)(o.x6,{i18nKey:"alerting.notification-templates-tab.add-notification-template-group",children:"Add notification template group"})})]}),(0,e.jsx)(me,{})]})},ye=l=>{const[x,R]=(0,h.l)();return[(0,f.useMemo)(()=>{const v=x.get("tab");return!v||!Object.values(_).map(String).includes(v)?l:v||l},[l,x]),v=>R({tab:v})]},re=()=>{const{selectedAlertmanager:l}=(0,p.VI)(),[,x]=(0,a.L7)(a.QI.ViewContactPoint),[,R]=(0,a.L7)(a.QI.ViewNotificationTemplate),F=[x&&"contact_points",R&&"templates"].filter(B=>!!B)[0],[M,v]=ye(F),{contactPoints:V}=(0,oe.dK)({alertmanager:l}),U=M==="contact_points",A=M==="templates";return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(W.M,{currentAlertmanager:l}),(0,e.jsxs)(u.B,{direction:"column",children:[(0,e.jsxs)(c.U,{children:[x&&(0,e.jsx)(n.o,{label:(0,o.t)("alerting.contact-points-page-contents.label-contact-points","Contact Points"),active:U,counter:V.length,onChangeTab:()=>v("contact_points")}),R&&(0,e.jsx)(n.o,{label:(0,o.t)("alerting.contact-points-page-contents.label-notification-templates","Notification Templates"),active:A,onChangeTab:()=>v("templates")})]}),(0,e.jsx)(d.J,{children:(0,e.jsxs)(u.B,{direction:"column",children:[U&&(0,e.jsx)(Pe,{}),A&&(0,e.jsx)(Le,{})]})})]})]})},Re=({contactPoints:l,search:x,pageSize:R=le})=>{const F=Se(l,x),{page:M,pageItems:v,numberOfPages:V,onPageChange:U}=(0,g.W)(F,1,R);if(v.length===0){const A=(0,o.t)("alerting.contact-points.no-contact-points-found","No contact points found");return(0,e.jsx)(N.p,{variant:"not-found",message:A})}return(0,e.jsxs)(e.Fragment,{children:[v.map((A,B)=>{const Y=`${A.name}-${B}`;return(0,e.jsx)(Q.z8,{contactPoint:A},Y)}),(0,e.jsx)(y.d,{currentPage:M,numberOfPages:V,onNavigate:U,hideWhenSinglePage:!0})]})};function Ee(){return(0,e.jsx)(z.y,{navId:"receivers",accessType:"notification",children:(0,e.jsx)(re,{})})}const De=(0,D.S)(Ee)},40403:(w,O,t)=>{t.d(O,{A1:()=>W,J2:()=>E,OA:()=>X,_3:()=>Q,cC:()=>a,lx:()=>k,xW:()=>z});var e=t(96540),f=t(85618),C=t(91984),N=t(43730),i=t(80218),u=t(43100),L=t(55614),j=t(22628),c=t(56476),n=t(42801);const{useGetAlertmanagerConfigurationQuery:d,useLazyGetAlertmanagerConfigurationQuery:y}=C.m,{useListNamespacedTemplateGroupQuery:r,useLazyReadNamespacedTemplateGroupQuery:o,useCreateNamespacedTemplateGroupMutation:J,useReplaceNamespacedTemplateGroupMutation:b,useDeleteNamespacedTemplateGroupMutation:s}=N.E3;function a({alertmanager:m}){const S=(0,c.dM)(m),K=r({namespace:(0,f.G)()},{skip:!S,selectFromResult:P=>({...P,data:P.data?g(P.data):void 0,currentData:P.currentData?g(P.currentData):void 0})}),G=d(m,{skip:S,selectFromResult:P=>({...P,data:P.data?p(P.data):void 0,currentData:P.currentData?p(P.currentData):void 0})});return S?K:G}function g(m){return m.items.map(S=>h(S))}function h(m){const S=(0,c.gw)(m,j.T.Provenance)??j.rh;return{uid:m.metadata.name??m.spec.title,title:m.spec.title,content:m.spec.content,provenance:S}}function p(m){const{alertmanager_config:S}=m,{templates:K=[]}=S;return Object.entries(m.template_files).map(([G,P])=>({uid:G,title:G,content:P,provenance:(m.template_file_provenances??{})[G]||j.rh,missing:!K.includes(G)}))}function E({alertmanager:m,uid:S}){const[K,G]=y({selectFromResult:T=>({...T,data:T.data?D(T.data,S):void 0,currentData:T.currentData?D(T.currentData,S):void 0})}),[P,$]=o({selectFromResult:T=>({...T,data:T.data?h(T.data):void 0,currentData:T.currentData?h(T.currentData):void 0})}),I=(0,c.dM)(m);return(0,e.useEffect)(()=>{I?P({namespace:(0,f.G)(),name:S}):K(m)},[m,S,I,K,P]),I?$:G}function D(m,S){return p(m).find(G=>G.title===S)}function z({alertmanager:m}){const[S]=J(),[K]=(0,u.d)(),G=(0,c.dM)(m),P=(0,i.Yb)(({templateValues:I})=>{const T=(0,L.FB)({template:I});return K(T)}),$=(0,i.Yb)(({templateValues:I})=>{const T=(0,n.o)(I.title,I.content);return S({namespace:(0,f.G)(),comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup:{spec:{title:I.title,content:T},metadata:{}}}).unwrap()});return G?$:P}function W({alertmanager:m}){const[S]=b(),[K]=(0,u.d)(),G=(0,c.dM)(m),P=(0,i.Yb)(({template:I,patch:T})=>{const H=(0,L.jS)({name:I.title,template:T});return K(H)}),$=(0,i.Yb)(({template:I,patch:T})=>{const H=(0,n.o)(T.title,T.content);return S({namespace:(0,f.G)(),name:I.uid,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup:{spec:{title:T.title,content:H},metadata:{name:I.uid}}}).unwrap()});return G?$:P}function Q({alertmanager:m}){const[S]=s(),[K]=(0,u.d)(),G=(0,i.Yb)(async({uid:I})=>{const T=(0,L.JI)({name:I});return K(T)}),P=(0,i.Yb)(({uid:I})=>S({namespace:(0,f.G)(),name:I,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap());return(0,c.dM)(m)?P:G}function k({alertmanager:m,originalTemplate:S}){const{useLazyGetAlertmanagerConfigurationQuery:K}=C.m,[G]=K();return{titleIsUnique:async $=>{if((0,c.dM)(m)||S?.title===$)return!0;const T=await G(m).unwrap();return p(T).some(Z=>Z.title===$)?"Another template with this name already exists":!0}}}function X(m){return m?{isProvisioned:!!m.provenance&&m.provenance!==j.rh}:{isProvisioned:!1}}},1332:(w,O,t)=>{t.d(O,{K:()=>s});var e=t(74848),f=t(96540),C=t(50992),N=t(2543),i=t(56652);function u(a){const g=a.languages.CompletionItemKind.Function;return[{label:i.AlertmanagerTemplateFunction.toUpper,detail:"function(s string)",kind:g},{label:i.AlertmanagerTemplateFunction.toLower,detail:"function(s string)",kind:g},{label:i.AlertmanagerTemplateFunction.title,documentation:"Capitalizes the first letter of each word",detail:"function(s string)",kind:g},{label:i.AlertmanagerTemplateFunction.join,documentation:{value:"Joins an array of strings using the separator provided."},detail:"function(separator string, s []string)",kind:g},{label:i.AlertmanagerTemplateFunction.match,detail:"function",kind:g},{label:i.AlertmanagerTemplateFunction.safeHtml,detail:"function(pattern, repl, text)",kind:g},{label:i.AlertmanagerTemplateFunction.reReplaceAll,detail:"function(pattern, repl, text)",kind:g},{label:i.AlertmanagerTemplateFunction.stringSlice,detail:"function(s ...string)",kind:g}]}function L(a){const g=a.languages.CompletionItemKind.Function;return Object.values(i.GomplateFunctions).flatMap(h=>h.map(p=>({label:p.keyword,detail:p.usage,documentation:`${p.definition}

${p.example}`,kind:g})))}var j=t(32443);function c(a){const g={triggerCharacters:["."],provideCompletionItems(h,p,E){const D=h.getWordUntilPosition(p),z={startLineNumber:p.lineNumber,endLineNumber:p.lineNumber,startColumn:D.startColumn,endColumn:D.endColumn},W=new d(a,z);if(!n(h,p))return W.getSnippetsSuggestions();if(E.triggerKind===a.languages.CompletionTriggerKind.Invoke&&!E.triggerCharacter)return W.getFunctionsSuggestions();const k=h.getWordUntilPosition({lineNumber:p.lineNumber,column:p.column-1});return W.getTemplateDataSuggestions(k.word)}};return a.languages.registerCompletionItemProvider("go-template",g)}function n(a,g){return a.findMatches("\\{\\{(?:.|\\n)+?\\}\\}",a.getFullModelRange(),!0,!1,null,!1).some(E=>E.range.containsPosition({lineNumber:g.lineNumber,column:g.column+1}))}class d{constructor(g,h){this.monaco=g,this.range=h,this.getSnippetsSuggestions=()=>this.getCompletionsFromDefinitions((0,j.Mq)(this.monaco)),this.getFunctionsSuggestions=()=>this.getCompletionsFromDefinitions(u(this.monaco),L(this.monaco)),this.getTemplateDataSuggestions=p=>{switch(p){case"":return this.getCompletionsFromDefinitions((0,j.Xt)(this.monaco),(0,j.So)(this.monaco));case"Alerts":return this.getCompletionsFromDefinitions((0,j.J2)(this.monaco));case"GroupLabels":case"CommonLabels":case"CommonAnnotations":case"Labels":case"Annotations":return this.getCompletionsFromDefinitions((0,j.KS)(this.monaco));default:return{suggestions:[]}}},this.getCompletionsFromDefinitions=(...p)=>({suggestions:(0,N.concat)(...p).map(D=>y(D,this.range))})}}function y({label:a,detail:g,documentation:h,kind:p,insertText:E},D){const z=typeof a=="string"?a:a.label,W=typeof a=="string"?{label:a,description:g}:{...a};return W.description??=g,{label:W,kind:p,insertText:E??z,range:D,documentation:h,detail:g}}const r="go-template",J={id:r,extensions:[],aliases:[],mimetypes:[],loader:()=>Promise.resolve().then(t.bind(t,56652))},b=(a,g)=>{const{id:h,loader:p}=g;a.languages.getLanguages().find(D=>D.id===h)||(a.languages.register({id:h}),p().then(D=>{a.languages.setMonarchTokensProvider(h,D.language),a.languages.setLanguageConfiguration(h,D.conf)}))},s=a=>{const g=!!a.autoHeight,h=(0,f.useRef)(null),p=E=>{if(g){const D=E.getContentHeight();try{E.layout({height:D,width:NaN})}catch{}}};return(0,f.useEffect)(()=>()=>{h.current?.dispose()},[]),(0,e.jsx)(C.B,{showLineNumbers:!0,showMiniMap:!1,...a,monacoOptions:{scrollBeyondLastLine:!1},onEditorDidMount:p,onBeforeEditorMount:E=>{b(E,J),h.current=c(E)},language:r})}},32443:(w,O,t)=>{t.d(O,{So:()=>d,J2:()=>y,Xt:()=>n,KS:()=>r,Mq:()=>J,L:()=>o});const e=`
{{ range .Alerts }}
  Status: {{ .Status }}
  Starts at: {{ .StartsAt }}
{{ end }}
`,f=`
[{{.Status}}] {{ .Labels.alertname }}

Labels:
{{ range .Labels.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}

{{ if gt (len .Annotations) 0 }}
Annotations:
{{ range .Annotations.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}
{{ end }}

{{ if gt (len .SilenceURL ) 0 }}
  Silence alert: {{ .SilenceURL }}
{{ end }}
{{ if gt (len .DashboardURL ) 0 }}
  Go to dashboard: {{ .DashboardURL }}
{{ end }}
`,C=`
{{ coll.Dict
  "receiver" .Receiver
  "status" .Status
  "alerts" ( len .Alerts )
| data.ToJSONPretty " " }}
`,N=c("GroupLabels.SortedPairs"),i=c("CommonLabels.SortedPairs"),u=c("CommonAnnotations.SortedPairs"),L=c("Labels.SortedPairs"),j=c("Annotations.SortedPairs");function c(b){return`
{{ range .${b} }}
  {{ .Name }} = {{ .Value }}
{{ end }}`}function n(b){const s=b.languages.CompletionItemKind.Field;return[{label:"Alerts",kind:s,detail:"Alert[]",documentation:{value:"An Array containing all alerts"}},{label:"Receiver",kind:s,detail:"string"},{label:"Status",kind:s,detail:"string"},{label:"GroupLabels",kind:s,detail:"[]KeyValue"},{label:"CommonLabels",kind:s,detail:"[]KeyValue"},{label:"CommonAnnotations",kind:s,detail:"[]KeyValue"},{label:"ExternalURL",kind:s,detail:"string"},{label:"GroupKey",kind:s,detail:"string"},{label:"TruncatedAlerts",kind:s,detail:"integer"}]}function d(b){const s=b.languages.CompletionItemKind.Field;return[{label:{label:"Status",detail:"(Alert)",description:"string"},kind:s,detail:"string",documentation:{value:"Status of the alert. It can be `firing` or `resolved`"}},{label:{label:"Labels",detail:"(Alert)"},kind:s,detail:"[]KeyValue",documentation:{value:"A set of labels attached to the alert."}},{label:{label:"Annotations",detail:"(Alert)"},kind:s,detail:"[]KeyValue",documentation:"A set of annotations attached to the alert."},{label:{label:"StartsAt",detail:"(Alert)"},kind:s,detail:"time.Time",documentation:"Time the alert started firing."},{label:{label:"EndsAt",detail:"(Alert)"},kind:s,detail:"time.Time",documentation:"Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received."},{label:{label:"GeneratorURL",detail:"(Alert)"},kind:s,detail:"string",documentation:"Back link to Grafana or external Alertmanager."},{label:{label:"SilenceURL",detail:"(Alert)"},kind:s,detail:"string",documentation:"Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts."},{label:{label:"DashboardURL",detail:"(Alert)"},kind:s,detail:"string",documentation:"Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"PanelURL",detail:"(Alert)"},kind:s,detail:"string",documentation:"Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"Fingerprint",detail:"(Alert)"},kind:s,detail:"string",documentation:"Fingerprint that can be used to identify the alert."},{label:{label:"ValueString",detail:"(Alert)"},kind:s,detail:"string",documentation:"String that contains labels and values of each reduced expression in the alert."},{label:{label:"OrgID",detail:"(Alert)"},kind:s,detail:"integer",documentation:"The ID of the organization that owns the alert."}]}function y(b){const s=b.languages.CompletionItemKind.Field;return[{label:"Firing",kind:s,detail:"Alert[]"},{label:"Resolved",kind:s,detail:"Alert[]"}]}function r(b){const s=b.languages.CompletionItemKind.Field;return[{label:"SortedPairs",kind:s,detail:"[]KeyValue"},{label:"Names",kind:s,detail:"[]string"},{label:"Values",kind:s,detail:"[]string"},{label:"Remove",detail:"KeyValue[] function(keys []string)",kind:b.languages.CompletionItemKind.Method}]}const o={alerts:{label:"alertsloop",description:"Renders a loop through alerts",snippet:e},alertDetails:{label:"alertdetails",description:"Renders all information available about the alert",snippet:f},groupLabels:{label:"grouplabelsloop",description:"Renders a loop through group labels",snippet:N},commonLabels:{label:"commonlabelsloop",description:"Renders a loop through common labels",snippet:i},commonAnnotations:{label:"commonannotationsloop",description:"Renders a loop through common annotations",snippet:u},labels:{label:"labelsloop",description:"Renders a loop through labels",snippet:L},annotations:{label:"annotationsloop",description:"Renders a loop through annotations",snippet:j},json:{label:"json",description:"Renders a JSON object",snippet:C}};function J(b){const s=b.languages.CompletionItemKind.Snippet,a=b.languages.CompletionItemInsertTextRule.InsertAsSnippet,{alerts:g,alertDetails:h,groupLabels:p,commonLabels:E,commonAnnotations:D,labels:z,annotations:W,json:Q}=o;return[{label:g.label,documentation:g.description,kind:s,insertText:g.snippet,insertTextRules:a},{label:{label:h.label,detail:"(Alert)"},documentation:h.description,kind:s,insertText:h.snippet,insertTextRules:a},{label:p.label,documentation:p.description,kind:s,insertText:p.snippet,insertTextRules:a},{label:E.label,documentation:E.description,kind:s,insertText:E.snippet,insertTextRules:a},{label:D.label,documentation:D.description,kind:s,insertText:D.snippet,insertTextRules:a},{label:{label:z.label,detail:"(Alert)"},documentation:z.description,kind:s,insertText:z.snippet,insertTextRules:a},{label:{label:W.label,detail:"(Alert)"},documentation:W.description,kind:s,insertText:W.snippet,insertTextRules:a},{label:Q.label,documentation:Q.description,kind:s,insertText:Q.snippet,insertTextRules:b.languages.CompletionItemInsertTextRule.KeepWhitespace}]}},87988:(w,O,t)=>{t.d(O,{D:()=>e,G7:()=>N,Jl:()=>f,gY:()=>C});function e(i){const u={},L=[],j=/{{-?\s*(define|end|if|range|else|with|template|block)\b(.*?)-?}}/gs;let c,n=0;for(;(c=j.exec(i))!==null;){const[,d,y]=c;if(n=c.index,d==="define"){const r=y?.match(/"([^"]+)"/);r&&L.push({type:"define",startIndex:n,name:r[1]})}else if(d==="end"){let r=L.pop();for(;r&&r.type!=="define"&&r.type!=="if"&&r.type!=="range"&&r.type!=="with"&&r.type!=="block";)r=L.pop();if(r){const o=j.lastIndex;r.type==="define"&&!r.name?.startsWith("__")&&(u[r.name]={name:r.name,content:i.slice(r.startIndex,o)})}}else(d==="if"||d==="range"||d==="else"||d==="with"||d==="block")&&L.push({type:d,startIndex:n})}for(const d of Object.values(u)){const y=/{{ template "([^"]+)" }}/g;let r;for(;(r=y.exec(d.content))!==null;){const o=r[1];u[o]?.content&&(d.content+=`
`+u[o]?.content,delete u[o])}}return Object.values(u)}function f(i){return`{{ template "${i}" . }}`}function C(i){const u=i.match(/\{\{\s*template\s*"(.*)"\s*\.\s*\}\}/);return u?u[1]:""}function N(i){const u=/\{\{\s*template\s*".*?"\s*\.\s*\}\}/g;if(i.match(u)?.length!==1)return!1;const j=i.split(u);for(const c of j)if(c.trim()!=="")return!1;return!0}},71774:(w,O,t)=>{t.d(O,{M:()=>N});var e=t(74848),f=t(45967),C=t(45861);const N=({tooltip:i,icon:u,to:L,target:j,onClick:c,className:n,tooltipPlacement:d="top",...y})=>{const r=typeof i=="string"?i:void 0;return(0,e.jsx)(f.m,{content:i,placement:d,children:L?(0,e.jsx)(C.z9,{variant:"secondary",fill:"text",icon:u,href:L,size:"sm",target:j,...y,"aria-label":r}):(0,e.jsx)(C.$n,{className:n,variant:"secondary",fill:"text",size:"sm",icon:u,type:"button",onClick:c,...y,"aria-label":r})})}},27911:(w,O,t)=>{t.d(O,{L:()=>f});var e=t(22803);const f=C=>({table:(0,e.css)({width:"100%",borderRadius:C.shape.radius.default,border:`solid 1px ${C.colors.border.weak}`,backgroundColor:C.colors.background.secondary,th:{padding:C.spacing(1)},td:{padding:`0 ${C.spacing(1)}`},tr:{height:"38px"}}),evenRow:(0,e.css)({backgroundColor:C.colors.background.primary}),colExpand:(0,e.css)({width:"36px"}),nameCell:(0,e.css)({gap:C.spacing(1)}),actionsCell:(0,e.css)({textAlign:"right",width:"1%",whiteSpace:"nowrap","& > * + *":{marginLeft:C.spacing(.5)}})})}}]);

//# sourceMappingURL=ContactPoints.c6c594b5305cdd79d255.js.map