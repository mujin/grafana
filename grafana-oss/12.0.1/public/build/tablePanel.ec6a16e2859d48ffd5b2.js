"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3525],{73163:(Z,j,o)=>{o.d(j,{X:()=>W,k:()=>e});var m=o(60519),I=o(32899),B=o(95004),R=o(63704),A=o(68143),L=o(73427),U=o(86967),D=o(92367);const e=(g,p,C,f,t,s)=>!t||t.length===0?[]:t.map(u=>{const d=(0,m.vd)(g,p,C),r={...C,__dataContext:d},y=(w,M,O)=>f(w,{...r,...M},O);s.valueRowIndex!==void 0&&!isNaN(s.valueRowIndex)?d.value.rowIndex=s.valueRowIndex:d.value.calculatedValue=s.calculatedValue;const T=f(u.title,r),c=f(u.confirmation||`Are you sure you want to ${u.title}?`,r);return{title:T,confirmation:c,onClick:(w,M)=>{l(u,y)},oneClick:u.oneClick??!1}}).filter(u=>!!u),l=(g,p)=>{try{const C=new URL(G(p(g.fetch.url))),f={};let t={url:C.toString(),method:g.fetch.method,data:F(g,p),headers:f};g.fetch.headers&&g.fetch.headers.forEach(([s,i])=>{f[p(s)]=p(i)}),g.fetch.queryParams&&(g.fetch.queryParams?.forEach(([s,i])=>{C.searchParams.append(p(s),p(i))}),t.url=C.toString()),f["X-Grafana-Action"]="1",t.headers=f,(0,A.AI)().fetch(t).subscribe({error:s=>{L.lE.emit(I.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(s)},complete:()=>{L.lE.emit(I.r1.alertSuccess,["API call was successful"])}})}catch(C){L.lE.emit(I.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(C);return}},W=(g=[],p=[])=>({name:"Default field",type:B.PU.string,config:{links:g,actions:p},values:[]}),G=g=>{if(g.startsWith("/")){const C=R.sQ.sanitizeUrl(g);g=(0,D.z)(C,[])}return g},F=(g,p)=>{let C=g.fetch.body?p(g.fetch.body):"{}";return g.fetch.method===U.DO.GET&&(C=void 0),C}},86967:(Z,j,o)=>{o.d(j,{DO:()=>R,en:()=>m,gR:()=>I,xp:()=>B});var m=(e=>(e.Center="center",e.Left="left",e.LeftRight="leftright",e.Right="right",e.Scale="scale",e))(m||{}),I=(e=>(e.Bottom="bottom",e.Center="center",e.Scale="scale",e.Top="top",e.TopBottom="topbottom",e))(I||{}),B=(e=>(e.Contain="contain",e.Cover="cover",e.Fill="fill",e.Original="original",e.Tile="tile",e))(B||{}),R=(e=>(e.GET="GET",e.POST="POST",e.PUT="PUT",e))(R||{}),A=(e=>(e.Straight="straight",e))(A||{});const L={vertices:[]},U={connections:[]},D={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},25205:(Z,j,o)=>{o.d(j,{L:()=>g});var m=o(74848),I=o(22803),B=o(84229),R=o(16515),A=o(57866),L=o(14477),U=o(43173),D=o(63142),e=o(64400),l=o(24343),W=o(18857),G=o(73163),F=o(32776);function g(d){const{data:r,height:y,width:T,options:c,fieldConfig:S,id:w,timeRange:M,replaceVariables:O}=d,H=(0,D.$j)(),X=(0,e.d2)(),V=(0,F.gy)(r.series)?(0,F.S5)(r.series):r.series,z=V?.length,ee=V.some(b=>b.fields.length>0),Y=p(V,c),te=V[Y];let k=y;if(!z||!ee)return(0,m.jsx)(L.a,{panelId:w,fieldConfig:S,data:r});if(z>1){const b=H.spacing.gridSize*H.components.height.md,$=H.spacing.gridSize;k=y-b-$}const oe=X.sync&&X.sync()!==B.y.Off,J=(0,m.jsx)(l.X,{height:k,width:T,data:te,noHeader:!c.showHeader,showTypeIcons:c.showTypeIcons,resizable:!0,initialSortBy:c.sortBy,onSortByChange:b=>f(b,d),onColumnResize:(b,$)=>C(b,$,d),onCellFilterAdded:X.onAddAdHocFilter,footerOptions:c.footer,enablePagination:c.footer?.enablePagination,cellHeight:c.cellHeight,timeRange:M,enableSharedCrosshair:U.$.featureToggles.tableSharedCrosshair&&oe,fieldConfig:S,getActions:i,replaceVariables:O});if(z===1)return J;const Q=V.map((b,$)=>({label:(0,R.Ri)(b),value:$}));return(0,m.jsxs)("div",{className:u.wrapper,children:[J,(0,m.jsx)("div",{className:u.selectWrapper,children:(0,m.jsx)(W.l6,{options:Q,value:Q[Y],onChange:b=>t(b,d)})})]})}function p(d,r){return r.frameIndex>0&&r.frameIndex<d.length?r.frameIndex:0}function C(d,r,y){const{fieldConfig:T}=y,{overrides:c}=T,S=A.Ct.byName,w="custom.width",M=c.find(O=>O.matcher.id===S&&O.matcher.options===d);if(M){const O=M.properties.find(H=>H.id===w);O?O.value=r:M.properties.push({id:w,value:r})}else c.push({matcher:{id:S,options:d},properties:[{id:w,value:r}]});y.onFieldConfigChange({...T,overrides:c})}function f(d,r){r.onOptionsChange({...r.options,sortBy:d})}function t(d,r){r.onOptionsChange({...r.options,frameIndex:d.value||0})}const s=d=>d,i=(d,r,y,T)=>{const c=[],S=new Set;return(0,G.k)(d,r,r.state.scopedVars,T??s,r.config.actions??[],{valueRowIndex:y}).forEach(M=>{const O=`${M.title}`;S.has(O)||(c.push(M),S.add(O))}),c},u={wrapper:(0,I.css)({display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}),selectWrapper:(0,I.css)({padding:"8px 8px 0px 8px"})}},32776:(Z,j,o)=>{o.d(j,{S5:()=>C,fq:()=>L,gy:()=>f,l1:()=>g});var m=o(2543),I=o.n(m),B=o(57866),R=o(33553),A=o(95004);const L=t=>(!t.pluginVersion&&"columns"in t&&console.log("Was angular table",t),t.options),U={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},D={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},e={cell:"color-background",row:"color-background",value:"color-text"},l=(t,s)=>[-1/0,...t].map((i,u)=>({color:s[u],value:(0,m.isNumber)(i)?i:parseInt(i,10)})),W=(t,s)=>{const i=t.transformations??[];if(Object.keys(U).includes(s.transform)){const u={reducers:[]};s.transform==="timeseries_aggregations"&&(u.includeTimeField=!1,u.reducers=s.columns.map(d=>D[d.value])),i.push({id:U[s.transform],options:u})}return i},G=t=>{const i={matcher:{id:/^\/.*\/$/.test(t.pattern)?B.Ct.byRegexp:B.Ct.byName,options:t.pattern},properties:[]};return t.alias&&i.properties.push({id:"displayName",value:t.alias}),t.unit&&i.properties.push({id:"unit",value:t.unit}),t.decimals&&i.properties.push({id:"decimals",value:t.decimals}),t.type==="date"&&i.properties.push({id:"unit",value:`time: ${t.dateFormat}`}),t.type==="hidden"&&i.properties.push({id:"custom.hidden",value:!0}),t.link&&i.properties.push({id:"links",value:[{title:(0,m.defaultTo)(t.linkTooltip,""),url:(0,m.defaultTo)(t.linkUrl,""),targetBlank:(0,m.defaultTo)(t.linkTargetBlank,!1)}]}),t.colorMode&&i.properties.push({id:"custom.cellOptions",value:{type:e[t.colorMode]}}),t.align&&i.properties.push({id:"custom.align",value:t.align==="auto"?null:t.align}),t.thresholds?.length&&i.properties.push({id:"thresholds",value:{mode:R.O.Absolute,steps:l(t.thresholds,t.colors)}}),i},F=t=>{let s={custom:{}};if(t){if(s=(0,m.omitBy)({unit:t.unit,decimals:t.decimals,displayName:t.alias,custom:{align:t.align==="auto"?null:t.align}},m.isNil),t.thresholds.length){const i={mode:R.O.Absolute,steps:l(t.thresholds,t.colors)};s.thresholds=i}t.colorMode&&(s.custom.cellOptions={type:e[t.colorMode]})}return s},g=(t,s,i)=>{if(s==="table-old"&&i.angular){const u=i.angular,d=W(t,u),r=u.styles.find(c=>c.pattern==="/.*/"),y=F(r),T=u.styles.filter(c=>c.pattern!=="/.*/").map(G);t.transformations=d,t.fieldConfig={defaults:y,overrides:T}}return{}},p=t=>t?.filter(s=>s.meta?.custom?.parentRowIndex===void 0)||[t?.[0]],C=t=>{const s=[];return p(t).filter(u=>!!u&&u.length!==0)?.forEach(u=>{const d=t?.filter(c=>u.refId===c.refId&&c.meta?.custom?.parentRowIndex!==void 0),r=(0,m.groupBy)(d,c=>c.meta?.custom?.parentRowIndex),y=Object.keys(r).map(c=>r[c]),T={...u};d&&d.length>0&&T.fields.push({name:"nested",type:A.PU.nestedFrames,config:{},values:y}),s.push(T)}),s},f=t=>t?.some(s=>s.meta?.custom?.parentRowIndex!==void 0)},45730:(Z,j,o)=>{o.r(j),o.d(j,{plugin:()=>ie});var m=o(16207),I=o(83340),B=o(38809),R=o(53543),A=o(46644),L=o(95004),U=o(16515),D=o(31114),e=o(739),l=o(74848),W=o(21285);function G({onChange:a,value:n,context:h}){const x=v=>{v?.currentTarget.checked&&(h.options.footer.show=!1),a(v?.currentTarget.checked)};return(0,l.jsx)(W.d,{value:!!n,onChange:x})}var F=o(22803),g=o(2543),p=o(96540),C=o(63142),f=o(37386),t=o(18857);const s=({cellOptions:a,onChange:n})=>{const h=()=>{a.wrapText=!a.wrapText,n(a)};return(0,l.jsx)(f.D,{label:"Wrap text",description:"If selected text will be wrapped to the width of text in the configured column",children:(0,l.jsx)(W.d,{value:a.wrapText,onChange:h})})};var i=o(41654),u=o(77824);function d({cellOptions:a,onChange:n}){const h=v=>{a.mode=v,n(a)},x=v=>{a.valueDisplayMode=v,n(a)};return(0,l.jsxs)(i.B,{direction:"column",gap:0,children:[(0,l.jsx)(f.D,{label:"Gauge display mode",children:(0,l.jsx)(u.z,{value:a?.mode??e.eX.Gradient,onChange:h,options:r})}),(0,l.jsx)(f.D,{label:"Value display",children:(0,l.jsx)(u.z,{value:a?.valueDisplayMode??e.$l.Text,onChange:x,options:y})})]})}const r=[{value:e.eX.Basic,label:"Basic"},{value:e.eX.Gradient,label:"Gradient"},{value:e.eX.Lcd,label:"Retro LCD"}],y=[{value:e.$l.Color,label:"Value color"},{value:e.$l.Text,label:"Text color"},{value:e.$l.Hidden,label:"Hidden"}];var T=o(72636),c=o(99887);const S=[{value:e.Wq.Basic,label:"Basic"},{value:e.Wq.Gradient,label:"Gradient"}],w=({cellOptions:a,onChange:n})=>{const h=E=>{a.mode=E,n(a)},x=()=>{a.applyToRow=!a.applyToRow,n(a)},v=()=>{a.wrapText=!a.wrapText,n(a)},P=(0,l.jsxs)(T.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,l.jsx)(c.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.D,{label:"Background display mode",children:(0,l.jsx)(u.z,{value:a?.mode??e.Wq.Gradient,onChange:h,options:S})}),(0,l.jsx)(f.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,l.jsx)(W.d,{value:a.applyToRow,onChange:x})}),(0,l.jsx)(f.D,{label:P,children:(0,l.jsx)(W.d,{value:a.wrapText,onChange:v})})]})};var M=o(63527);const O=({cellOptions:a,onChange:n})=>{const h=v=>{a.alt=v.currentTarget.value,n(a)},x=v=>{a.title=v.currentTarget.value,n(a)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,l.jsx)(M.p,{onChange:h,defaultValue:a.alt})}),(0,l.jsx)(f.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,l.jsx)(M.p,{onChange:x,defaultValue:a.title})})]})};var H=o(37297),X=o(32881),V=o(93948),z=o(12241);const ee=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function Y(a){const n=(0,z.V)(a);return{...n,useCustomConfig:h=>{n.useCustomConfig?.(h),h.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const te=a=>{const{cellOptions:n,onChange:h}=a,x=(0,p.useMemo)(()=>{const E=Y(V.t);return(0,H.O)(E,"ChartCell")},[]),v=(0,C.of)(oe),P={...V.t,...n};return(0,l.jsx)(X.gW,{children:x.list(ee.map(E=>`custom.${E}`)).map(E=>{if(E.showIf&&!E.showIf(P))return null;const ae=E.editor,K=E.path;return(0,l.jsx)(f.D,{label:E.name,className:v.field,children:(0,l.jsx)(ae,{onChange:N=>h({...n,[K]:N}),value:(k(K,P)?P[K]:void 0)??E.defaultValue,item:E,context:{data:[]}})},E.id)})})};function k(a,n){return a in n}const oe=()=>({field:(0,F.css)({width:"100%","[title='Use color scheme to define gradient']":{display:"none"}})}),J=({value:a,onChange:n})=>{const h=a.type,x=(0,C.of)(b),v=Q.find(N=>N.value.type===h);let[P,E]=(0,p.useState)({});const ae=N=>{N.value!==void 0&&(a=N.value,P[a.type]!==void 0&&Object.keys(P[a.type]).length>1&&(a=(0,g.merge)(a,P[a.type])),n(a))},K=N=>{P[a.type]=(0,g.merge)(a,N),E(P),n(P[a.type])};return(0,l.jsxs)("div",{className:x.fixBottomMargin,children:[(0,l.jsx)(f.D,{children:(0,l.jsx)(t.l6,{options:Q,value:v,onChange:ae})}),(h===e.ob.Auto||h===e.ob.ColorText)&&(0,l.jsx)(s,{cellOptions:a,onChange:K}),h===e.ob.Gauge&&(0,l.jsx)(d,{cellOptions:a,onChange:K}),h===e.ob.ColorBackground&&(0,l.jsx)(w,{cellOptions:a,onChange:K}),h===e.ob.Sparkline&&(0,l.jsx)(te,{cellOptions:a,onChange:K}),h===e.ob.Image&&(0,l.jsx)(O,{cellOptions:a,onChange:K})]})};let Q=[{value:{type:e.ob.Auto},label:"Auto"},{value:{type:e.ob.Sparkline},label:"Sparkline"},{value:{type:e.ob.ColorText},label:"Colored text"},{value:{type:e.ob.ColorBackground},label:"Colored background"},{value:{type:e.ob.Gauge},label:"Gauge"},{value:{type:e.ob.DataLinks},label:"Data links"},{value:{type:e.ob.JSONView},label:"JSON View"},{value:{type:e.ob.Image},label:"Image"},{value:{type:e.ob.Actions},label:"Actions"}];const b=a=>({fixBottomMargin:(0,F.css)({marginBottom:a.spacing(-2)})});var $=o(25205),ne=o(32776);const _={cellHeight:e.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var se=o(73495);class re{getSuggestionsForData(n){const h=n.getListAppender({name:se.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:x=>{x.fieldConfig.defaults.custom.minWidth=50}}});n.dataSummary.fieldCount===0?h.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):h.append({})}}const q="Table footer",le=["Cell options"],ie=new m.m($.L).setPanelChangeHandler(ne.l1).setMigrationHandler(ne.fq).useFieldConfig({standardOptions:{[I.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:a=>{a.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:D.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:D.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:D.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:J,override:J,defaultValue:D.gB.cellOptions,process:B.hS,category:le,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:le,showIf:n=>n.cellOptions.type===e.ob.Auto||n.cellOptions.type===e.ob.JSONView||n.cellOptions.type===e.ob.ColorText||n.cellOptions.type===e.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:D.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(a=>{a.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:_.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:_.cellHeight,settings:{options:[{value:e.qM.Sm,label:"Small"},{value:e.qM.Md,label:"Medium"},{value:e.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[q],name:"Show table footer",defaultValue:_.footer?.show}).addCustomEditor({id:"footer.reducer",category:[q],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:R.D.get("stats-picker").editor,defaultValue:[A.gy.sum],showIf:n=>n.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[q],name:"Count rows",description:"Display a single count for all data rows",defaultValue:_.footer?.countRows,showIf:n=>n.footer?.reducer?.length===1&&n.footer?.reducer[0]===A.gy.count}).addMultiSelect({path:"footer.fields",category:[q],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async n=>{const h=[];if(n&&n.data&&n.data.length>0){const x=n.data[0];for(const v of x.fields)if(v.type===L.PU.number){const P=(0,U.Ct)(v,x,n.data),E=v.name;h.push({value:E,label:P})}}return h}},defaultValue:"",showIf:n=>n.footer?.show&&!(n.footer?.countRows&&n.footer?.reducer.includes(A.gy.count))}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:G})}).setSuggestionsSupplier(new re)}}]);

//# sourceMappingURL=tablePanel.ec6a16e2859d48ffd5b2.js.map