"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9368],{55684:(K,h,n)=>{n.d(h,{A:()=>P});var e=n(74848),T=n(18857),u=n(56840),O=n(51686),A=n(86017);const v=({name:g,time_intervals:l})=>({value:g,label:g,description:l.map(m=>(0,A.LF)(m)).join(", AND ")}),P=({alertmanager:g,selectProps:l})=>{const{data:m}=(0,O.my)({alertmanager:g,skip:l.disabled}),s=m?.map(p=>v(p))||[];return(0,e.jsx)(T.KF,{"aria-label":(0,u.t)("alerting.mute-timings-selector.aria-label-mute-timings","Mute timings"),options:s,placeholder:(0,u.t)("alerting.mute-timings-selector.placeholder-select-mute-timings","Select mute timings..."),...l})}},51686:(K,h,n)=>{n.d(h,{XW:()=>R,gB:()=>$,zm:()=>U,Ad:()=>S,my:()=>V,SD:()=>F,br:()=>N});var e=n(96540),T=n(91984),u=n(5709);const O=["TimeInterval"],v=u.H.enhanceEndpoints({addTagTypes:O}).injectEndpoints({endpoints:a=>({listNamespacedTimeInterval:a.query({query:t=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${t.namespace}/timeintervals`,params:{pretty:t.pretty,allowWatchBookmarks:t.allowWatchBookmarks,continue:t.continue,fieldSelector:t.fieldSelector,labelSelector:t.labelSelector,limit:t.limit,resourceVersion:t.resourceVersion,resourceVersionMatch:t.resourceVersionMatch,sendInitialEvents:t.sendInitialEvents,timeoutSeconds:t.timeoutSeconds,watch:t.watch}}),providesTags:["TimeInterval"]}),createNamespacedTimeInterval:a.mutation({query:t=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${t.namespace}/timeintervals`,method:"POST",body:t.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:t.pretty,dryRun:t.dryRun,fieldManager:t.fieldManager,fieldValidation:t.fieldValidation}}),invalidatesTags:["TimeInterval"]}),replaceNamespacedTimeInterval:a.mutation({query:t=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${t.namespace}/timeintervals/${t.name}`,method:"PUT",body:t.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:t.pretty,dryRun:t.dryRun,fieldManager:t.fieldManager,fieldValidation:t.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteNamespacedTimeInterval:a.mutation({query:t=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${t.namespace}/timeintervals/${t.name}`,method:"DELETE",body:t.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:t.pretty,dryRun:t.dryRun,gracePeriodSeconds:t.gracePeriodSeconds,orphanDependents:t.orphanDependents,propagationPolicy:t.propagationPolicy}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1});var _=n(78747),P=n(52161),g=n(22628),l=n(56476),m=n(85618),s=n(80218),p=n(43100),c=n(72748);const{useLazyGetAlertmanagerConfigurationQuery:I,useGetMuteTimingListQuery:x}=T.m,{useLazyListNamespacedTimeIntervalQuery:j,useCreateNamespacedTimeIntervalMutation:B,useReplaceNamespacedTimeIntervalMutation:G,useDeleteNamespacedTimeIntervalMutation:D}=v,C=a=>{const{metadata:t,spec:i}=a;return{...i,id:i.name,metadata:t,provisioned:(0,l.Uo)(a)}},y=(a,t)=>({...a,id:a.name,provisioned:!!(t&&t!==g.rh)}),L=()=>I({selectFromResult:({data:a,...t})=>{if(!a)return{data:a,...t};const{alertmanager_config:i}=a,r=i.muteTimeProvenances??{};return{data:(0,_.IT)(i).map(f=>y(f,r[f.name])),...t}}}),W=()=>j({selectFromResult:({data:a,...t})=>({data:a?.items.map(i=>C(i)),...t})}),S=({alertmanager:a,skip:t})=>{const i=(0,l.dM)(a),[r,M]=W(),[E,f]=L();return(0,e.useEffect)(()=>{if(!t)if(i){const o=(0,m.G)();r({namespace:o})}else E(a)},[a,E,r,t,i]),i?M:f},R=({alertmanager:a})=>{const t=(0,l.dM)(a),[i]=B(),[r]=(0,p.d)(),M=(0,s.Yb)(({interval:f})=>{const o=(0,m.G)();return i({namespace:o,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{metadata:{},spec:f}}).unwrap()}),E=(0,s.Yb)(({interval:f})=>{const o=(0,c.X9)({interval:f});return r(o)});return t?M:E},U=({alertmanager:a,name:t})=>{const i=(0,l.dM)(a),[r,M]=j({selectFromResult:({data:o,...d})=>o?o.items.length===0?{...d,data:void 0,isError:!0}:{data:C(o.items[0]),...d}:{data:o,...d}}),[E,f]=I({selectFromResult:({data:o,...d})=>{if(!o)return{data:o,...d};const H=o?.alertmanager_config??{},b=(0,_.IT)(H).find(({name:z})=>z===t);if(b){const z=H?.muteTimeProvenances??{};return{data:y(b,z[b.name]),...d}}return{...d,data:void 0,isError:!0}}});return(0,e.useEffect)(()=>{if(i){const o=(0,m.G)(),d=(0,l.O)(t);r({namespace:o,fieldSelector:`spec.name=${d}`},!0)}else E(a,!0)},[a,E,r,t,i]),i?M:f},F=({alertmanager:a})=>{const t=(0,l.dM)(a),[i]=G(),[r]=(0,p.d)(),M=(0,s.Yb)(async({interval:f,originalName:o})=>{const d=(0,m.G)();return i({name:o,namespace:d,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{spec:f,metadata:{name:o}}}).unwrap()}),E=(0,s.Yb)(async({interval:f,originalName:o})=>{const d=(0,c.ov)({interval:f,originalName:o});return r(d)});return t?M:E},$=({alertmanager:a})=>{const t=(0,l.dM)(a),[i,r]=(0,p.d)(),[M]=D(),E=(0,s.Yb)(async({name:o})=>{const d=(0,c.$8)({name:o});return i(d)}),f=(0,s.Yb)(async({name:o})=>{const d=(0,m.G)();await M({name:o,namespace:d,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap()});return t?f:E},N=({alertmanager:a})=>{const t=(0,l.dM)(a),[i]=L();return t?()=>{}:async(r,M)=>{if(!M)return i(a).unwrap().then(E=>!!(0,_.IT)(E.alertmanager_config)?.find(d=>d.name===r)?`Mute timing already exists with name "${r}"`:void 0)}},V=({alertmanager:a,skip:t})=>{const i=(0,l.dM)(a),r=a===P.hY&&!i,M=x(void 0,{skip:t||!r}),E=S({alertmanager:a,skip:t||r});return r?M:E}},78747:(K,h,n)=>{n.d(h,{Hy:()=>P,IT:()=>g,av:()=>m,oB:()=>l});var e=n(74848),T=n(95093),u=n.n(T),O=n(96540),A=n(41654),v=n(86017);const _=/^((([01][0-9])|(2[0-3])):[0-5][0-9])$|(^24:00$)/,P=s=>s?_.test(s):!0,g=s=>[...s.mute_time_intervals??[],...s.time_intervals??[]],l=(s,p)=>{if(!s&&!p)return!0;if(!s&&p||s&&!p)return!1;const c="HH:mm",I=u()().startOf("day").add(s,c),x=u()().startOf("day").add(p,c);return!!(s&&p&&I.isBefore(x)||s&&p&&x.isAfter(I))};function m(s){const c=s.time_intervals.map((I,x)=>{const{times:j,weekdays:B,days_of_month:G,months:D,years:C,location:y}=I,L=(0,v.Dm)(j,y),W=(0,v.uH)(B),S=(0,v.UL)(G),R=(0,v.$P)(D),U=(0,v.mP)(C);return(0,e.jsx)(O.Fragment,{children:(0,e.jsxs)("div",{children:[`${L} ${W}`,(0,e.jsx)("br",{}),[S,R,U].join(" | "),(0,e.jsx)("br",{})]})},JSON.stringify(I)+x)});return(0,e.jsx)(A.B,{direction:"column",gap:1,children:c})}},54937:(K,h,n)=>{n.d(h,{u:()=>j});var e=n(74848),T=n(22803),u=n(96540),O=n(63142),A=n(66404),v=n(34999),_=n(41654),P=n(18857),g=n(76319),l=n(56840),m=n(24961),s=n(5358),p=n(97507);const c=500,I=D=>new Promise(C=>setTimeout(C,D)),x=1e3,j=({selectProps:D,showRefreshButton:C,selectedContactPointName:y,onError:L=()=>{}})=>{const{selectedAlertmanager:W}=(0,s.VI)(),{contactPoints:S,isLoading:R,error:U,refetch:F}=(0,p.dK)({alertmanager:W}),[$,N]=(0,u.useState)(!1),V=(0,O.of)(G),a=S.map(r=>({label:r.name,value:r,component:()=>(0,e.jsx)(A.E,{variant:"bodySmall",color:"secondary",children:(0,e.jsx)(m.yz,{receivers:r.grafana_managed_receiver_configs,limit:2})})})),t=(0,u.useMemo)(()=>a.find(r=>r.value?.name===y)||null,[a,y]),i=()=>{N(!0),Promise.all([F(),I(x)]).finally(()=>{N(!1)})};return(0,u.useEffect)(()=>{!R&&y&&!t&&L(new Error(`Contact point "${y}" could not be found`))},[R,t,L,y]),U?(0,e.jsx)(v.F,{title:(0,l.t)("alerting.contact-point-selector.title-failed-to-fetch-contact-points","Failed to fetch contact points"),severity:"error"}):(0,e.jsxs)(_.B,{children:[(0,e.jsx)(P.l6,{virtualized:a.length>c,options:a,value:t,...D,isLoading:R,disabled:R}),C&&(0,e.jsx)(g.K,{name:"sync",onClick:i,"aria-label":(0,l.t)("alerting.contact-point-selector.aria-label-refresh-contact-points","Refresh contact points"),tooltip:(0,l.t)("alerting.contact-point-selector.tooltip-refresh-contact-points-list","Refresh contact points list"),className:(0,T.cx)(V.refreshButton,{[V.loading]:$||R})})]})},B=(0,T.keyframes)({from:{transform:"rotate(0deg)"},to:{transform:"rotate(720deg)"}}),G=D=>({refreshButton:(0,T.css)({color:D.colors.text.secondary,cursor:"pointer",borderRadius:D.shape.radius.circle,overflow:"hidden"}),loading:(0,T.css)({pointerEvents:"none",[D.transitions.handleMotion("no-preference")]:{animation:`${B} 2s infinite linear`},[D.transitions.handleMotion("reduce")]:{animation:`${B} 6s infinite linear`}})})},21563:(K,h,n)=>{n.d(h,{V:()=>p});var e=n(74848),T=n(96540),u=n(63527),O=n(30703),A=n(38055),v=n(22803),_=n(63142),P=n(56840),g=n(72649);function l(){const c=(0,_.of)(s);return(0,e.jsxs)("div",{children:["Prometheus duration format consist of a number followed by a time unit.",(0,e.jsx)("br",{}),"Different units can be combined for more granularity.",(0,e.jsx)("hr",{}),(0,e.jsxs)("div",{className:c.list,children:[(0,e.jsxs)("div",{className:c.header,children:[(0,e.jsx)("div",{children:(0,e.jsx)(P.x6,{i18nKey:"alerting.prom-duration-docs.symbol",children:"Symbol"})}),(0,e.jsx)("div",{children:(0,e.jsx)(P.x6,{i18nKey:"alerting.prom-duration-docs.time-unit",children:"Time unit"})}),(0,e.jsx)("div",{children:(0,e.jsx)(P.x6,{i18nKey:"alerting.prom-duration-docs.example",children:"Example"})})]}),(0,e.jsx)(m,{unit:g.y.seconds,name:"seconds",example:"20s"}),(0,e.jsx)(m,{unit:g.y.minutes,name:"minutes",example:"10m"}),(0,e.jsx)(m,{unit:g.y.hours,name:"hours",example:"4h"}),(0,e.jsx)(m,{unit:g.y.days,name:"days",example:"3d"}),(0,e.jsx)(m,{unit:g.y.weeks,name:"weeks",example:"2w"}),(0,e.jsxs)("div",{className:c.examples,children:[(0,e.jsx)("div",{children:(0,e.jsx)(P.x6,{i18nKey:"alerting.prom-duration-docs.multiple-units-combined",children:"Multiple units combined"})}),(0,e.jsx)("code",{children:"1m30s, 2h30m20s, 1w2d"})]})]})]})}function m({unit:c,name:I,example:x}){const j=(0,_.of)(s);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:j.unit,children:c}),(0,e.jsx)("div",{children:I}),(0,e.jsx)("code",{children:x})]})}const s=c=>({unit:(0,v.css)({fontWeight:c.typography.fontWeightBold}),list:(0,v.css)({display:"grid",gridTemplateColumns:"max-content 1fr 2fr",gap:c.spacing(1,3)}),header:(0,v.css)({display:"contents",fontWeight:c.typography.fontWeightBold}),examples:(0,v.css)({display:"contents","& > div":{gridColumn:"1 / span 2"}})}),p=(0,T.forwardRef)((c,I)=>(0,e.jsx)(u.p,{suffix:(0,e.jsx)(A.B,{content:(0,e.jsx)(l,{}),disabled:!1,children:(0,e.jsx)(O.I,{name:"info-circle",size:"lg"})}),...c,ref:I}));p.displayName="PromDurationInput"},65120:(K,h,n)=>{n.d(h,{t:()=>T});var e=n(22803);const T=u=>({container:(0,e.css)({alignItems:"center",display:"flex",flexFlow:"row nowrap","& > * + *":{marginLeft:u.spacing(1)}}),input:(0,e.css)({flex:1}),promDurationInput:(0,e.css)({maxWidth:u.spacing(32)}),timingFormContainer:(0,e.css)({padding:u.spacing(1)}),linkText:(0,e.css)({textDecoration:"underline"}),collapse:(0,e.css)({border:"none",background:"none",color:u.colors.text.primary})})},92649:(K,h,n)=>{n.d(h,{G:()=>e});const e={groupWait:{label:"Group wait",description:"The wait time before sending the first notification for a new group of alerts. If empty, it is inherited from the parent policy.",ariaLabel:"Group wait value"},groupInterval:{label:"Group interval",description:"The wait time before sending a notification about changes in the alert group after the first notification has been sent. If empty, it is inherited from the parent policy.",ariaLabel:"Group interval value"},repeatInterval:{label:"Repeat interval",description:"The wait time before resending a notification that has already been sent successfully.",ariaLabel:"Repeat interval value"}}},61474:(K,h,n)=>{n.d(h,{H:()=>e});const e={group_wait:"30s",group_interval:"5m",repeat_interval:"4h"}}}]);

//# sourceMappingURL=9368.055933397f8a7d14f4d0.js.map