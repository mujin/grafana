"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3124],{61048:(te,gt,t)=>{t.d(gt,{i:()=>st});var R=t(74848),Q=t(22803),X=t(63142);const st=({children:j,className:e})=>{const at=(0,X.of)(k);return(0,R.jsx)("div",{className:(0,Q.cx)(at.wrapper,e),children:j})},k=j=>({wrapper:(0,Q.css)({display:"flex",flexDirection:"column",fontSize:j.typography.bodySmall.fontSize})})},24131:(te,gt,t)=>{t.r(gt),t.d(gt,{plugin:()=>we});var R=t(16207),Q=t(83340),X=t(64394),st=t(38809),k=t(38919),j=t(95004),e=t(739),at=t(99555),Mt=t(44017),Ht=t(45013),Rt=t(79277),jt=t(41069),bt=t(14099),Ot=t(99709),K=t(74848),a=t(96540),g=t(14477),h=t(53568),m=t(23414),d=t(63142),E=t(54735),M=t(92790),y=t(69234),P=t(78308),b=t(2543),I=t(33553),_=t(76637),Dt=t(78055),mt=t(36192),H=t(68706);function F(i,n){return n[0].fields.slice(1).some(r=>!r.config.custom?.hideFrom?.legend)}const St=(0,a.memo)(({data:i,placement:n,calcs:r,displayMode:C,colorField:w,...A})=>{const p=(0,d.$j)(),tt=i[0].fields[0].config,Z=tt.color?.mode,D=[];if(Z===X.Y.Thresholds){const f={mode:I.O.Absolute,steps:[]},O={mode:I.O.Percentage,steps:[]};for(let it=1;it<i[0].fields.length;it++){const J=i[0].fields[it];if(J.config.thresholds&&J.config.thresholds.steps.length>1)if(J.config.thresholds.mode===I.O.Absolute)for(const T of J.config.thresholds.steps)(0,b.includes)(f.steps,T)||f.steps.push(T);else for(const T of J.config.thresholds.steps)(0,b.includes)(O.steps,T)||O.steps.push(T)}const G=(0,H.EI)(tt,p,f),ft=(0,H.EI)(tt,p,O);D.push(...G,...ft)}const et=[];for(let f=1;f<i[0].fields.length;f++){const O=i[0].fields[f].config.mappings;if(O)for(const G of O)(0,b.includes)(et,G)||et.push(G)}const dt=(0,H.K1)(et,p),pt=i[0].fields.slice(1).map((f,O)=>{const ft=O+1;if(!f||f.config.custom?.hideFrom?.legend)return;const it=f.state?.displayName??f.name,J=(0,_.lz)(f,p).color;return{disabled:f.state?.hideFrom?.viz,color:J,label:it,yAxis:f.config.custom?.axisPlacement===e.vM.Right?2:1,getDisplayValues:()=>(0,mt.UO)(r,f,p),getItemKey:()=>`${it}-0-${ft}`}}).filter(f=>f!==void 0);return(0,K.jsx)(E.KU.Legend,{placement:n,...A,children:(0,K.jsx)(Dt.t,{placement:n,items:pt,thresholdItems:D,mappingItems:dt,displayMode:C,sortBy:A.sortBy,sortDesc:A.sortDesc,isSortable:!0})})});St.displayName="BarChartLegend";var W=t(36613),q=t(16515),Kt=t(8721),Jt=t(11576),Et=t(55386),N=t(21275),V=t(47276),Ct=t(62748),At=t(76234),ee=t(5421),wt=t(80011),ie=t(6773),Tt=t(46485),Qt=t(81897);const Ft=ee.WC.interval,fe=Tt.ur,pe=Tt.ur,ye=8,ue=30,xe=.65,Me=.1,Oe=.15,Se=5,Ee=10,Pe=.1;function De(i,n,r,C,w){const A=(0,h.kD)(i,14),p=n/(A.width+2)*14,tt=r/C,Z=Math.min(tt,p);return{fontSize:Math.min(Z,w??Z),textMetrics:A}}function Ce(i,n){const{xOri:r,xDir:C,rawValue:w,getColor:A,formatValue:p,formatShortValue:tt,fillOpacity:Z=1,showValue:D,xSpacing:et=0,hoverMulti:dt=!1,timeZone:pt="browser"}=i,f=r===e.Lt.Horizontal,O=!i.text?.valueSize,G=i.stacking!==e.gs.None,ft=i.stacking===e.gs.Percent;let{groupWidth:it,barWidth:J,barRadius:T=0}=i;G&&([it,J]=[J,it]);let U;const ut=Array(30).fill(null);let rt;const Y=o=>Array.from(o.data[0].map((l,s)=>s)),lt=et===0?void 0:(o,l)=>{const s=o.bbox.width,x=C*(f?1:-1);let v=l.length,S=v-1,L=0,vt=s/W.A.pxRatio,ct=Math.abs(Math.floor(vt/et));L=v<ct?0:Math.ceil(v/ct);let Gt=l.map((yt,Yt)=>L!==0&&(et>0?Yt:S-Yt)%L>0?null:yt);return x===1?Gt:Gt.reverse()},ht=(o,l,s,x,v)=>{if(i.xTimeAuto){let S=Ft.year;return v<m.Zj.second?S=Ft.millisecond:v<m.Zj.minute?S=Ft.second:v<m.Zj.hour?S=Ft.minute:v<m.Zj.day?S=Ft.hour:v<m.Zj.month?S=Ft.day:v<m.Zj.year?S=Ft.month:S=Ft.year,l.map(L=>L==null?"":(0,wt.LE)(L,{format:S,timeZone:pt}))}return l.map(S=>f?tt(0,S):p(0,S))},Nt=(o,l,s)=>{l=0,s=Math.max(1,o.data[0].length-1);let x=0;(0,Tt.mn)(o.data[0].length,it,fe,0,(S,L,vt)=>{x=L+vt/2});let v=s-l;if(x===.5)l-=v;else{let L=(1/(1-x*2)*v-v)/2;l-=L,s+=L}return[l,s]};let ne=(o,l)=>{let s=Array.from({length:l},()=>({offs:Array(o).fill(0),size:Array(o).fill(0)}));return(0,Tt.mn)(o,it,fe,null,(x,v,S)=>{(0,Tt.mn)(l,J,pe,null,(L,vt,ct)=>{s[L].offs[x]=v+S*vt,s[L].size[x]=S*ct})}),s},nt=(o,l)=>{let s=Array.from({length:l},()=>({offs:Array(o).fill(0),size:Array(o).fill(0)}));return(0,Tt.mn)(o,it,fe,null,(x,v,S)=>{(0,Tt.mn)(l,J,pe,null,(L,vt,ct)=>{s[L].offs[x]=v,s[L].size[x]=S})}),s};const Ut=f?Me:Oe,zt=f?Se:Ee;let Wt=[],B=[],u=1,c,z=i.text?.valueSize??ue,$=zt,Vt=1/0,Lt=1/0,$t=A!=null,qt=$t?{fill:{unit:3,values:(o,l)=>B[l].fill},stroke:{unit:3,values:(o,l)=>B[l].stroke}}:{},xt=W.A.paths.bars({radius:ft?0:G?(o,l)=>l===o.data.length-1?[T,0]:[0,0]:T,disp:{x0:{unit:2,values:(o,l)=>Wt[l].offs},size:{unit:2,values:(o,l)=>Wt[l].size},...qt},each:(o,l,s,x,v,S,L)=>{x-=o.bbox.left,v-=o.bbox.top;let vt=o.data[l][s];f?(Vt=Math.min(Vt,vt<0?o.bbox.height-(v+L):v),Lt=S):(Vt=L,Lt=Math.min(Lt,vt<0?x:o.bbox.width-(x+S)));let ct={x,y:v,w:S,h:L,sidx:l,didx:s};if(!G&&i.fullHighlight&&(i.xOri===e.Lt.Horizontal?(ct.y=0,ct.h=o.bbox.height):(ct.x=0,ct.w=o.bbox.width)),U.add(ct),D!==e.yL.Never){const Gt=w(l,s);let yt=1;ft&&ce[l][s]&&(yt=ce[l][s]);const Yt=yt===0?0:Gt/yt,oe=p(l,Yt);if($=Math.min($,Math.round(Ut*(f?S:L))),c[s]===void 0&&(c[s]={}),c[s][l]={text:oe,value:w(l,s),hidden:!1},O){const{fontSize:Xt,textMetrics:It}=De(c[s][l].text,Lt*(f?xe:1)-(f?0:$),Vt*(f?1:xe)-(f?$:0),1);c[s][l].textMetrics=It;let ot=Math.round(Math.min(z,ue,Xt));u=ot/z*(ot/14),z=ot}else c[s][l].textMetrics=(0,h.kD)(c[s][l].text,z);let de=f?0:-Math.round(Pe*z),Pt=w(l,s);if(i.negY?.[l]&&Pt!=null&&(Pt*=-1),Pt!=null){const Xt=o.bbox.left+(f?x+S/2:Pt<0?x-$:x+S+$);let It=o.bbox.top+(f?Pt<0?v+L+$:v-$:v+L/2-de);const{textMetrics:ot={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=c[s][l];let ae=0,se=0;f?(ae=ot.width*u/2,se=Pt>0?(ot.actualBoundingBoxAscent+ot.actualBoundingBoxDescent)*u:0):(se=(ot.actualBoundingBoxAscent+ot.actualBoundingBoxDescent)*u/2,ae=Pt<0?ot.width*u:0),It-se<0&&(It=se),c[s][l].x=Xt,c[s][l].y=It,c[s][l].bbox={x:Xt-ae,y:It-se,w:ot.width*u,h:(ot.actualBoundingBoxAscent+ot.actualBoundingBoxDescent)*u}}}}});const kt=o=>{o.root.querySelectorAll(".u-cursor-pt").forEach(l=>{l.style.borderRadius="0",i.fullHighlight&&(l.style.zIndex="-1")})},ge={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(o,l)=>{if(l===0){ut.fill(null),rt=null;let s=o.cursor.left*W.A.pxRatio,x=o.cursor.top*W.A.pxRatio;U.get(s,x,1,1,v=>{(0,Qt.ur)(s,x,v.x,v.y,v.x+v.w,v.y+v.h)&&(rt=ut[0]=v,ut[rt.sidx]=rt,dt&&(0,Qt.Tr)(U,void 0,rt.didx).forEach(S=>{ut[S.sidx]=S}))})}return ut[l]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(o,l)=>{let s=ut[l],x=s!=null;return{left:x?s.x/W.A.pxRatio:-10,top:x?s.y/W.A.pxRatio:-10,width:x?s.w/W.A.pxRatio:0,height:x?s.h/W.A.pxRatio:0}}},focus:{prox:1e3,dist:(o,l)=>rt?.sidx===l?0:1/0}},me=o=>{if(U=U||new Qt.C$(0,0,o.bbox.width,o.bbox.height),U.clear(),o.series.forEach(l=>{l._paths=null}),G?Wt=[null,...nt(o.data[0].length,o.data.length-1)]:Wt=[null,...ne(o.data[0].length,o.data.length-1)],$t){B=[null];for(let l=1;l<o.data.length;l++){let s=o.data[l].map((x,v)=>x!=null?A(l,v,x):null);B.push({fill:Z<1?s.map(x=>x!=null?ie.MV.alpha(x,Z):null):s,stroke:s})}}c={},z=i.text?.valueSize??ue,$=zt,Vt=Lt=1/0},$e=o=>{if(D===e.yL.Never||z<ye)return;o.ctx.save(),o.ctx.fillStyle=n.colors.text.primary,o.ctx.font=`${z}px ${n.typography.fontFamily}`;let l,s;for(const x in c){let v=!0;for(const S in c[x]){const L=c[x][S],{text:vt,x:ct=0,y:Gt=0}=L;let{value:yt}=L;i.negY?.[S]&&yt!=null&&(yt*=-1);let Yt=f?"center":yt!==null&&yt<0?"right":"left",oe=f?yt!==null&&yt<0?"top":"alphabetic":"middle";if(Yt!==l&&(o.ctx.textAlign=l=Yt),oe!==s&&(o.ctx.textBaseline=s=oe),D===e.yL.Always)o.ctx.fillText(vt,ct,Gt);else if(D===e.yL.Auto){let{bbox:de}=L,Pt=!1;if(de==null)Pt=!0,L.hidden=!0;else if(!v)for(const Xt in c[x]){if(Xt===S)continue;const It=c[x][Xt],{bbox:ot,hidden:ae}=It;if(!ae&&ot&&(0,Qt.HY)(de,ot)){Pt=!0,L.hidden=!0;break}}v=!1,!Pt&&o.ctx.fillText(vt,ct,Gt)}}}o.ctx.restore()};let ce=null;function ke(o,l){return ce=null,(0,mt.bq)(o[0],l,({totals:s})=>{ce=s})}return{cursor:ge,xRange:Nt,xValues:ht,xSplits:Y,hFilter:lt,barsBuilder:xt,init:kt,drawClear:me,draw:$e,prepData:ke}}const Bt={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:e.wV.Auto,showValue:e.yL.Auto,stacking:e.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},ve={fillOpacity:80,gradientMode:e.on.None,lineWidth:1};function Le(i,n,r,C,w,A){if(i.length===0||i.every(D=>D.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,q.Fm)(i),(0,q.j2)(i,n);let p={...i[0]};const tt=p.fields.findIndex(D=>D.type===j.PU.time);tt>=0&&i.length>1&&(p=(0,Kt.Fd)({frames:i,keepDisplayNames:!0})??p);const Z=p.fields.find(D=>D.state?.displayName===w||D.name===w)??p.fields.find(D=>D.type===j.PU.string)??p.fields[tt];if(Z!=null){const D=[Z],et=[],dt=A==null?void 0:p.fields.find(O=>O.state?.displayName===A||O.name===A);p.fields.forEach(O=>{if(O!==Z)if(O.type===j.PU.number&&!O.config.custom?.hideFrom?.viz){const G={...O,values:O.values.map(ft=>Number.isFinite(ft)?ft:null),config:{...O.config,custom:{...O.config.custom,stacking:{group:"_",mode:r}}}};D.push(G)}else et.push(O)});let pt=null;D.length===1&&(pt="No numeric fields found"),p.fields=D;const f=[p];return(0,At.O2)(f,C,0),{series:f,_rest:et,color:dt,warn:pt}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const Ae=({series:i,totalSeries:n,color:r,orientation:C,options:w,timeZone:A,theme:p})=>{let{showValue:tt,groupWidth:Z,barWidth:D,barRadius:et=0,stacking:dt,text:pt,tooltip:f,xTickLabelRotation:O,xTickLabelMaxLength:G,xTickLabelSpacing:ft=0,legend:it,fullHighlight:J}=w,T=i[0];const U=new V.e,_t=T.fields.map((B,u)=>dt===e.gs.Percent?(0,Jt.J)({field:{...B,config:{...B.config,unit:"percentunit"}},theme:p}):B.display),ut=(B,u)=>(0,Et.cN)(_t[B](u)),rt=(B,u)=>re(ut(B,u),G),Y=Be(C);T.fields.length===2&&dt===e.gs.None&&(n===1&&(Z=D),D=1);const lt=(B,u)=>T.fields[B].values[u];let ht,Nt=1;if(r!=null){const B=r.display;Nt=(r.config.custom.fillOpacity??100)/100,ht=(u,c)=>B(r.values[c]).color}else T.fields.some(u=>u.config.color?.mode===N.Yb.Thresholds||u.config.mappings?.some(z=>z.type==="value"?Object.values(z.options).some($=>$.color!=null):z.options.result.color!=null))&&(Nt=(T.fields.find(c=>c.type===j.PU.number)?.config?.custom?.fillOpacity??100)/100,ht=(c,z)=>{let $=T.fields[c];return $.display($.values[z]).color});const ne={xOri:Y.xOri,xDir:Y.xDir,groupWidth:Z,barWidth:D,barRadius:et,stacking:dt,rawValue:lt,getColor:ht,fillOpacity:Nt,formatValue:ut,formatShortValue:rt,timeZone:A,text:pt,showValue:tt,legend:it,xSpacing:ft,xTimeAuto:T.fields[0]?.type===j.PU.time&&!T.fields[0].config.unit?.startsWith("time:"),negY:T.fields.map(B=>B.config.custom?.transform===e.NU.NegativeY),fullHighlight:J,hoverMulti:f.mode===e.$N.Multi},nt=Ce(ne,p);if(U.setCursor(nt.cursor),U.addHook("init",nt.init),U.addHook("drawClear",nt.drawClear),U.addHook("draw",nt.draw),O!==0){let B=50,u=Y.xOri===e.Lt.Horizontal?14:5;U.setPadding(Te(T,O,G,B,u))}U.setPrepData(nt.prepData),U.addScale({scaleKey:"x",isTime:!1,range:nt.xRange,distribution:e.L4.Ordinal,orientation:Y.xOri,direction:Y.xDir});const Ut=T.fields[0]?.config.custom?.axisPlacement!==e.vM.Hidden?Y.xOri===e.Lt.Horizontal?e.vM.Bottom:e.vM.Left:e.vM.Hidden,zt=T.fields[0]?.config.custom?.axisPlacement!==e.vM.Hidden;U.addAxis({scaleKey:"x",isTime:!1,placement:Ut,label:T.fields[0]?.config.custom?.axisLabel,splits:nt.xSplits,filter:Y.xOri===0?nt.hFilter:void 0,values:nt.xValues,timeZone:A,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:Y.xOri===0?O*-1:0,theme:p,show:zt});for(let B=1;B<T.fields.length;B++){const u=T.fields[B],c={...ve,...u.config.custom},z=u.config.unit||Ct.s,$=(0,_.Qi)(u),Lt=(0,_.lz)(u,p).color;let $t=c.axisSoftMin,qt=c.axisSoftMax;if($t==null&&u.config.min==null&&($t=0),qt==null&&u.config.max==null&&(qt=0),c.thresholdsStyle&&u.config.thresholds&&(c.thresholdsStyle.mode??e.Ly.Off)!==e.Ly.Off&&U.addThresholds({config:c.thresholdsStyle,thresholds:u.config.thresholds,scaleKey:z,theme:p,hardMin:u.config.min,hardMax:u.config.max,softMin:c.axisSoftMin,softMax:c.axisSoftMax}),U.addSeries({scaleKey:z,pxAlign:!0,lineWidth:c.lineWidth,lineColor:Lt,fillOpacity:c.fillOpacity,theme:p,colorMode:$,pathBuilder:nt.barsBuilder,show:!c.hideFrom?.viz,gradientMode:c.gradientMode,thresholds:u.config.thresholds,hardMin:u.config.min,hardMax:u.config.max,softMin:c.axisSoftMin,softMax:c.axisSoftMax}),U.addScale({scaleKey:z,min:u.config.min,max:u.config.max,softMin:$t,softMax:qt,centeredZero:c.axisCenteredZero,orientation:Y.yOri,direction:Y.yDir,distribution:c.scaleDistribution?.type,log:c.scaleDistribution?.log,decimals:u.config.decimals}),c.axisPlacement!==e.vM.Hidden){let xt=c.axisPlacement;(!xt||xt===e.vM.Auto)&&(xt=e.vM.Left),Y.xOri===1&&(xt===e.vM.Left&&(xt=e.vM.Bottom),xt===e.vM.Right&&(xt=e.vM.Top));let kt={scaleKey:z,label:c.axisLabel,size:c.axisWidth,placement:xt,formatValue:(ge,me)=>(0,Et.cN)(u.display(ge,me)),filter:Y.yOri===0?nt.hFilter:void 0,tickLabelRotation:Y.xOri===1?O*-1:0,theme:p,grid:{show:c.axisGridShow},decimals:u.config.decimals};c.axisBorderShow&&(kt.border={show:!0}),c.axisColorMode===e.Y$.Series&&(kt.color=Lt),U.addAxis(kt)}}let Wt=(0,mt.ro)(T);return U.setStackingGroups(Wt),{builder:U,prepData:(B,u)=>(i=B,T=i[0],r=u,U.prepData(i))}};function re(i,n){return i.length>n?i.substring(0,n).concat("..."):i}function Te(i,n,r,C=0,w=0){const A=i.fields[0].values,p=m.pi,tt=i.fields[0].display,Z=f=>tt?tt(A[f]):A[f];let D=0;for(let f=0;f<A.length;f++){let O=(0,h.kD)(re((0,Et.cN)(Z(f)),r),p);D=O.width>D?O.width:D}const et=n>0?Math.cos(n*Math.PI/180)*(0,h.kD)(re((0,Et.cN)(Z(A.length-1)),r),p).width:0,dt=n<0?Math.cos(n*-1*Math.PI/180)*(0,h.kD)(re((0,Et.cN)(Z(0)),r),p).width:0,pt=Math.sin((n>=0?n:n*-1)*Math.PI/180)*D-w;return[Math.round(m.pi*W.A.pxRatio),et,pt,Math.max(0,dt-C)]}function Be(i){return i===e.wV.Vertical?{xOri:e.Lt.Horizontal,xDir:e.ON.Right,yOri:e.Lt.Vertical,yDir:e.ON.Up}:{xOri:e.Lt.Vertical,xDir:e.ON.Down,yOri:e.Lt.Horizontal,yDir:e.ON.Right}}const Re=(0,h.kD)("M",m.pi).width,be=Math.PI/180,Fe=i=>{const{data:n,options:r,fieldConfig:C,width:w,height:A,timeZone:p,id:tt,replaceVariables:Z}=i,D=(0,d.$j)(),{barWidth:et,barRadius:dt=0,showValue:pt,groupWidth:f,stacking:O,legend:G,tooltip:ft,text:it,xTickLabelRotation:J,xTickLabelSpacing:T,fullHighlight:U,xField:_t,colorByField:ut}=r;let{orientation:rt,xTickLabelMaxLength:Y=0}=r;rt=rt===k.wV.Auto?w<A?k.wV.Horizontal:k.wV.Vertical:rt,Y=J===0?1/0:Y||Math.floor(A/2/Math.sin(Math.abs(J*be))/Re-3);const lt=(0,a.useMemo)(()=>Le(n.series,C,O,D,_t,ut),[n.series,C,O,D,_t,ut]),ht=(0,a.useMemo)(()=>lt.series.map(u=>({...u,fields:u.fields.filter((c,z)=>z===0||!c.state?.hideFrom?.viz)})),[lt.series]),Nt=ht[0]?.length??0,ne=ht[0]?.fields.length??0,nt=Math.max(0,(lt.series[0]?.fields.length??0)-1);let{builder:Ut,prepData:zt}=(0,a.useMemo)(()=>Nt===0?{builder:null,prepData:null}:Ae({series:ht,totalSeries:nt,color:lt.color,orientation:rt,options:r,timeZone:p,theme:D}),[rt,p,i.data.structureRev,nt,ne,Nt,et,dt,pt,f,O,G,ft,it?.valueSize,J,T,U,_t,ut,Y]);const Wt=(0,a.useMemo)(()=>zt==null?[]:zt(ht,lt.color),[zt,ht,lt.color]);if(lt.warn!=null||Ut==null)return(0,K.jsx)(g.a,{panelId:tt,fieldConfig:C,data:n,message:lt.warn??"",needsNumberField:!0});const B=G.showLegend&&F(Ut,lt.series)?(0,K.jsx)(St,{data:lt.series,colorField:lt.color,...G}):null;return(0,K.jsx)(E.KU,{width:i.width,height:i.height,legend:B,children:(u,c)=>(0,K.jsx)(M.Z,{config:Ut,data:Wt,width:u,height:c,children:i.options.tooltip.mode!==e.$N.None&&(0,K.jsx)(y.xl,{config:Ut,maxWidth:r.tooltip.maxWidth,hoverMode:r.tooltip.mode===e.$N.Single?y.b3.xOne:y.b3.xAll,getDataLinks:(z,$)=>ht[0].fields[z].getLinks?.({valueRowIndex:$})??[],render:(z,$,Vt,Lt,$t,qt,xt,kt)=>(0,K.jsx)(P.k,{series:ht[0],_rest:lt._rest,dataIdxs:$,seriesIdx:Vt,mode:r.tooltip.mode,sortOrder:r.tooltip.sort,isPinned:Lt,maxHeight:r.tooltip.maxHeight,replaceVariables:Z,dataLinks:kt,hideZeros:r.tooltip.hideZeros})})})})};var Ne=t(32881),Ue=t(77824),ze=t(45967),We=t(32635);const he=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],Ve=i=>{let n=i.value??0;const r=n<0;r&&(n*=-1);let C=he[0];for(const p of he)if(C=p,n<=C.value)break;const w=p=>{i.onChange(p*(r?-1:1))},A=()=>{i.onChange(i.value*-1)};return(0,K.jsxs)(Ne.Gy,{children:[(0,K.jsx)(Ue.z,{value:C.value,options:he,onChange:w}),n!==0&&(0,K.jsx)(ze.m,{content:"Require space from the right side",placement:"top",children:(0,K.jsx)("div",{children:(0,K.jsx)(We.S,{value:r,onChange:A,label:"RTL"})})})]})};var Ie=t(57866),le=t(46644);const He=(i,n,r)=>{if(n==="graph"){const C=r.angular,w=i.fieldConfig??{defaults:{},overrides:[]};if(C.xaxis?.mode==="series"){const A=i.transformations||[];A.push({id:"reduce",options:{reducers:je(C.xaxis?.values)}},{id:"transpose",options:{}}),i.transformations=A,w.overrides.push({matcher:{id:Ie.Ct.byName,options:"Field"},properties:[{id:"custom.axisPlacement",value:e.vM.Hidden}]}),i.fieldConfig=w,i.options={...i.options,groupWidth:1}}}return{}},je=i=>{const n=[];return i?.forEach(r=>{Object.values(le.gy).includes(r)?n.push(r):r==="current"?n.push(le.gy.lastNotNull):r==="total"?n.push(le.gy.sum):r==="avg"&&n.push(le.gy.mean)}),i?n:[le.gy.sum]};var Zt=t(73495);class Ke{getListWithDefaults(n){return n.getListAppender({name:Zt.m.BarChart,pluginId:"barchart",options:{showValue:e.yL.Never,legend:{calcs:[],displayMode:e.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:r=>{r.options.barWidth=.8}}})}getSuggestionsForData(n){const r=this.getListWithDefaults(n),{dataSummary:C}=n;C.frameCount===1&&(!C.hasNumberField||!C.hasStringField||C.rowCountTotal>50||(r.append({name:Zt.m.BarChart}),C.numberFieldCount>1&&(r.append({name:Zt.m.BarChartStacked,options:{stacking:e.gs.Normal}}),r.append({name:Zt.m.BarChartStackedPercent,options:{stacking:e.gs.Percent}})),r.append({name:Zt.m.BarChartHorizontal,options:{orientation:k.wV.Horizontal}}),C.numberFieldCount>1&&(r.append({name:Zt.m.BarChartHorizontalStacked,options:{stacking:e.gs.Normal,orientation:k.wV.Horizontal}}),r.append({name:Zt.m.BarChartHorizontalStackedPercent,options:{orientation:k.wV.Horizontal,stacking:e.gs.Percent}}))))}}const we=new R.m(Fe).setPanelChangeHandler(He).useFieldConfig({standardOptions:{[Q.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:X.Y.PaletteClassic}},[Q.uo.Links]:{settings:{showOneClick:!0}},[Q.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:i=>{const n=ve;i.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:n.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:n.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:at.t.fillGradient[0].value,settings:{options:at.t.fillGradient}}),i.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:e.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:e.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),i.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:e.Ly.Off},settings:{options:at.t.thresholdsDisplayModes},editor:Ot.D,override:Ot.D,process:st.hS,shouldApply:()=>!0}),Mt.rg(i,n),Ht.e(i)}}).setPanelOptions(i=>{i.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:k.wV.Auto,label:"Auto"},{value:k.wV.Horizontal,label:"Horizontal"},{value:k.wV.Vertical,label:"Vertical"}]},defaultValue:Bt.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:Bt.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:n=>n.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:Bt.xTickLabelSpacing,editor:Ve}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:e.yL.Auto,label:"Auto"},{value:e.yL.Always,label:"Always"},{value:e.yL.Never,label:"Never"}]},defaultValue:Bt.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:at.t.stacking},defaultValue:Bt.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:Bt.groupWidth,settings:{min:0,max:1,step:.01},showIf:(n,r)=>n.stacking&&n.stacking!==e.gs.None?!1:Ze(r)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:Bt.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:Bt.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:Bt.fullHighlight,showIf:n=>n.stacking===e.gs.None}),i.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),Rt.D(i,!1,!1,Rt.U),jt.H(i),bt.I(i,!1)}).setSuggestionsSupplier(new Ke);function Ze(i){let n=0;if(i)for(const r of i)for(const C of r.fields)C.type===j.PU.number&&n++;return n}},78308:(te,gt,t)=>{t.d(gt,{k:()=>bt});var R=t(74848),Q=t(55386),X=t(95004),st=t(739),k=t(55302),j=t(39064),e=t(61048),at=t(41530),Mt=t(47466),Ht=t(16913),Rt=t(74542),jt=t(76234);const bt=({series:Ot,_rest:K,dataIdxs:a,seriesIdx:g,mode:h=st.$N.Single,sortOrder:m=st.xB.None,isPinned:d,annotate:E,maxHeight:M,replaceVariables:y=I=>I,dataLinks:P,hideZeros:b})=>{const I=Ot.fields[0],_=(0,Q.cN)(I.display(I.values[a[0]])),Dt=(0,k.cp)(Ot.fields,I,a,g,h,m,F=>F.type===X.PU.number||F.type===X.PU.enum,b);K?.forEach(F=>{F.config.custom?.hideFrom?.tooltip||Dt.push({label:F.state?.displayName??F.name,value:(0,Rt.Sc)(F,F.values[a[0]])})});let mt;if(g!=null){const F=Ot.fields[g],St=P.some(W=>W.oneClick===!0);if(d||St){const W=a[g],q=(0,Ht.OG)(Ot,F,y,W);mt=(0,R.jsx)(j.S,{dataLinks:P,actions:q,annotate:E})}}const H=I.config.custom?.hideFrom?.tooltip?null:{label:I.type===X.PU.time?"":I.state?.displayName??I.name,value:_};return(0,R.jsxs)(e.i,{children:[H!=null&&(0,R.jsx)(at.A,{item:H,isPinned:d}),(0,R.jsx)(Mt.o,{items:Dt,isPinned:d,scrollable:(0,jt.T5)({mode:h,maxHeight:M}),maxHeight:M}),mt]})}},76234:(te,gt,t)=>{t.d(gt,{B_:()=>Rt,Fg:()=>Ot,O2:()=>bt,T5:()=>K});var R=t(95004),Q=t(16515),X=t(63409),st=t(34455),k=t(55386),j=t(11576),e=t(406),at=t(739),Mt=t(70332);function Ht(a){let g=new Map;return a.map(m=>({...m,fields:m.fields.map(d=>{if(d.type===R.PU.enum){let E=(0,Mt.M)(d.config,d.type),M=g.get(E);M||(M=[],g.set(E,M));let y=d.values.toArray().slice(),P=d.config.type.enum.text;if(M.length>0)for(let b=0;b<y.length;b++)y[b]+=M.length;return M.push(...P),d.config.type.enum.text=M,{...d,values:y}}return d})}))}function Rt(a,g,h,m){if(!a?.length)return null;(0,Q.Fm)(a);let d=m!=null;m!=null&&m>0&&(a=[{...a[0],fields:[a[0].fields[m],...a[0].fields.filter((P,b)=>b!==m)]}]);for(let P of a)for(let b of P.fields)b.type===R.PU.time&&typeof b.values[0]!="number"&&(b.values=(0,e.s7)(b,{destinationType:R.PU.time}).values);let E=0;t:for(let P of a)for(let b of P.fields)if(b.type===R.PU.enum&&++E>1){a=Ht(a);break t}let M;const y=[];for(let P of a){const b=[];let I=!1,_=!1,Dt=d?P:(0,X.M)({frame:P,refFieldPseudoMin:h?.from.valueOf(),refFieldPseudoMax:h?.to.valueOf()});const mt=(0,st.C)(Dt).fields;for(let H=0;H<(mt?.length||0);H++){const F=mt[H];switch(F.type){case R.PU.time:I=!0,b.push(F);break;case R.PU.number:_=d?H>0:!0,M={...F,values:F.values.map(q=>Number.isFinite(q)||q==null?q:null)},b.push(M);break;case R.PU.enum:_=!0;case R.PU.string:M={...F,values:F.values},b.push(M);break;case R.PU.boolean:_=!0;const St=F.config?.custom??{},W={...F.config,max:1,min:0,custom:St};St.lineInterpolation!==at.dx.StepBefore&&(St.lineInterpolation=at.dx.StepAfter),M={...F,config:W,type:R.PU.number,values:F.values.map(q=>q==null?q:q?1:0)},(0,k.j9)(W.unit)||(W.unit="bool",M.display=(0,j.J)({field:M,theme:g})),b.push(M);break}}(d||I)&&_&&y.push({...P,length:Dt.length,fields:b})}return y.length?(bt(y,g,0),jt(y,g),y):null}const jt=(a,g)=>{const{palette:h}=g.visualization;for(const m of a)for(const d of m.fields)if(d.type===R.PU.enum){const E=h[d.state?.seriesIndex%h.length],M=g.visualization.getColorByName(E),y=d.config.type.enum;y.color=Array(y.text.length).fill(M),d.display=(0,j.J)({field:d,theme:g})}},bt=(a,g,h)=>{let m=0;a.forEach(d=>{d.fields.forEach((E,M)=>{M!==h&&(E.type===R.PU.number||E.type===R.PU.boolean||E.type===R.PU.enum)&&(E.state={...E.state,seriesIndex:m++},E.display=(0,j.J)({field:E,theme:g}))})})};function Ot(a,g){return!a||!a.length?[g]:a.map(h=>h?.length?h:g)}const K=a=>a.mode===at.$N.Multi&&a.maxHeight!=null},99914:(te,gt,t)=>{t.d(gt,{Oq:()=>X,QB:()=>k,it:()=>Q,uZ:()=>R});var R=(e=>(e.Circle="circle",e.Square="square",e))(R||{}),Q=(e=>(e.Auto="auto",e.Manual="manual",e))(Q||{}),X=(e=>(e.Lines="lines",e.Points="points",e.PointsAndLines="points+lines",e))(X||{});const st={id:""},k={fillOpacity:50,show:"points"},j={series:[]}},74542:(te,gt,t)=>{t.d(gt,{Sc:()=>Ht,hV:()=>jt,rE:()=>Ot});var R=t(55386),Q=t(57866),X=t(16515),st=t(36638),k=t(95004),j=t(64394),e=t(43173),at=t(739),Mt=t(99914);function Ht(a,g){return a.display?(0,R.cN)(a.display(g)):`${g}`}function Rt(a){return a.id===Q.jR.byIndex?(g,h)=>h===a.options:()=>!1}function jt(a,g,h,m){(0,X.Fm)(h),(0,X.j2)(h,m);let d=[];g.length===0&&(g=[{}]);const{palette:E,getColorByName:M}=e.$.theme2.visualization;if(g.forEach((y,P)=>{if(a===Mt.it.Manual&&(y.frame?.matcher==null||y.x?.matcher==null||y.y?.matcher==null))return;let b=(0,st.NS)(y.x?.matcher??{id:Q.Ct.byType,options:"number"}),I=(0,st.NS)(y.y?.matcher??{id:Q.Ct.byType,options:"number"}),_=y.color?(0,st.NS)(y.color.matcher):null,Dt=y.size?(0,st.NS)(y.size.matcher):null,mt=y.frame?Rt(y.frame.matcher):null;h.forEach((H,F)=>{if(mt!=null&&!mt(H,F))return;let St=[],W=[],q=H.fields.filter(N=>N.type===k.PU.number),Kt=q.find(N=>b(N,H,h)),Jt=_!=null?q.find(N=>N!==Kt&&_(N,H,h)):void 0,Et=Dt!=null?q.find(N=>N!==Kt&&N!==Jt&&Dt(N,H,h)):void 0;Kt!=null&&(q.forEach(N=>{if(N!==Kt&&!(a===Mt.it.Auto&&(N===Jt||N===Et))&&!(a===Mt.it.Manual&&W.length>0)&&I(N,H,h)&&!N.config.custom?.hideFrom?.viz){let V=N,Ct=y.name?.fixed;if(Ct==null){const ee=h.length>1&&(H.name!=null||Object.keys(V.labels??{}).length>0),{displayName:wt,displayNameFromDS:ie}=V.config,Tt=wt!=null||ie!=null;if(ee&&Tt){const Qt=V.state.displayName;V.config.displayName=V.config.displayNameFromDS=V.state.displayName=void 0,Ct=(0,X.Ct)(V,H,h),Ct=Ct.replace(V.name,ie??wt),V.config.displayName=wt,V.config.displayNameFromDS=ie,V.state.displayName=Qt}else Ct=(0,X.Ct)(V,H,h)}let At={name:{value:Ct},showPoints:V.config.custom.show===Mt.Oq.Lines?at.yL.Never:at.yL.Always,pointShape:V.config.custom.pointShape,pointStrokeWidth:V.config.custom.pointStrokeWidth,fillOpacity:V.config.custom.fillOpacity,showLine:V.config.custom.show!==Mt.Oq.Points,lineWidth:V.config.custom.lineWidth??2,lineStyle:V.config.custom.lineStyle,x:{field:Kt},y:{field:V},color:{},size:{},_rest:St};Jt!=null&&(At.color.field=Jt),Et!=null&&(At.size.field=Et,At.size.min=Et.config.custom.pointSize?.min??5,At.size.max=Et.config.custom.pointSize?.max??100),W.push(At)}}),W.length,H.fields.forEach(N=>{W.some(({x:Ct,y:At,color:ee,size:wt})=>Ct.field===N||At.field===N||ee.field===N||wt.field===N)||St.push(N)}),d.push(...W))})}),d.length!==0){let y=0;d.forEach((P,b)=>{if(P.color.field==null){let I=P.y.field.config.color??{mode:j.Y.PaletteClassic},_="";I.mode===j.Y.PaletteClassic?_=M(E[y++%E.length]):I.mode===j.Y.Fixed&&(_=M(I.fixedColor)),P.color.fixed=_}P.size.field==null&&(P.size.fixed=P.y.field.config.custom.pointSize?.fixed??5)}),bt(d)}return d}function bt(a){let g=a.map(d=>d.name.value.split(/\s+/g));const{prefix:h,suffix:m}=K(g);(h<1/0||m<1/0)&&a.forEach((d,E)=>{d.name.value=g[E].slice(h,g[E].length-m).join(" ")})}function Ot(a){let g=a.map(M=>M.split(/\s+/g)),{prefix:h,suffix:m}=K(g),d=g[0];if(d.length===1&&h===1&&m===1)return"";let E=[];return h>0&&E.push(...d.slice(0,h)),m>0&&E.push(...d.slice(-m)),E.join(" ")}function K(a){let g=1/0,h=1/0,m=a[0];for(let d=1;d<a.length;d++)a[d].length<m.length&&(m=a[d]);for(let d=1;d<a.length;d++){let E=a[d];if(E!==m){let M=0;for(let P=0;P<m.length&&E[P]===m[P];P++)M++;M<g&&(g=M);let y=0;for(let P=m.length-1;P>=0&&E[P]===m[P];P--)y++;y<h&&(h=y)}}return{prefix:g,suffix:h}}}}]);

//# sourceMappingURL=barChartPanel.2479ed24a2aca8e31093.js.map