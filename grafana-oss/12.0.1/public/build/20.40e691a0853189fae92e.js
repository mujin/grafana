"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[20],{97369:(De,ie,m)=>{m.d(ie,{S6:()=>te,Jz:()=>fe,oA:()=>ge,Ik:()=>de});var t=m(95004),d=m(69884),Z=m(11576),f=m(62599),k=m(2543);function ae(P,r){const v=X(P);return Y(v,r,"parents")}function X(P){return P.map(r=>{if(!r.parents?.length)return r;const v={...r,children:[]},w=[{child:v,parent:r.parents[0]}];for(;w.length;){const y=w.shift(),A={...y.parent,children:y.child?[y.child]:[],parents:[]};y.child&&(A.value=y.child.value,y.child.parents=[A]),y.parent.parents?.length&&w.push({child:A,parent:y.parent.parents[0]})}return v})}function Y(P,r,v="children"){const w=v==="parents"?"children":"parents",y=[],A=[{previous:void 0,items:P,level:0}];for(;A.length;){const D=A.shift(),E=D.items.flatMap(H=>H.itemIndexes),$={value:D.items.reduce((H,Se)=>H+Se.value,0),itemIndexes:E,children:[],parents:[],start:0,level:D.level};if(y[D.level]=y[D.level]||[],y[D.level].push($),D.previous){$[w]=[D.previous];const H=D.previous[v]?.reduce((Se,ke)=>Se+ke.value,0)||0;$.start=D.previous.start+H,D.previous[v].push($)}const he=D.items.flatMap(H=>H[v]||[]),J=(0,k.groupBy)(he,H=>r.getLabel(H.itemIndexes[0]));for(const H of Object.values(J))A.push({previous:$,items:H,level:D.level+1})}return v==="parents"&&(y.reverse(),y.forEach((D,E)=>{D.forEach($=>{$.level=E})})),y}function re(P,r){const v=[];let w=0,y;const A={};for(let E=0;E<P.data.length;E++){const $=P.getLevel(E),he=E>0?P.getLevel(E-1):void 0;if(v[$]=v[$]||[],he&&he>=$){const H=v[$][v[$].length-1];w=H.start+P.getValue(H.itemIndexes[0])+P.getValueRight(H.itemIndexes[0]),y=H.parents[0]}const J={itemIndexes:[E],value:P.getValue(E)+P.getValueRight(E),valueRight:P.isDiffFlamegraph()?P.getValueRight(E):void 0,start:w,parents:y&&[y],children:[],level:$};A[P.getLabel(E)]?A[P.getLabel(E)].push(J):A[P.getLabel(E)]=[J],y&&y.children.push(J),y=J,v[$].push(J)}const D=new we(r?.collapsingThreshold);return r?.collapsing&&D.addTree(v[0][0]),[v,A,D.getCollapsedMap()]}class te{constructor(r){this.map=new Map,this.map=r||new Map}get(r){return this.map.get(r)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(r,v){const w=new Map(this.map),y=this.map.get(r),A={...y,collapsed:v};for(const D of y.items)w.set(D,A);return new te(w)}setAllCollapsedStatus(r){const v=new Map(this.map);for(const w of this.map.keys()){const A={...this.map.get(w),collapsed:r};v.set(w,A)}return new te(v)}}class we{constructor(r){this.map=new Map,this.threshold=.99,r!==void 0&&(this.threshold=r)}addTree(r){const v=[r];for(;v.length;){const w=v.shift();w.parents?.length&&this.addItem(w,w.parents[0]),w.children.length&&v.unshift(...w.children)}}addItem(r,v){if(v&&r.value>v.value*this.threshold&&v.children.length===1)if(this.map.has(v)){const w=this.map.get(v);this.map.set(r,w),w.items.push(r)}else{const w={items:[v,r],collapsed:!0};this.map.set(v,w),this.map.set(r,w)}}getCollapsedMap(){return new te(this.map)}}function de(P){return P.missingFields.length?`Data is missing fields: ${P.missingFields.join(", ")}`:P.wrongTypeFields.length?`Data has fields of wrong type: ${P.wrongTypeFields.map(r=>`${r.name} has type ${r.type} but should be ${r.expectedTypes.join(" or ")}`).join(", ")}`:""}function ge(P){const r=[["label",[t.PU.string,t.PU.enum]],["level",[t.PU.number]],["value",[t.PU.number]],["self",[t.PU.number]]],v=[],w=[];for(const y of r){const[A,D]=y,E=P?.fields.find($=>$.name===A);if(!E){v.push(A);continue}D.includes(E.type)||w.push({name:A,expectedTypes:D,type:E.type})}if(v.length>0||w.length>0)return{wrongTypeFields:w,missingFields:v}}class fe{constructor(r,v,w=(0,d.a)()){this.data=r,this.options=v;const y=ge(r);if(y)throw new Error(de(y));if(this.labelField=r.fields.find(D=>D.name==="label"),this.levelField=r.fields.find(D=>D.name==="level"),this.valueField=r.fields.find(D=>D.name==="value"),this.selfField=r.fields.find(D=>D.name==="self"),this.valueRightField=r.fields.find(D=>D.name==="valueRight"),this.selfRightField=r.fields.find(D=>D.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const A=this.labelField?.config?.type?.enum;A?(this.labelDisplayProcessor=(0,Z.J)({field:this.labelField,theme:w}),this.uniqueLabels=A.text||[]):(this.labelDisplayProcessor=D=>({text:D+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,Z.J)({field:this.valueField,theme:w})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(r){return this.labelDisplayProcessor(this.labelField.values[r]).text}getLevel(r){return this.levelField.values[r]}getValue(r){return me(this.valueField,r)}getValueRight(r){return me(this.valueRightField,r)}getSelf(r){return me(this.selfField,r)}getSelfRight(r){return me(this.selfRightField,r)}getSelfDisplay(r){return this.valueDisplayProcessor(this.getSelf(r))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case f.Zk.Bytes:return"RAM";case f.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(r){const v=this.getNodesWithLabel(r);if(!v?.length)return[[],[]];const w=ae(v,this),y=Y(v,this);return[w,y]}getNodesWithLabel(r){return this.initLevels(),this.uniqueLabelsMap[r]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[r,v,w]=re(this,this.options);this.levels=r,this.uniqueLabelsMap=v,this.collapsedMap=w}}}function me(P,r){return P?(typeof r=="number"?[r]:r).reduce((w,y)=>w+P.values[y],0):0}},10020:(De,ie,m)=>{m.d(ie,{A:()=>Zt});var t=m(74848),d=m(22803),Z=m(84139),f=m(96540),k=m(49185),ae=m(35555),X=m(30703);const Y=22*window.devicePixelRatio,re=10*window.devicePixelRatio,te=.5*window.devicePixelRatio,we=20*window.devicePixelRatio,de=.5*window.devicePixelRatio,ge=4*window.devicePixelRatio,fe=3*window.devicePixelRatio,me=3*window.devicePixelRatio,P=4*window.devicePixelRatio,r=2*window.devicePixelRatio,v=800,w=120;var y=m(94535),A=m(30930),D=m(97375);const $=({data:e,itemData:s,onMenuItemClick:l,onItemFocus:a,onSandwich:n,collapseConfig:c,onExpandGroup:i,onCollapseGroup:u,onExpandAllGroups:o,onCollapseAllGroups:h,getExtraContextMenuButtons:C,collapsing:b,allGroupsExpanded:g,allGroupsCollapsed:x,selectedView:p,search:R})=>{function S(){const F=C?.(s,e.data,{selectedView:p,isDiff:e.isDiffFlamegraph(),search:R,collapseConfig:c})||[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.D,{label:"Focus block",icon:"eye",onClick:()=>{a(),l()}}),(0,t.jsx)(y.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(s.label).then(()=>{l()})}}),(0,t.jsx)(y.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{n(),l()}}),F.map(({label:j,icon:T,onClick:z})=>(0,t.jsx)(y.D,{label:j,icon:T,onClick:()=>z()},j)),b&&(0,t.jsxs)(A.r,{label:"Grouping",children:[c?c.collapsed?(0,t.jsx)(y.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{i(),l()}}):(0,t.jsx)(y.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{u(),l()}}):null,!g&&(0,t.jsx)(y.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{o(),l()}}),!x&&(0,t.jsx)(y.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{h(),l()}})]})]})}return(0,t.jsx)("div",{"data-testid":"contextMenu",children:(0,t.jsx)(D.t,{renderMenuItems:S,x:s.posX+10,y:s.posY,focusOnOpen:!1})})};var he=m(55386),J=m(63142),H=m(27594),Se=m(15245),ke=m(71076);const Ke=({data:e,item:s,totalTicks:l,position:a,collapseConfig:n})=>{const c=(0,J.of)(qe);if(!(s&&a))return null;let i;if(e.isDiffFlamegraph()){const u=Qe(e,s,l);i=(0,t.jsx)(H.j,{className:c.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:u,getRowId:o=>o.rowId})}else{const u=Ze(e,s,l);i=(0,t.jsxs)("p",{className:c.lastParagraph,children:[u.unitTitle,(0,t.jsx)("br",{}),"Total: ",(0,t.jsx)("b",{children:u.unitValue})," (",u.percentValue,"%)",(0,t.jsx)("br",{}),"Self: ",(0,t.jsx)("b",{children:u.unitSelf})," (",u.percentSelf,"%)",(0,t.jsx)("br",{}),"Samples: ",(0,t.jsx)("b",{children:u.samples})]})}return(0,t.jsx)(Se.ZL,{children:(0,t.jsx)(ke.o,{className:c.tooltipContainer,position:a,offset:{x:15,y:0},children:(0,t.jsxs)("div",{className:c.tooltipContent,children:[(0,t.jsxs)("p",{className:c.tooltipName,children:[e.getLabel(s.itemIndexes[0]),n&&n.collapsed?(0,t.jsxs)("span",{children:[(0,t.jsx)("br",{}),"and ",n.items.length," similar items"]}):""]}),i]})})})},Ze=(e,s,l)=>{const a=e.valueDisplayProcessor(s.value),n=e.getSelfDisplay(s.itemIndexes),c=Math.round(1e4*(a.numeric/l))/100,i=Math.round(1e4*(n.numeric/l))/100;let u=a.text+a.suffix,o=n.text+n.suffix;const h=e.getUnitTitle();return h==="Count"&&(a.suffix||(u=a.text),n.suffix||(o=n.text)),{percentValue:c,percentSelf:i,unitTitle:h,unitValue:u,unitSelf:o,samples:a.numeric.toLocaleString()}},Qe=(e,s,l)=>{const n=e.getLevels()[0][0].valueRight,c=l-n,i=s.value-s.valueRight,u=Math.round(1e4*i/c)/100,o=Math.round(1e4*s.valueRight/n)/100,h=(o-u)/u*100,C=Be(e,e.valueDisplayProcessor(i)),b=Be(e,e.valueDisplayProcessor(s.valueRight)),g=(0,he.j_)("short");return[{rowId:"1",label:"% of total",baseline:u+"%",comparison:o+"%",diff:g(h).text+"%"},{rowId:"2",label:"Value",baseline:C,comparison:b,diff:Be(e,e.valueDisplayProcessor(s.valueRight-i))},{rowId:"3",label:"Samples",baseline:g(i).text,comparison:g(s.valueRight).text,diff:g(s.valueRight-i).text}]};function Be(e,s){let l=s.text+s.suffix;return e.getUnitTitle()==="Count"&&(s.suffix||(l=s.text)),l}const qe=e=>({tooltipContainer:(0,d.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,d.css)({title:"tooltipContent",fontSize:e.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,d.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,d.css)({title:"lastParagraph",marginBottom:0}),name:(0,d.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,d.css)({title:"tooltipTable",maxWidth:"400px"})}),_e=Ke;var N=m(84140),I=m(62599),et=m(55995);function tt(e,s=0){let l,a,n,c,i,u,o,h;for(l=e.length&3,a=e.length-l,n=s,i=3432918353,u=461845907,h=0;h<a;)o=e.charCodeAt(h)&255|(e.charCodeAt(++h)&255)<<8|(e.charCodeAt(++h)&255)<<16|(e.charCodeAt(++h)&255)<<24,++h,o=(o&65535)*i+(((o>>>16)*i&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(o&65535)*u+(((o>>>16)*u&65535)<<16)&4294967295,n^=o,n=n<<13|n>>>19,c=(n&65535)*5+(((n>>>16)*5&65535)<<16)&4294967295,n=(c&65535)+27492+(((c>>>16)+58964&65535)<<16);switch(o=0,l){case 3:o^=(e.charCodeAt(h+2)&255)<<16;case 2:o^=(e.charCodeAt(h+1)&255)<<8;case 1:o^=e.charCodeAt(h)&255;default:o=(o&65535)*i+(((o>>>16)*i&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(o&65535)*u+(((o>>>16)*u&65535)<<16)&4294967295,n^=o}return n^=e.length,n^=n>>>16,n=(n&65535)*2246822507+(((n>>>16)*2246822507&65535)<<16)&4294967295,n^=n>>>13,n=(n&65535)*3266489909+(((n>>>16)*3266489909&65535)<<16)&4294967295,n^=n>>>16,n>>>0}const pe=[(0,N.A)({h:24,s:69,l:60}),(0,N.A)({h:34,s:65,l:65}),(0,N.A)({h:194,s:52,l:61}),(0,N.A)({h:163,s:45,l:55}),(0,N.A)({h:211,s:48,l:60}),(0,N.A)({h:246,s:40,l:65}),(0,N.A)({h:305,s:63,l:79}),(0,N.A)({h:47,s:100,l:73}),(0,N.A)({r:183,g:219,b:171}),(0,N.A)({r:244,g:213,b:152}),(0,N.A)({r:78,g:146,b:249}),(0,N.A)({r:249,g:186,b:143}),(0,N.A)({r:242,g:145,b:145}),(0,N.A)({r:130,g:181,b:216}),(0,N.A)({r:229,g:168,b:226}),(0,N.A)({r:174,g:162,b:224}),(0,N.A)({r:154,g:196,b:138}),(0,N.A)({r:242,g:201,b:109}),(0,N.A)({r:101,g:197,b:219}),(0,N.A)({r:249,g:147,b:78}),(0,N.A)({r:234,g:100,b:96}),(0,N.A)({r:81,g:149,b:206}),(0,N.A)({r:214,g:131,b:206}),(0,N.A)({r:128,g:110,b:183})],st=Ne(1,100,0,1),lt=Ne(100,100,0,1),nt=`linear-gradient(90deg, ${st} 0%, ${lt} 100%)`,at=`linear-gradient(90deg, ${pe[0]} 0%, ${pe[2]} 30%, ${pe[6]} 50%, ${pe[7]} 70%, ${pe[8]} 100%)`;function Ne(e,s,l,a){const n=Math.min(1,e/s/(a-l)),c=50-50*n,i=65+7*n;return(0,N.A)({h:c,s:100,l:i})}function ot(e,s){const l=dt(e),n=tt(l||"",0)%pe.length;let c=pe[n].clone();return s.isLight&&(c=c.brighten(15)),c}const ve=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],it=`linear-gradient(90deg, ${ve[0]} 0%, ${ve[1]} 50%, ${ve[2]} 100%)`,xe=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],rt=`linear-gradient(90deg, ${xe[0]} 0%, ${xe[1]} 50%, ${xe[2]} 100%)`;function ct(e,s,l,a,n){const c=n===I.yU.Default?ve:xe,i=(0,et.scaleLinear)().domain([-100,0,100]).range(c),u=e-s,o=l-a;if(a===0||o===0){const x=i(0);return(0,N.A)(x)}const h=Math.round(1e4*u/o)/100,b=(Math.round(1e4*s/a)/100-h)/h*100,g=i(b);return(0,N.A)(g)}const ut=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function dt(e){for(const[s,l]of ut){const a=e.match(l);if(a)return a.groups?.packageName||""}}function ft(e){const{canvasRef:s,data:l,root:a,depth:n,direction:c,wrapperWidth:i,rangeMin:u,rangeMax:o,matchedLabels:h,textAlign:C,totalViewTicks:b,totalColorTicks:g,totalTicksRight:x,colorScheme:p,focusedItemData:R,collapsedMap:S}=e,F=vt(s,i,n),j=(0,J.$j)(),T=(0,f.useMemo)(()=>{const G=(0,N.A)(j.colors.background.secondary);return j.isLight?G.darken(10).toHexString():G.lighten(10).toHexString()},[j]),z=mt(g,x,p,j,T,u,o,h,R?R.item.level:0),B=ht(F,l,z,C,S);(0,f.useEffect)(()=>{if(!F)return;F.clearRect(0,0,F.canvas.width,F.canvas.height);const G=new Path2D;gt(a,c,l,b,u,o,i,S,(Q,W,q,se,V,K,oe)=>{oe?G.rect(W,q,se,V):B(Q,W,q,se,V,K)}),F.fillStyle=T,F.fill(G)},[F,l,a,i,u,o,b,c,B,S,T])}function ht(e,s,l,a,n){return(0,f.useMemo)(()=>e?(i,u,o,h,C,b)=>{e.beginPath(),e.rect(u+de,o,h,C),e.fillStyle=l(i,b,!1),e.stroke(),e.fill();const g=n.get(i);let x=b;g&&g.collapsed&&(x=`(${g.items.length}) `+b),h>=we&&(g?(ze(e,s,x,i,h,a==="left"?u+P+r:u,o,a),pt(e,u,o,C,i,g)):ze(e,s,x,i,h,u,o,a))}:()=>{},[e,l,a,s,n])}function pt(e,s,l,a,n,c){const i=s+P;e.beginPath(),e.rect(s,l,i-s+fe+me,a),e.fill(),e.beginPath(),c.collapsed?e.rect(i,l+a/4,fe,a/2):c.items[0]===n?e.rect(i,l+a/2,fe,a/2):c.items[c.items.length-1]===n?e.rect(i,l,fe,a/2):e.rect(i,l,fe,a),e.fillStyle="#666",e.fill()}function gt(e,s,l,a,n,c,i,u,o){const h=[];h.push({item:e,levelOffset:0});const C=i*window.devicePixelRatio/a/(c-n);let b;for(;h.length>0;){const{item:g,levelOffset:x}=h.shift();let p=g.value;const R=p*C<=re,S=p*C-(R?0:de*2),F=Y;if(S<te)continue;let j=0,T=!1;const z=u.get(g),B=z&&z.collapsed;if(B&&b===z.items[0]?(j=s==="children"?-1:1,T=!0):b=void 0,!T){const Q=Ie(g.start,a,n,C),W=(g.level+x)*Y;let q=l.getLabel(g.itemIndexes[0]);B&&(b=g),o(g,Q,W,S,F,q,R)}const G=s==="children"?g.children:g.parents;G&&h.unshift(...G.map(Q=>({item:Q,levelOffset:x+j})))}}function mt(e,s,l,a,n,c,i,u,o){return(0,f.useCallback)(function(C,b,g){if(g&&!u)return n;const x=C.valueRight!==void 0&&(l===I.yU.Default||l===I.yU.DiffColorBlind)?ct(C.value,C.valueRight,e,s,l):l===I.zM.ValueBased?Ne(C.value,e,c,i):ot(b,a);return u?u.has(b)?x.toHslString():n:C.level>o-1?x.toHslString():x.lighten(15).toHslString()},[e,s,l,a,c,i,u,o,n])}function vt(e,s,l){const[a,n]=(0,f.useState)();return(0,f.useEffect)(()=>{if(!(l&&e.current))return;const c=e.current.getContext("2d"),i=Y*l;e.current.width=Math.round(s*window.devicePixelRatio),e.current.height=Math.round(i),e.current.style.width=`${s}px`,e.current.style.height=`${i/window.devicePixelRatio}px`,c.textBaseline="middle",c.font=12*window.devicePixelRatio+"px monospace",c.strokeStyle="white",n(c)},[e,n,s,l]),a}function ze(e,s,l,a,n,c,i,u){e.save(),e.clip(),e.fillStyle="#222";const o=s.valueDisplayProcessor(a.value),h=o.suffix?o.text+o.suffix:o.text,C=e.measureText(l),b=n-ge;let g=`${l} (${h})`,x=Math.max(c,0)+ge;C.width>b&&(e.textAlign=u,u==="right"&&(g=l,x=c+n-ge)),e.fillText(g,x,i+Y/2+2),e.restore()}function Ie(e,s,l,a){return(e-s*l)*a}const xt=({data:e,rangeMin:s,rangeMax:l,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:h,colorScheme:C,totalProfileTicks:b,totalProfileTicksRight:g,totalViewTicks:x,root:p,direction:R,depth:S,showFlameGraphOnly:F,collapsedMap:j,setCollapsedMap:T,collapsing:z,getExtraContextMenuButtons:B,selectedView:G,search:Q})=>{const W=bt(),[q,{width:se}]=(0,k.A)(),V=(0,f.useRef)(null),[K,oe]=(0,f.useState)(),[O,le]=(0,f.useState)();ft({canvasRef:V,colorScheme:C,data:e,focusedItemData:u,root:p,direction:R,depth:S,rangeMax:l,rangeMin:s,matchedLabels:a,textAlign:o,totalViewTicks:x,totalColorTicks:e.isDiffFlamegraph()?b:x,totalTicksRight:g,wrapperWidth:se,collapsedMap:j});const U=(0,f.useCallback)(L=>{oe(void 0);const ee=V.current.clientWidth/x/(l-s),ce=$e({x:L.nativeEvent.offsetX,y:L.nativeEvent.offsetY},p,R,S,ee,x,s,j);le(ce?{posY:L.clientY,posX:L.clientX,item:ce,label:e.getLabel(ce.itemIndexes[0])}:void 0)},[e,s,l,x,p,R,S,j]),[ue,ne]=(0,f.useState)(),_=(0,f.useCallback)(L=>{if(O===void 0){oe(void 0),ne(void 0);const ee=V.current.clientWidth/x/(l-s),ce=$e({x:L.nativeEvent.offsetX,y:L.nativeEvent.offsetY},p,R,S,ee,x,s,j);ce&&(ne({x:L.clientX,y:L.clientY}),oe(ce))}},[s,l,x,O,ne,p,R,S,j]),Ce=(0,f.useCallback)(()=>{oe(void 0)},[]);return(0,f.useEffect)(()=>{const L=ee=>{ee.target instanceof HTMLElement&&ee.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&le(void 0)};return window.addEventListener("click",L),()=>window.removeEventListener("click",L)},[le]),(0,t.jsxs)("div",{className:W.graph,children:[(0,t.jsx)("div",{className:W.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:q,children:(0,t.jsx)("canvas",{ref:V,"data-testid":"flameGraph",onClick:U,onMouseMove:_,onMouseLeave:Ce})}),(0,t.jsx)(_e,{position:ue,item:K,data:e,totalTicks:x,collapseConfig:K?j.get(K):void 0}),!F&&O&&(0,t.jsx)($,{data:e,itemData:O,collapsing:z,collapseConfig:j.get(O.item),onMenuItemClick:()=>{le(void 0)},onItemFocus:()=>{n(O.item.start/x),c((O.item.start+O.item.value)/x),i(O)},onSandwich:()=>{h(e.getLabel(O.item.itemIndexes[0]))},onExpandGroup:()=>{T(j.setCollapsedStatus(O.item,!1))},onCollapseGroup:()=>{T(j.setCollapsedStatus(O.item,!0))},onExpandAllGroups:()=>{T(j.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{T(j.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(j.values()).every(L=>L.collapsed),allGroupsExpanded:Array.from(j.values()).every(L=>!L.collapsed),getExtraContextMenuButtons:B,selectedView:G,search:Q})]})},bt=()=>({graph:(0,d.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,d.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,d.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,d.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,d.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),$e=(e,s,l,a,n,c,i,u)=>{let o=s,h=l==="children"?0:a-1;const C=Math.floor(e.y/(Y/window.devicePixelRatio));let b;for(;o;){const g=o;if(o=void 0,h===C){b=g;break}const x=l==="children"?g.children:g.parents||[];for(const p of x){const R=Ie(p.start,c,i,n),S=Ie(p.start+p.value,c,i,n);if(R<=e.x&&e.x<S){o=p;const F=u.get(p);(!F||!F.collapsed||F.items[0]===p)&&(h=h+(l==="children"?1:-1));break}}}return b},Le=xt;var We=m(45967),Re=m(76319);const Oe=(0,f.memo)(({data:e,focusedItem:s,totalTicks:l,sandwichedLabel:a,onFocusPillClick:n,onSandwichPillClick:c})=>{const i=(0,J.of)(Ct),u=[],o=(0,he.j_)("short")(l),h=e.valueDisplayProcessor(l);let C=h.text+h.suffix;const b=e.getUnitTitle();if(b==="Count"&&(h.suffix||(C=h.text)),u.push((0,t.jsxs)("div",{className:i.metadataPill,children:[C," | ",o.text,o.suffix," samples (",b,")"]},"default")),a&&u.push((0,t.jsx)(We.m,{content:a,placement:"top",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(X.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:i.metadataPill,children:[(0,t.jsx)(X.I,{size:"sm",name:"gf-show-context"})," ",(0,t.jsx)("span",{className:i.metadataPillName,children:a.substring(a.lastIndexOf("/")+1)}),(0,t.jsx)(Re.K,{className:i.pillCloseButton,name:"times",size:"sm",onClick:c,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]})},"sandwich")),s){const g=l>0?Math.round(1e4*(s.item.value/l))/100:0,x=g>0?"eye":"exclamation-circle";u.push((0,t.jsx)(We.m,{content:s.label,placement:"top",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(X.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:i.metadataPill,children:[(0,t.jsx)(X.I,{size:"sm",name:x}),"\xA0",g,"% of total",(0,t.jsx)(Re.K,{className:i.pillCloseButton,name:"times",size:"sm",onClick:n,tooltip:"Remove focus","aria-label":"Remove focus"})]})]})},"focus"))}return(0,t.jsx)("div",{className:i.metadata,children:u})});Oe.displayName="FlameGraphMetadata";const Ct=e=>({metadataPill:(0,d.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:e.colors.background.secondary,borderRadius:e.shape.borderRadius(8),padding:e.spacing(.5,1),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,lineHeight:e.typography.bodySmall.lineHeight,color:e.colors.text.secondary}),pillCloseButton:(0,d.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:e.spacing(0,.5)}),metadata:(0,d.css)({display:"flex",alignItems:"center",justifyContent:"center",margin:"8px 0"}),metadataPillName:(0,d.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:e.spacing(.5)})}),yt=Oe,wt=({data:e,rangeMin:s,rangeMax:l,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:h,sandwichItem:C,onFocusPillClick:b,onSandwichPillClick:g,colorScheme:x,showFlameGraphOnly:p,getExtraContextMenuButtons:R,collapsing:S,selectedView:F,search:j,collapsedMap:T,setCollapsedMap:z})=>{const B=St(),[G,Q]=(0,f.useState)(),[W,q]=(0,f.useState)(),[se,V]=(0,f.useState)(0),[K,oe]=(0,f.useState)(),[O,le]=(0,f.useState)(0);if((0,f.useEffect)(()=>{if(e){let ne=e.getLevels(),_=ne.length?ne[0][0].value:0,Ce=ne.length?ne[0][0].valueRight:void 0,L=_,ee;if(C){const[ce,ye]=e.getSandwichLevels(C);ne=ye,ee=ce,L=ye[0]?.[0]?.value??0}Q(ne),q(ee),V(_),oe(Ce),le(L)}},[e,C]),!G)return null;const U={data:e,rangeMin:s,rangeMax:l,matchedLabels:a,setRangeMin:n,setRangeMax:c,onItemFocused:i,focusedItemData:u,textAlign:o,onSandwich:h,colorScheme:x,totalProfileTicks:se,totalProfileTicksRight:K,totalViewTicks:O,showFlameGraphOnly:p,collapsedMap:T,setCollapsedMap:z,getExtraContextMenuButtons:R,collapsing:S,search:j,selectedView:F};let ue=null;return W?.length?ue=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:B.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:B.sandwichMarker,children:["Callers",(0,t.jsx)(X.I,{className:B.sandwichMarkerIcon,name:"arrow-down"})]}),(0,t.jsx)(Le,{...U,root:W[W.length-1][0],depth:W.length,direction:"parents",collapsing:!1})]}),(0,t.jsxs)("div",{className:B.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:(0,d.cx)(B.sandwichMarker,B.sandwichMarkerCalees),children:[(0,t.jsx)(X.I,{className:B.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,t.jsx)(Le,{...U,root:G[0][0],depth:G.length,direction:"children",collapsing:!1})]})]}):G?.length&&(ue=(0,t.jsx)(Le,{...U,root:G[0][0],depth:G.length,direction:"children"})),(0,t.jsxs)("div",{className:B.graph,children:[(0,t.jsx)(yt,{data:e,focusedItem:u,sandwichedLabel:C,totalTicks:O,onFocusPillClick:b,onSandwichPillClick:g}),ue]})},St=()=>({graph:(0,d.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,d.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${Y/window.devicePixelRatio}px`}),sandwichMarker:(0,d.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,d.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,d.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Ft=wt;var He=m(97369),Tt=m(75198),jt=m(80292),Fe=m(45861),Dt=m(63527),Rt=m(93256),Ve=m(77824),be=m(87063),Pt=m(88559);const kt=({search:e,setSearch:s,selectedView:l,setSelectedView:a,containerWidth:n,onReset:c,textAlign:i,onTextAlignChange:u,showResetButton:o,colorScheme:h,onColorSchemeChange:C,stickyHeader:b,extraHeaderElements:g,vertical:x,isDiffMode:p,setCollapsedMap:R,collapsedMap:S})=>{const F=(0,J.of)(Ue),[j,T]=Lt(e,s),z=j!==""?(0,t.jsx)(Fe.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{s(""),T("")},children:"Clear"}):null;return(0,t.jsxs)("div",{className:(0,d.cx)(F.header,{[F.stickyHeader]:b}),children:[(0,t.jsx)("div",{className:F.inputContainer,children:(0,t.jsx)(Dt.p,{value:j||"",onChange:B=>{T(B.currentTarget.value)},placeholder:"Search...",suffix:z})}),(0,t.jsxs)("div",{className:F.rightContainer,children:[o&&(0,t.jsx)(Fe.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{c()},className:F.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,t.jsx)(Bt,{value:h,onChange:C,isDiffMode:p}),(0,t.jsxs)(Rt.e,{className:F.buttonSpacing,children:[(0,t.jsx)(Fe.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{R(S.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:l===I.F8.TopTable}),(0,t.jsx)(Fe.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{R(S.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:l===I.F8.TopTable})]}),(0,t.jsx)(Ve.z,{size:"sm",disabled:l===I.F8.TopTable,options:Nt,value:i,onChange:u,className:F.buttonSpacing}),(0,t.jsx)(Ve.z,{size:"sm",options:It(n,x),value:l,onChange:a}),g&&(0,t.jsx)("div",{className:F.extraElements,children:g})]})]})};function Bt(e){const s=(0,J.of)(Ue);let l=(0,t.jsxs)(be.W,{children:[(0,t.jsx)(be.W.Item,{label:"By package name",onClick:()=>e.onChange(I.zM.PackageBased)}),(0,t.jsx)(be.W.Item,{label:"By value",onClick:()=>e.onChange(I.zM.ValueBased)})]});const a={[I.zM.ValueBased]:s.colorDotByValue,[I.zM.PackageBased]:s.colorDotByPackage,[I.yU.DiffColorBlind]:s.colorDotDiffColorBlind,[I.yU.Default]:s.colorDotDiffDefault}[e.value]||s.colorDotByValue;let n=(0,t.jsx)("span",{className:(0,d.cx)(s.colorDot,a)});return e.isDiffMode&&(l=(0,t.jsxs)(be.W,{children:[(0,t.jsx)(be.W.Item,{label:"Default (green to red)",onClick:()=>e.onChange(I.yU.Default)}),(0,t.jsx)(be.W.Item,{label:"Color blind (blue to red)",onClick:()=>e.onChange(I.yU.DiffColorBlind)})]}),n=(0,t.jsxs)("div",{className:(0,d.cx)(s.colorDotDiff,a),children:[(0,t.jsx)("div",{children:"-100% (removed)"}),(0,t.jsx)("div",{children:"0%"}),(0,t.jsx)("div",{children:"+100% (added)"})]})),(0,t.jsx)(Pt.m,{overlay:l,children:(0,t.jsx)(Fe.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:s.buttonSpacing,"aria-label":"Change color scheme",children:n})})}const Nt=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function It(e,s){let l=[{value:I.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:I.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(e>=v||s)&&l.push({value:I.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),l}function Lt(e,s){const[l,a]=(0,f.useState)(e),n=(0,jt.A)(e);return(0,Tt.A)(()=>{s(l)},250,[l]),(0,f.useEffect)(()=>{n!==e&&e!==l&&a(e)},[e,n,l]),[l,a]}const Ue=e=>({header:(0,d.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:e.spacing(1),marginTop:e.spacing(1)}),stickyHeader:(0,d.css)({zIndex:e.zIndex.navbarFixed,position:"sticky",background:e.colors.background.primary}),inputContainer:(0,d.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,d.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,d.css)({label:"buttonSpacing",marginRight:e.spacing(1)}),resetButton:(0,d.css)({label:"resetButton",display:"flex",marginRight:e.spacing(2)}),resetButtonIconWrapper:(0,d.css)({label:"resetButtonIcon",padding:"0 5px",color:e.colors.text.disabled}),colorDot:(0,d.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,d.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,d.css)({label:"colorDotByValue",background:nt}),colorDotByPackage:(0,d.css)({label:"colorDotByPackage",background:at}),colorDotDiffDefault:(0,d.css)({label:"colorDotDiffDefault",background:it}),colorDotDiffColorBlind:(0,d.css)({label:"colorDotDiffColorBlind",background:rt}),extraElements:(0,d.css)({label:"extraElements",marginLeft:e.spacing(1)})}),At=kt;var Gt=m(70713),Ae=m(95004),Pe=m(18600),Mt=m(60519),Et=m(24343),Ge=m(739);const Xe=(0,f.memo)(({data:e,onSymbolClick:s,search:l,matchedLabels:a,onSearch:n,sandwichItem:c,onSandwich:i,onTableSort:u,colorScheme:o})=>{const h=(0,f.useMemo)(()=>{let p={};for(let R=0;R<e.data.length;R++){const S=e.getValue(R),F=e.getValueRight(R),j=e.getSelf(R),T=e.getLabel(R);(!a||a.has(T))&&(p[T]=p[T]||{},p[T].self=p[T].self?p[T].self+j:j,p[T].total=p[T].total?p[T].total+S:S,p[T].totalRight=p[T].totalRight?p[T].totalRight+F:F)}return p},[e,a]),C=(0,J.of)(Ot),b=(0,J.$j)(),[g,x]=(0,f.useState)([{displayName:"Self",desc:!0}]);return(0,t.jsx)("div",{className:C.topTableContainer,"data-testid":"topTable",children:(0,t.jsx)(Gt.default,{style:{width:"100%"},children:({width:p,height:R})=>{if(p<3||R<3)return null;const S=zt(e,h,p,s,n,i,b,o,l,c);return(0,t.jsx)(Et.X,{initialSortBy:g,onSortByChange:F=>{F&&F.length&&u?.(F[0].displayName+"_"+(F[0].desc?"desc":"asc")),x(F)},data:S,width:p,height:R})}})})});Xe.displayName="FlameGraphTopTableContainer";function zt(e,s,l,a,n,c,i,u,o,h){const C=$t(c,n,o,h),b={type:Ae.PU.string,name:"Symbol",values:[],config:{custom:{width:l-Me-w*2},links:[{title:"Highlight symbol",url:"",onClick:p=>{const S=p.origin.field.values[p.origin.rowIndex];a(S)}}]}};let g;if(e.isDiffFlamegraph()){b.config.custom.width=l-Me-w*3;const p=Te("Baseline","percent"),R=Te("Comparison","percent"),S=Te("Diff","percent");S.config.custom.cellOptions.type=Ge.ob.ColorText;const[F,j]=u===I.yU.DiffColorBlind?[xe[0],xe[2]]:[ve[0],ve[2]];S.config.mappings=[{type:Pe.d.ValueToText,options:{[1/0]:{text:"new",color:j}}},{type:Pe.d.ValueToText,options:{[-100]:{text:"removed",color:F}}},{type:Pe.d.RangeToText,options:{from:0,to:1/0,result:{color:j}}},{type:Pe.d.RangeToText,options:{from:-1/0,to:0,result:{color:F}}}];const T=e.getLevels(),z=T.length?T[0][0].value:0,B=T.length?T[0][0].valueRight:void 0;for(let G in s){C.values.push(null),b.values.push(G);const Q=s[G].total,W=s[G].totalRight,q=z-B,se=Math.round(1e4*Q/q)/100,V=Math.round(1e4*W/B)/100,K=(V-se)/se*100;S.values.push(K),p.values.push(se),R.values.push(V)}g={fields:[C,b,p,R,S],length:b.values.length}}else{const p=Te("Self",e.selfField.config.unit),R=Te("Total",e.valueField.config.unit);for(let S in s)C.values.push(null),b.values.push(S),p.values.push(s[S].self),R.values.push(s[S].total);g={fields:[C,b,p,R],length:b.values.length}}return(0,Mt.we)({data:[g],fieldConfig:{defaults:{},overrides:[]},replaceVariables:p=>p,theme:i})[0]}function Te(e,s){const l={width:w,align:"auto",inspect:!1,cellOptions:{type:Ge.ob.Auto}};return{type:Ae.PU.number,name:e,values:[],config:{unit:s,custom:l}}}const Me=61;function $t(e,s,l,a){const n={type:Ge.ob.Custom,cellComponent:i=>(0,t.jsx)(Wt,{frame:i.frame,onSandwich:e,onSearch:s,search:l,sandwichItem:a,rowIndex:i.rowIndex})},c={filterable:!1,width:Me,hideHeader:!0,inspect:!1,align:"auto",cellOptions:n};return{type:Ae.PU.number,name:"actions",values:[],config:{custom:c}}}function Wt(e){const s=Ht(),l=e.frame.fields.find(c=>c.name==="Symbol")?.values[e.rowIndex],a=e.search===l,n=e.sandwichItem===l;return(0,t.jsxs)("div",{className:s.actionCellWrapper,children:[(0,t.jsx)(Re.K,{className:s.actionCellButton,name:"search",variant:a?"primary":"secondary",tooltip:a?"Clear from search":"Search for symbol","aria-label":a?"Clear from search":"Search for symbol",onClick:()=>{e.onSearch(a?"":l)}}),(0,t.jsx)(Re.K,{className:s.actionCellButton,name:"gf-show-context",tooltip:n?"Remove from sandwich view":"Show in sandwich view",variant:n?"primary":"secondary","aria-label":n?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{e.onSandwich(n?void 0:l)}})]})}const Ot=e=>({topTableContainer:(0,d.css)({label:"topTableContainer",padding:e.spacing(1),backgroundColor:e.colors.background.secondary,height:"100%"})}),Ht=()=>({actionCellWrapper:(0,d.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,d.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),Vt=Xe,Ut=new Z.A,Xt=({data:e,onTableSymbolClick:s,onViewSelected:l,onTextAlignSelected:a,onTableSort:n,getTheme:c,stickyHeader:i,extraHeaderElements:u,vertical:o,showFlameGraphOnly:h,disableCollapsing:C,keepFocusOnDataChange:b,getExtraContextMenuButtons:g})=>{const[x,p]=(0,f.useState)(),[R,S]=(0,f.useState)(0),[F,j]=(0,f.useState)(1),[T,z]=(0,f.useState)(""),[B,G]=(0,f.useState)(I.F8.Both),[Q,{width:W}]=(0,k.A)(),[q,se]=(0,f.useState)("left"),[V,K]=(0,f.useState)(),[oe,O]=(0,f.useState)(new He.S6),le=(0,f.useMemo)(()=>c(),[c]),U=(0,f.useMemo)(()=>{if(!e)return;const M=new He.Jz(e,{collapsing:!C},le);return O(M.getCollapsedMap()),M},[e,le,C]),[ue,ne]=Yt(U),_=Kt(le),Ce=Jt(T,U);(0,f.useEffect)(()=>{W>0&&W<v&&B===I.F8.Both&&!o&&G(I.F8.FlameGraph)},[B,G,W,o]);const L=(0,f.useCallback)(()=>{p(void 0),S(0),j(1)},[p,j,S]),ee=(0,f.useCallback)(()=>{K(void 0)},[K]);(0,f.useEffect)(()=>{if(!b){L(),ee();return}if(U&&x){const M=U.getNodesWithLabel(x.label)?.[0];if(M){p({...x,item:M});const Ye=U.getLevels(),Je=Ye.length?Ye[0][0].value:0;S(M.start/Je),j((M.start+M.value)/Je)}else p({...x,item:{start:0,value:0,itemIndexes:[],children:[],level:0}}),S(0),j(1)}},[U,b]);const ce=(0,f.useCallback)(M=>{T===M?z(""):(s?.(M),z(M),L())},[z,L,s,T]);if(!U)return null;const ye=(0,t.jsx)(Ft,{data:U,rangeMin:R,rangeMax:F,matchedLabels:Ce,setRangeMin:S,setRangeMax:j,onItemFocused:M=>p(M),focusedItemData:x,textAlign:q,sandwichItem:V,onSandwich:M=>{L(),K(M)},onFocusPillClick:L,onSandwichPillClick:ee,colorScheme:ue,showFlameGraphOnly:h,collapsing:!C,getExtraContextMenuButtons:g,selectedView:B,search:T,collapsedMap:oe,setCollapsedMap:O}),Ee=(0,t.jsx)(Vt,{data:U,onSymbolClick:ce,search:T,matchedLabels:Ce,sandwichItem:V,onSandwich:K,onSearch:z,onTableSort:n,colorScheme:ue});let je;return h||B===I.F8.FlameGraph?je=ye:B===I.F8.TopTable?je=(0,t.jsx)("div",{className:_.tableContainer,children:Ee}):B===I.F8.Both&&(o?je=(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:_.verticalGraphContainer,children:ye}),(0,t.jsx)("div",{className:_.verticalTableContainer,children:Ee})]}):je=(0,t.jsxs)("div",{className:_.horizontalContainer,children:[(0,t.jsx)("div",{className:_.horizontalTableContainer,children:Ee}),(0,t.jsx)("div",{className:_.horizontalGraphContainer,children:ye})]})),(0,t.jsx)(ae.D.Provider,{value:le,children:(0,t.jsxs)("div",{ref:Q,className:_.container,children:[!h&&(0,t.jsx)(At,{search:T,setSearch:z,selectedView:B,setSelectedView:M=>{G(M),l?.(M)},containerWidth:W,onReset:()=>{L(),ee()},textAlign:q,onTextAlignChange:M=>{se(M),a?.(M)},showResetButton:!!(x||V),colorScheme:ue,onColorSchemeChange:ne,stickyHeader:!!i,extraHeaderElements:u,vertical:o,isDiffMode:U.isDiffFlamegraph(),setCollapsedMap:O,collapsedMap:oe}),(0,t.jsx)("div",{className:_.body,children:je})]})})};function Yt(e){const s=e?.isDiffFlamegraph()?I.yU.Default:I.zM.PackageBased,[l,a]=(0,f.useState)(s);return(0,f.useEffect)(()=>{a(s)},[s]),[l,a]}function Jt(e,s){return(0,f.useMemo)(()=>{if(e&&s){const l=new Set;let a=Ut.filter(s.getUniqueLabels(),e);if(a)for(let n of a)l.add(s.getUniqueLabels()[n]);return l}},[e,s])}function Kt(e){return{container:(0,d.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:e.spacing(1)}),body:(0,d.css)({label:"body",flexGrow:1}),tableContainer:(0,d.css)({height:800}),horizontalContainer:(0,d.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:e.spacing(1),width:"100%"}),horizontalGraphContainer:(0,d.css)({flexBasis:"50%"}),horizontalTableContainer:(0,d.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,d.css)({marginBottom:e.spacing(1)}),verticalTableContainer:(0,d.css)({height:800})}}const Zt=Xt},62599:(De,ie,m)=>{m.d(ie,{F8:()=>d,Zk:()=>t,yU:()=>f,zM:()=>Z});var t=(k=>(k.Bytes="bytes",k.Short="short",k.Nanoseconds="ns",k))(t||{}),d=(k=>(k.TopTable="topTable",k.FlameGraph="flameGraph",k.Both="both",k))(d||{}),Z=(k=>(k.ValueBased="valueBased",k.PackageBased="packageBased",k))(Z||{}),f=(k=>(k.Default="default",k.DiffColorBlind="diffColorBlind",k))(f||{})},75198:(De,ie,m)=>{var t;t={value:!0};var d=m(31635),Z=m(96540),f=d.__importDefault(m(93182));function k(ae,X,Y){X===void 0&&(X=0),Y===void 0&&(Y=[]);var re=f.default(ae,X),te=re[0],we=re[1],de=re[2];return Z.useEffect(de,Y),[te,we]}ie.A=k},93182:(De,ie,m)=>{Object.defineProperty(ie,"__esModule",{value:!0});var t=m(96540);function d(Z,f){f===void 0&&(f=0);var k=t.useRef(!1),ae=t.useRef(),X=t.useRef(Z),Y=t.useCallback(function(){return k.current},[]),re=t.useCallback(function(){k.current=!1,ae.current&&clearTimeout(ae.current),ae.current=setTimeout(function(){k.current=!0,X.current()},f)},[f]),te=t.useCallback(function(){k.current=null,ae.current&&clearTimeout(ae.current)},[]);return t.useEffect(function(){X.current=Z},[Z]),t.useEffect(function(){return re(),te},[f]),[Y,te,re]}ie.default=d}}]);

//# sourceMappingURL=20.40e691a0853189fae92e.js.map